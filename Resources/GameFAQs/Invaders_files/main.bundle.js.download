/*! For license information please see main.bundle.js.LICENSE.txt */
(()=>{var e,t,i={727:()=>{!function(e){var t=function(t){this._options={checkOnLoad:!1,resetOnEnd:!1,loopCheckTime:50,loopMaxNumber:5,baitClass:"pub_300x250 pub_300x250m pub_728x90 text-ad textAd text_ad text_ads text-ads text-ad-links",baitStyle:"width: 1px !important; height: 1px !important; position: absolute !important; left: -10000px !important; top: -1000px !important;",debug:!1},this._var={version:"3.2.1",bait:null,checking:!1,loop:null,loopNumber:0,event:{detected:[],notDetected:[]}},void 0!==t&&this.setOption(t);var i=this,n=function(){setTimeout((function(){!0===i._options.checkOnLoad&&(!0===i._options.debug&&i._log("onload->eventCallback","A check loading is launched"),null===i._var.bait&&i._creatBait(),setTimeout((function(){i.check()}),1))}),1)};void 0!==e.addEventListener?e.addEventListener("load",n,!1):e.attachEvent("onload",n)};t.prototype._options=null,t.prototype._var=null,t.prototype._bait=null,t.prototype._log=function(e,t){console.log("[BlockAdBlock]["+e+"] "+t)},t.prototype.setOption=function(e,t){if(void 0!==t){var i=e;(e={})[i]=t}for(var n in e)this._options[n]=e[n],!0===this._options.debug&&this._log("setOption",'The option "'+n+'" he was assigned to "'+e[n]+'"');return this},t.prototype._creatBait=function(){var t=document.createElement("div");t.setAttribute("class",this._options.baitClass),t.setAttribute("style",this._options.baitStyle),this._var.bait=e.document.body.appendChild(t),this._var.bait.offsetParent,this._var.bait.offsetHeight,this._var.bait.offsetLeft,this._var.bait.offsetTop,this._var.bait.offsetWidth,this._var.bait.clientHeight,this._var.bait.clientWidth,!0===this._options.debug&&this._log("_creatBait","Bait has been created")},t.prototype._destroyBait=function(){e.document.body.removeChild(this._var.bait),this._var.bait=null,!0===this._options.debug&&this._log("_destroyBait","Bait has been removed")},t.prototype.check=function(e){if(void 0===e&&(e=!0),!0===this._options.debug&&this._log("check","An audit was requested "+(!0===e?"with a":"without")+" loop"),!0===this._var.checking)return!0===this._options.debug&&this._log("check","A check was canceled because there is already an ongoing"),!1;this._var.checking=!0,null===this._var.bait&&this._creatBait();var t=this;return this._var.loopNumber=0,!0===e&&(this._var.loop=setInterval((function(){t._checkBait(e)}),this._options.loopCheckTime)),setTimeout((function(){t._checkBait(e)}),1),!0===this._options.debug&&this._log("check","A check is in progress ..."),!0},t.prototype._checkBait=function(t){var i=!1;if(null===this._var.bait&&this._creatBait(),null===e.document.body.getAttribute("abp")&&null!==this._var.bait.offsetParent&&0!=this._var.bait.offsetHeight&&0!=this._var.bait.offsetLeft&&0!=this._var.bait.offsetTop&&0!=this._var.bait.offsetWidth&&0!=this._var.bait.clientHeight&&0!=this._var.bait.clientWidth||(i=!0),void 0!==e.getComputedStyle){var n=e.getComputedStyle(this._var.bait,null);!n||"none"!=n.getPropertyValue("display")&&"hidden"!=n.getPropertyValue("visibility")||(i=!0)}!0===this._options.debug&&this._log("_checkBait","A check ("+(this._var.loopNumber+1)+"/"+this._options.loopMaxNumber+" ~"+(1+this._var.loopNumber*this._options.loopCheckTime)+"ms) was conducted and detection is "+(!0===i?"positive":"negative")),!0===t&&(this._var.loopNumber++,this._var.loopNumber>=this._options.loopMaxNumber&&this._stopLoop()),!0===i?(this._stopLoop(),this._destroyBait(),this.emitEvent(!0),!0===t&&(this._var.checking=!1)):null!==this._var.loop&&!1!==t||(this._destroyBait(),this.emitEvent(!1),!0===t&&(this._var.checking=!1))},t.prototype._stopLoop=function(e){clearInterval(this._var.loop),this._var.loop=null,this._var.loopNumber=0,!0===this._options.debug&&this._log("_stopLoop","A loop has been stopped")},t.prototype.emitEvent=function(e){!0===this._options.debug&&this._log("emitEvent","An event with a "+(!0===e?"positive":"negative")+" detection was called");var t=this._var.event[!0===e?"detected":"notDetected"];for(var i in t)!0===this._options.debug&&this._log("emitEvent","Call function "+(parseInt(i)+1)+"/"+t.length),t.hasOwnProperty(i)&&t[i]();return!0===this._options.resetOnEnd&&this.clearEvent(),this},t.prototype.clearEvent=function(){this._var.event.detected=[],this._var.event.notDetected=[],!0===this._options.debug&&this._log("clearEvent","The event list has been cleared")},t.prototype.on=function(e,t){return this._var.event[!0===e?"detected":"notDetected"].push(t),!0===this._options.debug&&this._log("on",'A type of event "'+(!0===e?"detected":"notDetected")+'" was added'),this},t.prototype.onDetected=function(e){return this.on(!0,e)},t.prototype.onNotDetected=function(e){return this.on(!1,e)},e.BlockAdBlock=t,void 0===e.blockAdBlock&&(e.blockAdBlock=new t({checkOnLoad:!0,resetOnEnd:!0}))}(window)},741:(e,t,i)=>{var n;!function(e){!function(t){var n="object"==typeof i.g?i.g:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),s=r(e);function r(e,t){return function(i,n){"function"!=typeof e[i]&&Object.defineProperty(e,i,{configurable:!0,writable:!0,value:n}),t&&t(i,n)}}void 0===n.Reflect?n.Reflect=e:s=r(n.Reflect,s),function(e){var t=Object.prototype.hasOwnProperty,i="function"==typeof Symbol,n=i&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",s=i&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",r="function"==typeof Object.create,o={__proto__:[]}instanceof Array,a=!r&&!o,d={create:r?function(){return x(Object.create(null))}:o?function(){return x({__proto__:null})}:function(){return x({})},has:a?function(e,i){return t.call(e,i)}:function(e,t){return t in e},get:a?function(e,i){return t.call(e,i)?e[i]:void 0}:function(e,t){return e[t]}},l=Object.getPrototypeOf(Function),c="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,u=c||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var e={},t=[],i=function(){function e(e,t,i){this._index=0,this._keys=e,this._values=t,this._selector=i}return e.prototype["@@iterator"]=function(){return this},e.prototype[s]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var i=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:i,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var i=this._find(e,!0);return this._values[i]=t,this},t.prototype.delete=function(t){var i=this._find(t,!1);if(i>=0){for(var n=this._keys.length,s=i+1;s<n;s++)this._keys[s-1]=this._keys[s],this._values[s-1]=this._values[s];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new i(this._keys,this._values,n)},t.prototype.values=function(){return new i(this._keys,this._values,r)},t.prototype.entries=function(){return new i(this._keys,this._values,o)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[s]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function n(e,t){return e}function r(e,t){return t}function o(e,t){return[e,t]}}():Map,p=c||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function e(){this._map=new u}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[s]=function(){return this.keys()},e}():Set,h=new(c||"function"!=typeof WeakMap?function(){var e=16,i=d.create(),n=s();return function(){function e(){this._key=s()}return e.prototype.has=function(e){var t=r(e,!1);return void 0!==t&&d.has(t,this._key)},e.prototype.get=function(e){var t=r(e,!1);return void 0!==t?d.get(t,this._key):void 0},e.prototype.set=function(e,t){return r(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=r(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=s()},e}();function s(){var e;do{e="@@WeakMap@@"+a()}while(d.has(i,e));return i[e]=!0,e}function r(e,i){if(!t.call(e,n)){if(!i)return;Object.defineProperty(e,n,{value:d.create()})}return e[n]}function o(e,t){for(var i=0;i<t;++i)e[i]=255*Math.random()|0;return e}function a(){var t,i=(t=e,"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(t)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(t)):o(new Uint8Array(t),t):o(new Array(t),t));i[6]=79&i[6]|64,i[8]=191&i[8]|128;for(var n="",s=0;s<e;++s){var r=i[s];4!==s&&6!==s&&8!==s||(n+="-"),r<16&&(n+="0"),n+=r.toString(16).toLowerCase()}return n}}():WeakMap);function g(e,t,i){var n=h.get(e);if(E(n)){if(!i)return;n=new u,h.set(e,n)}var s=n.get(t);if(E(s)){if(!i)return;s=new u,n.set(t,s)}return s}function m(e,t,i){if(f(e,t,i))return!0;var n=D(t);return!T(n)&&m(e,n,i)}function f(e,t,i){var n=g(t,i,!1);return!E(n)&&!!n.has(e)}function v(e,t,i){if(f(e,t,i))return b(e,t,i);var n=D(t);return T(n)?void 0:v(e,n,i)}function b(e,t,i){var n=g(t,i,!1);if(!E(n))return n.get(e)}function y(e,t,i,n){g(i,n,!0).set(e,t)}function S(e,t){var i=w(e,t),n=D(e);if(null===n)return i;var s=S(n,t);if(s.length<=0)return i;if(i.length<=0)return s;for(var r=new p,o=[],a=0,d=i;a<d.length;a++){var l=d[a];r.has(l)||(r.add(l),o.push(l))}for(var c=0,u=s;c<u.length;c++)l=u[c],r.has(l)||(r.add(l),o.push(l));return o}function w(e,t){var i=[],n=g(e,t,!1);if(E(n))return i;for(var r=function(e){var t=N(e,s);if(!P(t))throw new TypeError;var i=t.call(e);if(!I(i))throw new TypeError;return i}(n.keys()),o=0;;){var a=L(r);if(!a)return i.length=o,i;var d=a.value;try{i[o]=d}catch(e){try{R(r)}finally{throw e}}o++}}function _(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function E(e){return void 0===e}function T(e){return null===e}function I(e){return"object"==typeof e?null!==e:"function"==typeof e}function A(e,t){switch(_(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var i=3===t?"string":5===t?"number":"default",s=N(e,n);if(void 0!==s){var r=s.call(e,i);if(I(r))throw new TypeError;return r}return function(e,t){if("string"===t){var i=e.toString;if(P(i)&&!I(s=i.call(e)))return s;if(P(n=e.valueOf)&&!I(s=n.call(e)))return s}else{var n;if(P(n=e.valueOf)&&!I(s=n.call(e)))return s;var s,r=e.toString;if(P(r)&&!I(s=r.call(e)))return s}throw new TypeError}(e,"default"===i?"number":i)}function C(e){var t=A(e,3);return"symbol"==typeof t?t:function(e){return""+e}(t)}function O(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function P(e){return"function"==typeof e}function k(e){return"function"==typeof e}function N(e,t){var i=e[t];if(null!=i){if(!P(i))throw new TypeError;return i}}function L(e){var t=e.next();return!t.done&&t}function R(e){var t=e.return;t&&t.call(e)}function D(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===l)return t;if(t!==l)return t;var i=e.prototype,n=i&&Object.getPrototypeOf(i);if(null==n||n===Object.prototype)return t;var s=n.constructor;return"function"!=typeof s||s===e?t:s}function x(e){return e.__=void 0,delete e.__,e}e("decorate",(function(e,t,i,n){if(E(i)){if(!O(e))throw new TypeError;if(!k(t))throw new TypeError;return function(e,t){for(var i=e.length-1;i>=0;--i){var n=(0,e[i])(t);if(!E(n)&&!T(n)){if(!k(n))throw new TypeError;t=n}}return t}(e,t)}if(!O(e))throw new TypeError;if(!I(t))throw new TypeError;if(!I(n)&&!E(n)&&!T(n))throw new TypeError;return T(n)&&(n=void 0),function(e,t,i,n){for(var s=e.length-1;s>=0;--s){var r=(0,e[s])(t,i,n);if(!E(r)&&!T(r)){if(!I(r))throw new TypeError;n=r}}return n}(e,t,i=C(i),n)})),e("metadata",(function(e,t){return function(i,n){if(!I(i))throw new TypeError;if(!E(n)&&!function(e){switch(_(e)){case 3:case 4:return!0;default:return!1}}(n))throw new TypeError;y(e,t,i,n)}})),e("defineMetadata",(function(e,t,i,n){if(!I(i))throw new TypeError;return E(n)||(n=C(n)),y(e,t,i,n)})),e("hasMetadata",(function(e,t,i){if(!I(t))throw new TypeError;return E(i)||(i=C(i)),m(e,t,i)})),e("hasOwnMetadata",(function(e,t,i){if(!I(t))throw new TypeError;return E(i)||(i=C(i)),f(e,t,i)})),e("getMetadata",(function(e,t,i){if(!I(t))throw new TypeError;return E(i)||(i=C(i)),v(e,t,i)})),e("getOwnMetadata",(function(e,t,i){if(!I(t))throw new TypeError;return E(i)||(i=C(i)),b(e,t,i)})),e("getMetadataKeys",(function(e,t){if(!I(e))throw new TypeError;return E(t)||(t=C(t)),S(e,t)})),e("getOwnMetadataKeys",(function(e,t){if(!I(e))throw new TypeError;return E(t)||(t=C(t)),w(e,t)})),e("deleteMetadata",(function(e,t,i){if(!I(t))throw new TypeError;E(i)||(i=C(i));var n=g(t,i,!1);if(E(n))return!1;if(!n.delete(e))return!1;if(n.size>0)return!0;var s=h.get(t);return s.delete(i),s.size>0||h.delete(t),!0}))}(s)}()}(n||(n={}))}},n={};function s(e){var t=n[e];if(void 0!==t)return t.exports;var r=n[e]={exports:{}};return i[e](r,r.exports,s),r.exports}t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,s.t=function(i,n){if(1&n&&(i=this(i)),8&n)return i;if("object"==typeof i&&i){if(4&n&&i.__esModule)return i;if(16&n&&"function"==typeof i.then)return i}var r=Object.create(null);s.r(r);var o={};e=e||[null,t({}),t([]),t(t)];for(var a=2&n&&i;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>o[e]=()=>i[e]));return o.default=()=>i,s.d(r,o),r},s.d=(e,t)=>{for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e={};s.r(e),s.d(e,{AD_LABEL_CLASS:()=>ze,Document:()=>cn,FetchTimeout:()=>un,GlobalTimeout:()=>Yn,IframeBuilder:()=>Zn,LazyQueue:()=>ss,ScriptLoader:()=>ds,Targeting:()=>hs,WaitFor:()=>uo,assetLoader:()=>Ti,buildPromisedTimeout:()=>os,buildVastUrl:()=>eo,client:()=>Wi,createExtendedPromise:()=>vn,createWithTimeout:()=>fn,debounce:()=>Yi,decorate:()=>Qi,defer:()=>hn,generateUniqueId:()=>bn,getContinentCode:()=>Sn,getCountryCode:()=>yn,getCustomParameters:()=>Zr,getElementOffset:()=>en,getGlobalValue:()=>En,getHeight:()=>Zi,getLeftOffset:()=>nn,getRegionCode:()=>wn,getServicesBaseURL:()=>cs,getTimeDelta:()=>Gn,getTimeDeltaFixed:()=>qn,getTimeOrigin:()=>Hn,getTopOffset:()=>tn,getTranslation:()=>Xn,getViewportHeight:()=>sn,getViewportWidth:()=>rn,getWidth:()=>Xi,isCoppaSubject:()=>is,isIframe:()=>dn,isInTheSameViewport:()=>an,isInViewport:()=>on,isProperCountry:()=>_n,logger:()=>Wn,makeLazyQueue:()=>ns,once:()=>gn,outboundTrafficRestrict:()=>rs,pageInIframe:()=>ln,queryString:()=>y,sampler:()=>as,scriptLoader:()=>ls,stringBuilder:()=>ps,targeting:()=>gs,timedPartnerScriptLoader:()=>ms,timeoutReject:()=>mn,tryProperty:()=>vs,uuid:()=>lo,viewportObserver:()=>co,wait:()=>pn,warner:()=>Kn,whichProperty:()=>fs,withDebounce:()=>Ki});var t={};s.r(t),s.d(t,{BFAA_UNSTICK_DELAY:()=>Ec,CSS_TIMING_EASE_IN_CUBIC:()=>vc,DEFAULT_UAP_ID:()=>yc,DEFAULT_UAP_TYPE:()=>Sc,FAN_TAKEOVER_TYPES:()=>wc,SLIDE_OUT_TIME:()=>bc,SLOT_FORCE_UNSTICK:()=>Ic,SLOT_STICKED_STATE:()=>Cc,SLOT_STICKINESS_DISABLED:()=>kc,SLOT_STICKY_READY_STATE:()=>Oc,SLOT_STICKY_STATE_SKIPPED:()=>Pc,SLOT_UNSTICKED_STATE:()=>Ac,SLOT_VIDEO_DONE:()=>Nc,SPECIAL_VIDEO_AD_UNIT:()=>_c,TLB_UNSTICK_DELAY:()=>Tc,UAP_ADDITIONAL_SIZES:()=>Lc});var i={};s.r(i);var n={};s.r(n);var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}function a(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o}function d(e,t){return function(i,n){t(i,n,e)}}function l(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function c(e,t,i,n){return new(i||(i=Promise))((function(s,r){function o(e){try{d(n.next(e))}catch(e){r(e)}}function a(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}d((n=n.apply(e,t||[])).next())}))}function u(e,t){var i,n,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(a){return function(d){return function(a){if(i)throw new TypeError("Generator is already executing.");for(;r&&(r=0,a[0]&&(o=0)),o;)try{if(i=1,n&&(s=2&a[0]?n.return:a[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,a[1])).done)return s;switch(n=0,s&&(a=[2&a[0],s.value]),a[0]){case 0:case 1:s=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!s||a[1]>s[0]&&a[1]<s[3])){o.label=a[1];break}if(6===a[0]&&o.label<s[1]){o.label=s[1],s=a;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(a);break}s[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{i=s=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,d])}}}function p(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,s,r=i.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)o.push(n.value)}catch(e){s={error:e}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(s)throw s.error}}return o}function g(e,t,i){if(i||2===arguments.length)for(var n,s=0,r=t.length;s<r;s++)!n&&s in t||(n||(n=Array.prototype.slice.call(t,0,s)),n[s]=t[s]);return e.concat(n||Array.prototype.slice.call(t))}function m(e){return this instanceof m?(this.v=e,this):new m(e)}function f(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)e[n]=i[n]}return e}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var v=function e(t,i){function n(e,n,s){if("undefined"!=typeof document){"number"==typeof(s=f({},i,s)).expires&&(s.expires=new Date(Date.now()+864e5*s.expires)),s.expires&&(s.expires=s.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var r="";for(var o in s)s[o]&&(r+="; "+o,!0!==s[o]&&(r+="="+s[o].split(";")[0]));return document.cookie=e+"="+t.write(n,e)+r}}return Object.create({set:n,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var i=document.cookie?document.cookie.split("; "):[],n={},s=0;s<i.length;s++){var r=i[s].split("="),o=r.slice(1).join("=");try{var a=decodeURIComponent(r[0]);if(n[a]=t.read(o,a),e===a)break}catch(e){}}return e?n[e]:n}},remove:function(e,t){n(e,"",f({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,f({},this.attributes,t))},withConverter:function(t){return e(f({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(i)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});class b{constructor(){this.cacheMaxAge=18e5,this.keysSeen=new Set}getItem(e){return v.get(e)}setItem(e,t,i){const n=i||this.cacheMaxAge,s={expires:new Date((new Date).getTime()+n),path:"/",domain:this.getCookieDomain(),overwrite:!0};this.keysSeen.add(e),v.set(e,t,s)}removeItem(e){this.keysSeen.delete(e),v.remove(e,{path:"/",domain:this.getCookieDomain()})}clear(){this.keysSeen.forEach((e=>{this.removeItem(e)}))}getCookieDomain(){const e=window.location.hostname.split(".");return e.length>1?`.${e[e.length-2]}.${e[e.length-1]}`:void 0}}const y=new class{constructor(){this.cache=new Map}getValues(e){return[...this.getURLSearchParams(e).entries()].reduce(((e,[t,i])=>(e[t]=i,e)),{})}getURLSearchParams(e){const t=e||window.location.search.substring(1);return this.cache.has(t)||this.cache.set(t,new URLSearchParams(t)),this.cache.get(t)}get(e,t){return this.getURLSearchParams(t).get(e)||""}isUrlParamSet(e,t){return!!parseInt(this.get(e,t),10)}stringify(e){const t=new URLSearchParams(e);return t.sort(),t.toString()}},S=new b;function w(){return y.get("adengine_debug")||S.getItem("adengine_debug")}function _(e){null!==e?S.setItem("adengine_debug",e||"1"):S.removeItem("adengine_debug")}const E={isDebugMode:function(){return Boolean(w())},getDebugGroup:w,setDebugMode:_};window.ads=window.ads||{},window.ads.debug=_;const T={adUnitId:"",bidders:{enabled:!1,timeout:2e3,a9:{enabled:!1,videoEnabled:!1,amazonId:"3115",bidsRefreshing:{slots:[]}},prebid:{enabled:!1,bidsRefreshing:{slots:[]}}},events:{},listeners:{porvata:[]},options:{customAdLoader:{globalMethodName:"loadCustomAd"},maxDelayTimeout:2e3,optOutSale:!1,trackingOptIn:!1,isSubjectToCcpa:!1},services:{},slots:{},src:["gpt"],state:{adStack:[],isMobile:!1},targeting:{},vast:{size:[640,480],adUnitId:""}},I={};function A(e,t,i){let n="";t.forEach((t=>{n+=(""===n?"":".")+t,function(e,t,i){I[e]&&I[e].forEach((e=>{e(t,i)}))}(n,e,i)}))}function C(e,t,i=!1){const n=e.split("."),s=n.length;let r=T,o=null;for(let e=0;e<s;e+=1)o=n[e],e<s-1&&(r[o]=r[o]||{},r=r[o]);return i?(delete r[o],A(e,n,null),null):(void 0!==t&&(r[o]=t,A(e,n,t)),r[o])}const O=new class{constructor(){window.ads=window.ads||{},window.ads.adContext=E.isDebugMode()?T:{}}extend(e){Object.assign(T,e)}set(e,t){C(e,t)}get(e){return C(e)}remove(e){C(e,null,!0)}push(e,t){const i=C(e);i&&i.push(t)}onChange(e,t){I[e]=I[e]||[],I[e].push(t)}removeListeners(e){Object.keys(I).forEach((t=>{t!==e&&0!==t.indexOf(`${e}.`)||delete I[t]}))}};function P(e){O.set("geo.region",e.region),O.set("geo.country",e.country),O.set("geo.continent",e.continent)}var k=function(){return k=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var s in t=arguments[i])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},k.apply(this,arguments)};function N(e,t){return Object.defineProperty(t,"type",{value:e,writable:!1})}function L(e){return!0===e.__global}function R(e,t){const i=function(e,t){if("function"==typeof t)return N(e,(function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];return k(k({},t.apply(void 0,i)),{type:e})}));switch(t?t._as:"empty"){case"empty":return N(e,(function(){return{type:e}}));case"fsa":return N(e,(function(t,i){return t instanceof Error?{error:!0,meta:i,payload:t,type:e}:{error:!1,meta:i,payload:t,type:e}}));case"payload":return N(e,(function(t){return{payload:t,type:e}}));case"props":return N(e,(function(t){return k(k({},t),{type:e})}));default:throw new Error("Unexpected config.")}}(e,t),n=(...e)=>{const t=i(...e);return Object.assign(Object.assign({},t),{__global:!0})};return Object.defineProperty(n,"type",{value:e,writable:!1}),Object.defineProperty(n,"__global",{value:!0,writable:!1}),n}function D(e,t){return Object.keys(t).forEach((function(i){"default"===i||"__esModule"===i||e.hasOwnProperty(i)||Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[i]}})})),e}function x(e,t,i,n){Object.defineProperty(e,t,{get:i,set:n,enumerable:!0,configurable:!0})}var z={},V={};function M(e){return new Promise((t=>setTimeout((()=>t()),e)))}x(V,"delay",(()=>M));var U={};function j(){const e=new URLSearchParams(window.location.search.substring(1));return Boolean(e.get("adengine_debug"))?e.get("adengine_debug"):e.get("identity_debug")}x(U,"getDebugGroup",(()=>j));var B={};x(B,"localStorageHelper",(()=>$));class ${constructor(e,t=6e4){this.key=e,this.ttlInMilliseconds=t;let i=!1;try{i=void 0!==window.localStorage&&null!==window.localStorage,i&&(window.localStorage.setItem("__test__","test"),window.localStorage.removeItem("__test__"))}catch(e){i=!1}const n=e=>window?.instantConfigCache?.[e]??null,s=(e,t)=>{void 0===window.instantConfigCache&&(window.instantConfigCache={}),window.instantConfigCache[e]=t};this.storageAdapter={getItem:e=>{try{return i?window.localStorage.getItem(e)??n(e):n(e)}catch(t){return n(e)}},setItem:(e,t)=>{try{if(i)return localStorage.setItem(e,t);s(e,t)}catch(i){s(e,t)}}}}set(e){const t=this.getObjectToStore(e);this.storageAdapter.setItem(this.key,JSON.stringify(t))}get(){const e=this.storageAdapter.getItem(this.key);return e?this.parseStoredValue(JSON.parse(e)):null}expired(e){return!e||e<Date.now()}getObjectToStore(e){return{data:e,ttl:Date.now()+this.ttlInMilliseconds}}parseStoredValue(e){return this.expired(e?.ttl)?null:e.data}}var F={};x(F,"lock",(()=>G)),x(F,"release",(()=>q));const H=new $("instant-config-lock",1e3);function G(){return"lock"===H.get()||(H.set("lock"),!1)}function q(){H.set(null)}var W={};x(W,"getTimeDelta",(()=>J)),x(W,"logger",(()=>X)),x(W,"warner",(()=>Z));const K=j()||"",Y=K.split(","),Q=Date.now();function J(){return((Date.now()-(window.performance?.timeOrigin??Q))/1e3).toFixed(4)}function X(e,...t){""!==K&&("1"!==K&&-1===Y.indexOf(e)||window.console.info(`${J()}s\t\t ${e}`,t))}function Z(e,...t){""!==K&&("1"!==K&&-1===Y.indexOf(e)||window.console.warn(e,t))}D(z,V),D(z,U),D(z,B),D(z,F),D(z,W);var ee={},te={};x(te,"InstantConfigInterpreter",(()=>Oe));var ie={},ne={};function se(e){return Array.isArray(e)&&e.length>0&&"object"==typeof e[0]}function re(e){const t=e.sampling??e.s;return"number"==typeof t&&t>0&&t<100}x(ne,"shouldBeListOfConfigGroups",(()=>se)),x(ne,"hasSampling",(()=>re));var oe={};x(oe,"negativePrefix",(()=>ae)),x(oe,"cacheSuffix",(()=>de)),x(oe,"samplingSeparator",(()=>le)),x(oe,"worldWide",(()=>ce)),x(oe,"precision",(()=>ue)),x(oe,"experimentBucketSettingKey",(()=>pe));const ae="non-",de="-cached",le="/",ce="XX",ue=10**6,pe="eb";D(ie,ne),D(ie,{}),D(ie,{}),D(ie,{}),D(ie,{}),D(ie,{}),D(ie,{}),D(ie,oe);class he{constructor(e,t,i){this.container=t,this.settingsRepository=i,"number"==typeof e?this.experimentBucket=this.manageSampling(e):!0===e?this.experimentBucket=this.manageSampling(0):!1===e&&this.clean()}build(){return()=>this.experimentBucket??he.getRandomBucket()}static getRandomBucket(){return Math.round(100*Math.random())}manageSampling(e){const t=this.readFromLoaderVariable()??this.readFromSettings()??he.getRandomBucket();return this.storeInLoaderVariable(t),this.storeInSettings(t,e),t}readFromLoaderVariable(){return this.container.fandomContext?.experimentBucket}readFromSettings(){const e=this.settingsRepository&&this.settingsRepository.get(pe);return e&&Number(e)}storeInSettings(e,t){this.settingsRepository&&this.settingsRepository.set(pe,e.toString(),t)}storeInLoaderVariable(e){this.container.fandomContext=this.container.fandomContext||{},this.container.fandomContext.experimentBucket=e}clean(){this.settingsRepository&&this.settingsRepository.remove(pe)}}class ge{activeKeyValues=[];activeLabradorKeyValues=[];constructor(e){Array.isArray(e)?this.keyValueNamesMap=e.map((e=>e&&e.toString().split(":"))).filter((e=>e&&e.length>=2)).reduce(((e,t)=>(e[t[0]]=t[1],e)),{}):this.keyValueNamesMap={}}getActiveKeyValues(){return this.activeKeyValues}getActiveLabradorKeyValues(){return this.activeLabradorKeyValues}mark(e,t,i){const n=`${e}_${i?"B":"A"}_${i?t:100-t}`,s=this.keyValueNamesMap[n]??n;this.activeKeyValues.includes(n)||this.activeKeyValues.push(n),this.activeLabradorKeyValues.includes(s)||this.activeLabradorKeyValues.push(s)}}var me={},fe={};x(fe,"BrowserMatcher",(()=>ye));var ve={};function be(e){return e.startsWith(ae)?{value:e.replace(ae,""),negated:!0}:{value:e,negated:!1}}x(ve,"extractNegation",(()=>be));class ye{constructor(e){this.currentBrowser=e?.toLowerCase()}isValid(e){const t=e.b??e.browsers??[],i=t.map((e=>e.toLowerCase())).map((e=>be(e)));return 0===t.length||!this.currentBrowser||!this.isCurrentNegated(this.currentBrowser,i)&&i.some((e=>this.currentBrowser.includes(e.value)!==e.negated))}isCurrentNegated(e,t){return t.some((t=>e.includes(t.value)&&t.negated))}}var Se={};x(Se,"DeviceMatcher",(()=>we));class we{constructor(e){this.currentDevice=e}isValid(e){const t=(e.d??e.devices??[]).map((e=>e.toLowerCase())).map((e=>be(e)));return 0===t.length||!this.currentDevice||!this.isCurrentNegated(this.currentDevice,t)&&t.some((e=>e.value===this.currentDevice!==e.negated))}isCurrentNegated(e,t){return t.some((t=>e.includes(t.value)&&t.negated))}}var _e={};x(_e,"DomainMatcher",(()=>Ee));class Ee{isValid(e){const t=e.o??e.domains??[];return 0===t.length||t.some((e=>window.location.hostname.includes(e)))}}var Te={};x(Te,"RegionMatcher",(()=>Ie));class Ie{constructor(e){this.geo=e}isValid(e,t){const i=e.r??e.regions??[],n=this.filterOutInvalidRegions(i);return t?t(n):this.isProperGeo(n)}getCountryCode(){return this.geo?.country}getRegionCode(){return this.geo?.region}getContinentCode(){return this.geo?.continent}isProperGeo(e=[]){return!(!e||!e.indexOf||this.isGeoExcluded(e)||!(this.isProperContinent(e)||this.isProperCountry(e)||this.isProperRegion(e)))}filterOutInvalidRegions(e){return e.filter((e=>!e.includes(le))).filter((e=>!e.includes(de)))}isProperCountry(e){return!!(e&&e.indexOf&&(e.indexOf(this.getCountryCode())>-1||this.isSampledForGeo(e,this.getCountryCode())))}isProperRegion(e){const t=`${this.getCountryCode()}-${this.getRegionCode()}`;return!!(e&&e.indexOf&&(e.indexOf(t)>-1||this.isSampledForGeo(e,t)))}containsContinent(e){const t=`${ce}-${this.getContinentCode()}`;return e.indexOf(t)>-1||this.isSampledForGeo(e,t)}containsWorldWide(e){return e.indexOf(ce)>-1||this.isSampledForGeo(e,ce)}isProperContinent(e){return!(!e||!e.indexOf||!this.containsWorldWide(e)&&!this.containsContinent(e))}isGeoExcluded(e){return!!(e.indexOf(`${ae}${this.getCountryCode()}`)>-1||e.indexOf(`${ae}${this.getCountryCode()}-${this.getRegionCode()}`)>-1||e.indexOf(`${ae}${ce}-${this.getContinentCode()}`)>-1)}hasSampling(e){return t=>0!==t.indexOf(ae)&&t.indexOf(e+le)>-1}getSamplingLimits(e){let[,t]=e.split(le);return t=t.replace(de,""),Math.round(parseFloat(t)*ue)||0}isSampledForGeo(e,t){const i=e.filter(this.hasSampling(t));if(0===i.length)return!1;const n=Math.round(Math.random()*(100*ue))||0;return i.map((e=>this.getSamplingLimits(e))).some((e=>n<e))}}var Ae={};x(Ae,"SamplingMatcher",(()=>Ce));class Ce{constructor(e){this.samplingProvider=e,this.precision=10**6}isValid(e){return Math.round(this.samplingProvider()*this.precision)<Math.round(e*this.precision)}}D(me,fe),D(me,Se),D(me,_e),D(me,ve),D(me,Te),D(me,Ae);class Oe{constructor(e=new ye,t=new we,i=new Ee,n=new Ie,s){this.browserMatcher=e,this.deviceMatcher=t,this.domainMatcher=i,this.regionMatcher=n,this.settingsRepository=s,this.logGroup="instant-config-interpreter",this.configResponse={}}init(e,t={},i,n=window){return this.configResponse={...t,...e},this.regionValidationPredicate=i,this.labradorKeyValuesMapper=new ge(this.getValue("icLABradorGamKeyValues")),this.samplingMatcher=new Ce(new he(this.getValue("icExperimentBucket"),n,this.settingsRepository).build()),this}getValues(){return z.logger(this.logGroup,"get values called with",this.configResponse),void 0===this.values&&(this.values=Object.keys(this.configResponse).reduce(((e,t)=>(e[t]=this.getValue(t),e)),{})),this.values}getValue(e){const t=this.configResponse[e];if(se(t)){const i=t.find(this.predicate(e));return i?.v??i?.value}return t}getActiveKeyValues(){return this.labradorKeyValuesMapper.getActiveKeyValues()}getActiveLabradorKeyValues(){return this.labradorKeyValuesMapper.getActiveLabradorKeyValues()}predicate(e){return t=>{const i=this.browserMatcher.isValid(t)&&this.deviceMatcher.isValid(t)&&this.domainMatcher.isValid(t)&&this.regionMatcher.isValid(t,this.regionValidationPredicate);if(!re(t)||!1===i)return i;const n=t?.s??t?.sampling,s=this.samplingMatcher.isValid(n);return this.labradorKeyValuesMapper.mark(e,n,s),s}}}var Pe={};async function ke(e,t=2e3){const i=new AbortController,n=setTimeout((()=>i.abort()),t),s=await fetch(e,{signal:i.signal});return clearTimeout(n),s}x(Pe,"InstantConfigLoader",(()=>Le));const Ne="instant-config-loader";class Le{constructor(e,t=window){this.params=e,this.container=t,this.storage=new z.localStorageHelper(`instant-config-${e.appName}`,6e4),this.container.icbm=this.container.icbm||{},this.instantConfig=this.container.instantConfig,this.lockDelay="number"==typeof e.lockDelay?e.lockDelay:500}async getConfig(){if(this.instantConfig)return this.instantConfig;let e;return this.lockDelay>0?e=this.fetchInstantConfigThroughCache():(this.container.icbm.fetch||(this.container.icbm.fetch=this.fetchInstantConfig()),e=this.container.icbm.fetch),e.then((e=>e??this.fetchFallbackConfig()))}async fetchInstantConfigThroughCache(e=!1){if(z.lock()&&!e)return z.logger(Ne,"locked, awaiting",this.lockDelay),await M(this.lockDelay),this.fetchInstantConfigThroughCache(!0);try{const e=this.storage.get();if(e)return z.logger(Ne,"instant config pulled from local storage",e),JSON.parse(e);const t=await this.fetchInstantConfig();return t&&this.storage.set(JSON.stringify(t)),z.release(),t}catch(e){z.warner(Ne,"could not get instant config via cache",e),z.release()}}async fetchInstantConfig(){const e=this.params.instantConfigEndpoint??"https://services.fandom.com",t=this.params.instantConfigVariant??"icbm",{appName:i,compact:n}=this.params,s=new URLSearchParams({app:i});n&&s.set("compact","true");const r=`${e}/${t}/api/config?${s.toString()}`;try{const e=await ke(r,this.params.requestTimeout);if(!e.ok)return;const t=await e.json();return z.logger(Ne,"instant config fetched",t),t}catch(e){return void z.warner(Ne,"could not fetch instant config",e)}}async fetchFallbackConfig(){z.logger(Ne,"Fetching fallback config");const e=this.params.instantConfigFallbackEndpoint;if(void 0===e)return{};try{z.logger(Ne,e);const t=await ke(e,this.params.requestTimeout);if(!t.ok)return{};const i=await t.json();return z.logger(Ne,"fallback config fetched",i),i}catch(e){return z.warner(Ne,"could not fetch fallback config",e),{}}}}var Re={};x(Re,"InstantConfigOverrider",(()=>xe));const De=["InstantGlobals","icbm"];class xe{override(e,t){return[...e.keys()].filter((e=>{return t=e,De.some((e=>t.startsWith(`${e}.`)||t.startsWith(`${e}__`)));var t})).map((e=>{const[,t]=e.split(".").map((e=>e.split("__"))).flat();return{paramKey:e,key:t}})).map((({paramKey:t,key:i})=>({key:i,value:this.parseValue(e.get(t))}))).reduce(((e,{key:t,value:i})=>({...e,[t]:i})),t)}parseValue(e){if("true"===e||"false"===e)return"true"===e;const t=parseInt(e,10);if(e===`${t}`)return t;try{return JSON.parse(e)}catch(t){return e||null}}}D(ee,te),D(ee,Pe),D(ee,Re),D(ee,me);const ze="advertisement-label";var Ve=function(){return Ve=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var s in t=arguments[i])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},Ve.apply(this,arguments)},Me={channelId:"default",host:window,coordinatorHost:window.top},Ue={connect:"connect",connected:"connected"},je="@wikia/post-quecast";function Be(e){return e.channelId&&e.libId===je&&e.action&&function(e){return"string"==typeof e.type&&"number"==typeof e.timestamp}(e.action)}function $e(e){return!e.data.private}function Fe(e,t){return e.data.channelId===t}function He(e){return e.data.action}var Ge=function(){function e(){}return e.make=function(e){return function(e){var t;return e.host===e.coordinatorHost&&!!(null===(t=e.coordinatorHost[je])||void 0===t?void 0:t.callbackConnector)}(e)?e.coordinatorHost[je].callbackConnector:new We({senderHost:e.coordinatorHost,listenerHost:e.host})},e}(),qe=function(){function e(e){this.coordinatorHost=e,this.callbacks=[]}return e.prototype.dispatch=function(e){var t=this;if(!Be(e))throw new Error("Incorrect object type. Expected PostMessageData, but got "+e);this.callbacks.forEach((function(i){return i({data:e,source:t.coordinatorHost})}))},e.prototype.addListener=function(e){this.callbacks.push(e)},e.prototype.removeListener=function(e){this.callbacks=this.callbacks.filter((function(t){return t!==e}))},e}(),We=function(){function e(e){this.options=e,this.map=new Map}return e.prototype.dispatch=function(e){if(!Be(e))throw new Error("Incorrect object type. Expected PostMessageData, but got "+e);this.options.senderHost.postMessage(e,"*")},e.prototype.addListener=function(e){var t=function(t){var i;(i=t)&&i.source&&i.data&&Be(i.data)&&e(t)};this.map.set(e,t),this.options.listenerHost.addEventListener("message",t)},e.prototype.removeListener=function(e){var t=this.map.get(e);this.options.listenerHost.removeEventListener("message",t),this.map.delete(e)},e}(),Ke=function(){function e(e){this.callbacks=[],this.history=[],this.channelId=e.channelId,this.connector=Ge.make(e),this.setupActions(),this.setupConnection()}return e.prototype.setupActions=function(){this.getHistory(),this.listenEvent()},e.prototype.getHistory=function(){var e=this,t=function(i){if(Fe(i,e.channelId)&&function(e){return!!e.data.private}(i)){var n=He(i);(function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return t.some((function(t){return e.type===t}))})(n,Ue.connected)&&(e.connector.removeListener(t),e.handleActions.apply(e,n.history))}};this.connector.addListener(t)},e.prototype.listenEvent=function(){var e=this;this.connector.addListener((function(t){if(Fe(t,e.channelId)&&$e(t)){var i=He(t);e.handleActions(i)}}))},e.prototype.handleActions=function(){for(var e,t=this,i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];(e=this.history).push.apply(e,i),i.forEach((function(e){return t.callbacks.forEach((function(t){return t(e)}))}))},e.prototype.setupConnection=function(){this.connector.dispatch({action:{type:Ue.connect,timestamp:Date.now()},channelId:this.channelId,private:!0,libId:je})},e.prototype.addListener=function(e){this.history.forEach((function(t){return e(t)})),this.callbacks.push(e)},e.prototype.removeListener=function(e){this.callbacks=this.callbacks.filter((function(t){return t!==e}))},e}(),Ye=function(){function e(e){void 0===e&&(e={});var t=Ve(Ve({},Me),e);this.channelId=t.channelId,this.connector=Ge.make(t)}return e.prototype.dispatch=function(e){this.connector.dispatch({action:Ve(Ve({},e),{timestamp:Date.now()}),channelId:this.channelId,private:!0,libId:je})},e}(),Qe=function(){function e(e){void 0===e&&(e={});var t=Ve(Ve({},Me),e);this.transmitter=new Ye(t),this.receiver=new Ke(t)}return e.prototype.dispatch=function(e){this.transmitter.dispatch(e)},e.prototype.addListener=function(e){this.receiver.addListener(e)},e.prototype.removeListener=function(e){this.receiver.removeListener(e)},e}(),Je=function(){function e(e,t){this.channelId=e,this.connectors=new Map,this.history=[],this.connectors.set(t,t[je].callbackConnector)}return e.prototype.addConnection=function(e){this.ensureConnector(e).dispatch({action:this.createConnectedAction(),private:!0,channelId:this.channelId,libId:je})},e.prototype.createConnectedAction=function(){return{type:Ue.connected,history:this.history,timestamp:Date.now()}},e.prototype.broadcast=function(e){var t=this;this.history.push(e),this.connectors.forEach((function(i){i.dispatch({action:e,channelId:t.channelId,libId:je})}))},e.prototype.ensureConnector=function(e){return this.connectors.has(e)||this.connectors.set(e,new We({senderHost:e,listenerHost:e})),this.connectors.get(e)},e}(),Xe=function(){function e(e){this.coordinatorHost=e,this.channels=new Map,this.callbackConnector=new qe(e),this.postMessageConnector=new We({senderHost:e,listenerHost:e})}return e.prototype.init=function(){var e=this,t=function(t){$e(t)||(e.handleConnect(t),e.handleBroadcast(t))};this.callbackConnector.addListener(t),this.postMessageConnector.addListener(t)},e.prototype.handleConnect=function(e){(function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return t.some((function(t){return e.data.action.type===t}))})(e,Ue.connect)&&this.ensureChannel(e.data.channelId).addConnection(e.source)},e.prototype.handleBroadcast=function(e){(function(e){return!Object.values(Ue).some((function(t){return e.data.action.type===t}))})(e)&&this.ensureChannel(e.data.channelId).broadcast(e.data.action)},e.prototype.ensureChannel=function(e){return this.channels.has(e)||this.channels.set(e,new Je(e,this.coordinatorHost)),this.channels.get(e)},e}();function Ze(e){return"function"==typeof e}function et(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var tt=et((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}));function it(e,t){if(e){var i=e.indexOf(t);0<=i&&e.splice(i,1)}}var nt=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var e,t,i,n,s;if(!this.closed){this.closed=!0;var r=this._parentage;if(r)if(this._parentage=null,Array.isArray(r))try{for(var o=p(r),a=o.next();!a.done;a=o.next())a.value.remove(this)}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}else r.remove(this);var d=this.initialTeardown;if(Ze(d))try{d()}catch(e){s=e instanceof tt?e.errors:[e]}var l=this._finalizers;if(l){this._finalizers=null;try{for(var c=p(l),u=c.next();!u.done;u=c.next()){var m=u.value;try{ot(m)}catch(e){s=null!=s?s:[],e instanceof tt?s=g(g([],h(s)),h(e.errors)):s.push(e)}}}catch(e){i={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(i)throw i.error}}}if(s)throw new tt(s)}},e.prototype.add=function(t){var i;if(t&&t!==this)if(this.closed)ot(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(i=this._finalizers)&&void 0!==i?i:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&it(t,e)},e.prototype.remove=function(t){var i=this._finalizers;i&&it(i,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e;var t}(),st=nt.EMPTY;function rt(e){return e instanceof nt||e&&"closed"in e&&Ze(e.remove)&&Ze(e.add)&&Ze(e.unsubscribe)}function ot(e){Ze(e)?e():e.unsubscribe()}var at={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},dt={setTimeout:function(e,t){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];var s=dt.delegate;return(null==s?void 0:s.setTimeout)?s.setTimeout.apply(s,g([e,t],h(i))):setTimeout.apply(void 0,g([e,t],h(i)))},clearTimeout:function(e){var t=dt.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function lt(e){dt.setTimeout((function(){var t=at.onUnhandledError;if(!t)throw e;t(e)}))}function ct(){}var ut=pt("C",void 0,void 0);function pt(e,t,i){return{kind:e,value:t,error:i}}var ht=null;function gt(e){if(at.useDeprecatedSynchronousErrorHandling){var t=!ht;if(t&&(ht={errorThrown:!1,error:null}),e(),t){var i=ht,n=i.errorThrown,s=i.error;if(ht=null,n)throw s}}else e()}var mt=function(e){function t(t){var i=e.call(this)||this;return i.isStopped=!1,t?(i.destination=t,rt(t)&&t.add(i)):i.destination=_t,i}return o(t,e),t.create=function(e,t,i){return new yt(e,t,i)},t.prototype.next=function(e){this.isStopped?wt(function(e){return pt("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?wt(pt("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?wt(ut,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(nt),ft=Function.prototype.bind;function vt(e,t){return ft.call(e,t)}var bt=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){St(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){St(e)}else St(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){St(e)}},e}(),yt=function(e){function t(t,i,n){var s,r,o=e.call(this)||this;return Ze(t)||!t?s={next:null!=t?t:void 0,error:null!=i?i:void 0,complete:null!=n?n:void 0}:o&&at.useDeprecatedNextContext?((r=Object.create(t)).unsubscribe=function(){return o.unsubscribe()},s={next:t.next&&vt(t.next,r),error:t.error&&vt(t.error,r),complete:t.complete&&vt(t.complete,r)}):s=t,o.destination=new bt(s),o}return o(t,e),t}(mt);function St(e){var t;at.useDeprecatedSynchronousErrorHandling?(t=e,at.useDeprecatedSynchronousErrorHandling&&ht&&(ht.errorThrown=!0,ht.error=t)):lt(e)}function wt(e,t){var i=at.onStoppedNotification;i&&dt.setTimeout((function(){return i(e,t)}))}var _t={closed:!0,next:ct,error:function(e){throw e},complete:ct},Et="function"==typeof Symbol&&Symbol.observable||"@@observable";function Tt(e){return e}var It=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var i=new e;return i.source=this,i.operator=t,i},e.prototype.subscribe=function(e,t,i){var n,s=this,r=(n=e)&&n instanceof mt||function(e){return e&&Ze(e.next)&&Ze(e.error)&&Ze(e.complete)}(n)&&rt(n)?e:new yt(e,t,i);return gt((function(){var e=s,t=e.operator,i=e.source;r.add(t?t.call(r,i):i?s._subscribe(r):s._trySubscribe(r))})),r},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var i=this;return new(t=At(t))((function(t,n){var s=new yt({next:function(t){try{e(t)}catch(e){n(e),s.unsubscribe()}},error:n,complete:t});i.subscribe(s)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[Et]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0===(i=e).length?Tt:1===i.length?i[0]:function(e){return i.reduce((function(e,t){return t(e)}),e)})(this);var i},e.prototype.toPromise=function(e){var t=this;return new(e=At(e))((function(e,i){var n;t.subscribe((function(e){return n=e}),(function(e){return i(e)}),(function(){return e(n)}))}))},e.create=function(t){return new e(t)},e}();function At(e){var t;return null!==(t=null!=e?e:at.Promise)&&void 0!==t?t:Promise}function Ct(e){return Ze(null==e?void 0:e.lift)}function Ot(e){return function(t){if(Ct(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}function Pt(e,t,i,n,s){return new kt(e,t,i,n,s)}var kt=function(e){function t(t,i,n,s,r,o){var a=e.call(this,t)||this;return a.onFinalize=r,a.shouldUnsubscribe=o,a._next=i?function(e){try{i(e)}catch(e){t.error(e)}}:e.prototype._next,a._error=s?function(e){try{s(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,a._complete=n?function(){try{n()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,a}return o(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var i=this.closed;e.prototype.unsubscribe.call(this),!i&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(mt);function Nt(e,t){return Ot((function(i,n){var s=0;i.subscribe(Pt(n,(function(i){n.next(e.call(t,i,s++))})))}))}var Lt=Array.isArray;function Rt(e){return Nt((function(t){return function(e,t){return Lt(t)?e.apply(void 0,g([],h(t))):e(t)}(e,t)}))}function Dt(e,t,i){return i?Dt(e,t).pipe(Rt(i)):new It((function(i){var n=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i.next(1===e.length?e[0]:e)},s=e(n);return Ze(t)?function(){return t(n,s)}:void 0}))}var xt=et((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),zt=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return o(t,e),t.prototype.lift=function(e){var t=new Vt(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new xt},t.prototype.next=function(e){var t=this;gt((function(){var i,n;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var s=p(t.currentObservers),r=s.next();!r.done;r=s.next())r.value.next(e)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}}}))},t.prototype.error=function(e){var t=this;gt((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var i=t.observers;i.length;)i.shift().error(e)}}))},t.prototype.complete=function(){var e=this;gt((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,i=this,n=i.hasError,s=i.isStopped,r=i.observers;return n||s?st:(this.currentObservers=null,r.push(e),new nt((function(){t.currentObservers=null,it(r,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,i=t.hasError,n=t.thrownError,s=t.isStopped;i?e.error(n):s&&e.complete()},t.prototype.asObservable=function(){var e=new It;return e.source=this,e},t.create=function(e,t){return new Vt(e,t)},t}(It),Vt=function(e){function t(t,i){var n=e.call(this)||this;return n.destination=t,n.source=i,n}return o(t,e),t.prototype.next=function(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)},t.prototype.error=function(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:st},t}(zt),Mt=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function Ut(e){return Ze(null==e?void 0:e.then)}function jt(e){return Ze(e[Et])}function Bt(e){return Symbol.asyncIterator&&Ze(null==e?void 0:e[Symbol.asyncIterator])}function $t(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var Ft="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function Ht(e){return Ze(null==e?void 0:e[Ft])}function Gt(e){return function(e,t,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,s=i.apply(e,t||[]),r=[];return n={},o("next"),o("throw"),o("return",(function(e){return function(t){return Promise.resolve(t).then(e,l)}})),n[Symbol.asyncIterator]=function(){return this},n;function o(e,t){s[e]&&(n[e]=function(t){return new Promise((function(i,n){r.push([e,t,i,n])>1||a(e,t)}))},t&&(n[e]=t(n[e])))}function a(e,t){try{(i=s[e](t)).value instanceof m?Promise.resolve(i.value.v).then(d,l):c(r[0][2],i)}catch(e){c(r[0][3],e)}var i}function d(e){a("next",e)}function l(e){a("throw",e)}function c(e,t){e(t),r.shift(),r.length&&a(r[0][0],r[0][1])}}(this,arguments,(function(){var t,i,n;return u(this,(function(s){switch(s.label){case 0:t=e.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,m(t.read())];case 3:return i=s.sent(),n=i.value,i.done?[4,m(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return[4,m(n)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function qt(e){return Ze(null==e?void 0:e.getReader)}function Wt(e){if(e instanceof It)return e;if(null!=e){if(jt(e))return s=e,new It((function(e){var t=s[Et]();if(Ze(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(Mt(e))return n=e,new It((function(e){for(var t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()}));if(Ut(e))return i=e,new It((function(e){i.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,lt)}));if(Bt(e))return Kt(e);if(Ht(e))return t=e,new It((function(e){var i,n;try{for(var s=p(t),r=s.next();!r.done;r=s.next()){var o=r.value;if(e.next(o),e.closed)return}}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}e.complete()}));if(qt(e))return Kt(Gt(e))}var t,i,n,s;throw $t(e)}function Kt(e){return new It((function(t){(function(e,t){var i,n,s,r;return c(this,void 0,void 0,(function(){var o,a;return u(this,(function(d){switch(d.label){case 0:d.trys.push([0,5,6,11]),i=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e=p(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=e[i]&&function(t){return new Promise((function(n,s){!function(e,t,i,n){Promise.resolve(n).then((function(t){e({value:t,done:i})}),t)}(n,s,(t=e[i](t)).done,t.value)}))}}}(e),d.label=1;case 1:return[4,i.next()];case 2:if((n=d.sent()).done)return[3,4];if(o=n.value,t.next(o),t.closed)return[2];d.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=d.sent(),s={error:a},[3,11];case 6:return d.trys.push([6,,9,10]),n&&!n.done&&(r=i.return)?[4,r.call(i)]:[3,8];case 7:d.sent(),d.label=8;case 8:return[3,10];case 9:if(s)throw s.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))}))})(e,t).catch((function(e){return t.error(e)}))}))}function Yt(e,t,i,n,s){void 0===n&&(n=0),void 0===s&&(s=!1);var r=t.schedule((function(){i(),s?e.add(this.schedule(null,n)):this.unsubscribe()}),n);if(e.add(r),!s)return r}function Qt(e,t,i){return void 0===i&&(i=1/0),Ze(t)?Qt((function(i,n){return Nt((function(e,s){return t(i,e,n,s)}))(Wt(e(i,n)))}),i):("number"==typeof t&&(i=t),Ot((function(t,n){return function(e,t,i,n,s,r,o,a){var d=[],l=0,c=0,u=!1,p=function(){!u||d.length||l||t.complete()},h=function(e){return l<n?g(e):d.push(e)},g=function(e){l++;var s=!1;Wt(i(e,c++)).subscribe(Pt(t,(function(e){t.next(e)}),(function(){s=!0}),void 0,(function(){if(s)try{l--;for(;d.length&&l<n;)e=void 0,e=d.shift(),g(e);p()}catch(e){t.error(e)}var e})))};return e.subscribe(Pt(t,h,(function(){u=!0,p()}))),function(){}}(t,n,e,i)})))}function Jt(e){return void 0===e&&(e=1/0),Qt(Tt,e)}var Xt=new It((function(e){return e.complete()}));function Zt(e){return e&&Ze(e.schedule)}function ei(e){return e[e.length-1]}function ti(e){return Ze(ei(e))?e.pop():void 0}function ii(e){return Zt(ei(e))?e.pop():void 0}function ni(e,t){return void 0===t&&(t=0),Ot((function(i,n){i.subscribe(Pt(n,(function(i){return Yt(n,e,(function(){return n.next(i)}),t)}),(function(){return Yt(n,e,(function(){return n.complete()}),t)}),(function(i){return Yt(n,e,(function(){return n.error(i)}),t)})))}))}function si(e,t){return void 0===t&&(t=0),Ot((function(i,n){n.add(e.schedule((function(){return i.subscribe(n)}),t))}))}function ri(e,t){if(!e)throw new Error("Iterable cannot be null");return new It((function(i){Yt(i,t,(function(){var n=e[Symbol.asyncIterator]();Yt(i,t,(function(){n.next().then((function(e){e.done?i.complete():i.next(e.value)}))}),0,!0)}))}))}function oi(e,t){return t?function(e,t){if(null!=e){if(jt(e))return function(e,t){return Wt(e).pipe(si(t),ni(t))}(e,t);if(Mt(e))return function(e,t){return new It((function(i){var n=0;return t.schedule((function(){n===e.length?i.complete():(i.next(e[n++]),i.closed||this.schedule())}))}))}(e,t);if(Ut(e))return function(e,t){return Wt(e).pipe(si(t),ni(t))}(e,t);if(Bt(e))return ri(e,t);if(Ht(e))return function(e,t){return new It((function(i){var n;return Yt(i,t,(function(){n=e[Ft](),Yt(i,t,(function(){var e,t,s;try{t=(e=n.next()).value,s=e.done}catch(e){return void i.error(e)}s?i.complete():i.next(t)}),0,!0)})),function(){return Ze(null==n?void 0:n.return)&&n.return()}}))}(e,t);if(qt(e))return function(e,t){return ri(Gt(e),t)}(e,t)}throw $t(e)}(e,t):Wt(e)}function ai(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=ii(e),n=function(e,t){return"number"==typeof ei(e)?e.pop():1/0}(e),s=e;return s.length?1===s.length?Wt(s[0]):Jt(n)(oi(s,i)):Xt}var di={now:function(){return(di.delegate||Date).now()},delegate:void 0},li=function(e){function t(t,i,n){void 0===t&&(t=1/0),void 0===i&&(i=1/0),void 0===n&&(n=di);var s=e.call(this)||this;return s._bufferSize=t,s._windowTime=i,s._timestampProvider=n,s._buffer=[],s._infiniteTimeWindow=!0,s._infiniteTimeWindow=i===1/0,s._bufferSize=Math.max(1,t),s._windowTime=Math.max(1,i),s}return o(t,e),t.prototype.next=function(t){var i=this,n=i.isStopped,s=i._buffer,r=i._infiniteTimeWindow,o=i._timestampProvider,a=i._windowTime;n||(s.push(t),!r&&s.push(o.now()+a)),this._trimBuffer(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),i=this._infiniteTimeWindow,n=this._buffer.slice(),s=0;s<n.length&&!e.closed;s+=i?1:2)e.next(n[s]);return this._checkFinalizedStatuses(e),t},t.prototype._trimBuffer=function(){var e=this,t=e._bufferSize,i=e._timestampProvider,n=e._buffer,s=e._infiniteTimeWindow,r=(s?1:2)*t;if(t<1/0&&r<n.length&&n.splice(0,n.length-r),!s){for(var o=i.now(),a=0,d=1;d<n.length&&n[d]<=o;d+=2)a=d;a&&n.splice(0,a+1)}},t}(zt);function ci(e,t){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];if(!0!==t){if(!1!==t){var s=new yt({next:function(){s.unsubscribe(),e()}});return Wt(t.apply(void 0,g([],h(i)))).subscribe(s)}}else e()}function ui(e,t,i){var n,s,r,o,a=!1;return e&&"object"==typeof e?(n=e.bufferSize,o=void 0===n?1/0:n,s=e.windowTime,t=void 0===s?1/0:s,a=void 0!==(r=e.refCount)&&r,i=e.scheduler):o=null!=e?e:1/0,function(e){void 0===e&&(e={});var t=e.connector,i=void 0===t?function(){return new zt}:t,n=e.resetOnError,s=void 0===n||n,r=e.resetOnComplete,o=void 0===r||r,a=e.resetOnRefCountZero,d=void 0===a||a;return function(e){var t,n,r,a=0,l=!1,c=!1,u=function(){null==n||n.unsubscribe(),n=void 0},p=function(){u(),t=r=void 0,l=c=!1},h=function(){var e=t;p(),null==e||e.unsubscribe()};return Ot((function(e,g){a++,c||l||u();var m=r=null!=r?r:i();g.add((function(){0!=--a||c||l||(n=ci(h,d))})),m.subscribe(g),!t&&a>0&&(t=new yt({next:function(e){return m.next(e)},error:function(e){c=!0,u(),n=ci(p,s,e),m.error(e)},complete:function(){l=!0,u(),n=ci(p,o),m.complete()}}),Wt(e).subscribe(t))}))(e)}}({connector:function(){return new li(o,t,i)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:a})}function pi(e,t){return Ot((function(i,n){var s=0;i.subscribe(Pt(n,(function(i){return e.call(t,i,s++)&&n.next(i)})))}))}function hi(e){return e<=0?function(){return Xt}:Ot((function(t,i){var n=0;t.subscribe(Pt(i,(function(t){++n<=e&&(i.next(t),e<=n&&i.complete())})))}))}function gi(e){return pi((function(t,i){return e<=i}))}const mi={name:"Ad Slot added",payload:{_as:"props",_p:void 0}},fi={name:"Ad Slot event",payload:{_as:"props",_p:void 0}},vi={name:"Ad Slot loaded",payload:{_as:"props",_p:void 0}},bi={name:"Ad slot resized",payload:{_as:"props",_p:void 0}},yi={name:"Invalidate slot targeting",payload:{_as:"props",_p:void 0}};function Si(...e){return t=>t.pipe(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return pi((function(t){var i=t.type;return e.some((function(e){return e.type===i}))}))}(...e),pi((t=>e.some((e=>!0===e.__global?L(t):!L(t))))))}class wi{static connect(e="AdEngine"){if(this.devtools)throw new Error("Trying to initialize ReduxDevtools second time");const t=window.__REDUX_DEVTOOLS_EXTENSION__;if(t)return this.devtools=t.connect({name:e})}}const _i=new class{constructor(){const{channelId:e,coordinatorName:t,reduxDevtoolsName:i}=this.getSettings();!function(e){if(void 0===e&&(e=window),!e[je]){var t=new Xe(e);t.init(),e[je]=t}}(),this.communicator=new Qe({channelId:e||"default",coordinatorHost:window[t]||top});const n=Dt((e=>this.communicator.addListener(e)),(e=>this.communicator.removeListener(e))).pipe(ui({refCount:!0}));this.subject=new zt,this.action$=ai(n.pipe(pi((e=>L(e)))),this.subject.asObservable().pipe(pi((e=>!L(e))))),this.connectReduxDevtools(i)}emit(e,t){this.dispatch(this.getGlobalAction(e)(t))}on(e,t,i=!0){this.action$.pipe(Si(this.getGlobalAction(e)),i?hi(1):gi(0)).subscribe(t)}onSlotEvent(e,t,i="",n=!1){this.action$.pipe(Si(this.getGlobalAction(fi)),pi((t=>t.event===e.toString()&&(!i||t.adSlotName===i))),n?hi(1):gi(0)).subscribe(t)}dispatch(e){L(e)?this.communicator.dispatch(e):this.subject.next(e)}getGlobalAction(e){return e.action||(e.action=e.payload?R(`${e.category||"[AdEngine]"} ${e.name}`,e.payload):R(`${e.category||"[AdEngine]"} ${e.name}`)),e.action}getSettings(){return window["@wikia/post-quecast-settings"]||{}}connectReduxDevtools(e){const t=wi.connect(e);t&&(t.subscribe((e=>{try{if("@devtools-extension"===e.source&&"ACTION"===e.type){const t=new Function(`return ${e.payload}`)();this.dispatch(t)}}catch(e){t.error(e.message)}})),this.action$.subscribe((e=>t.send(e,{}))))}},Ei={IDENTITY_PARTNER_DATA_OBTAINED:{name:"Identity partner data obtained",payload:{_as:"payload",_p:void 0}},PARTNER_LOAD_STATUS:{name:"Partner load status",payload:{_as:"props",_p:void 0}},ANYCLIP_READY:{name:"Anyclip ready"},ANYCLIP_START:{name:"Anyclip start"},ANYCLIP_LATE_INJECT:{name:"Anyclip late inject"},SYSTEM1_STARTED:{name:"System1 started"},NO_NATIVE_PREBID_AD:{name:"No native prebid ad",payload:{_as:"props",_p:void 0}},INTENT_IQ_GROUP_OBTAINED:{name:"IntentIQ A/B test group obtained",payload:{_as:"props",_p:void 0}},NO_NATIVO_AD:{name:"No nativo ad",payload:{_as:"props",_p:void 0}},LIVE_CONNECT_STARTED:{name:"LiveConnect started"},LIVE_CONNECT_CACHED:{name:"LiveConnect data cached"},LIVE_CONNECT_RESPONDED_UUID:{name:"LiveConnect responded with UUID"},LIVE_CONNECT_LOADED:{name:"LiveConnect loaded"},YAHOO_STARTED:{name:"Yahoo started"},IDENTITY_ENGINE_READY:{category:"[IdentityEngine]",name:"Identity ready"},F2_HIDE_SMART_BANNER:{category:"[AdEngine F2 Templates]",name:"hide smart banner"},FAN_FEED_READY:{category:"[FanFeed]",name:"Ready"},QUIZ_AD_INJECTED:{category:"[quizConsumption]",name:"ad slot injected",payload:{_as:"props",_p:void 0}},RAIL_READY:{category:"[Rail]",name:"Ready"},MOBILE_MORE_ICB_EXPERIMENT:{name:"Mobile More ICB Experiment event"}},Ti=new class{loadPixel(e,t){const i=document.createElement("img");i.src=e,i.onload=()=>{Wn(t,"pixel loaded"),_i.emit(Ei.PARTNER_LOAD_STATUS,{status:t+"_loaded"})},document.body.appendChild(i)}};s(727);var Ii="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ai=window.device,Ci={},Oi=[];window.device=Ci;var Pi=window.document.documentElement,ki=window.navigator.userAgent.toLowerCase(),Ni=["googletv","viera","smarttv","internet.tv","netcast","nettv","appletv","boxee","kylo","roku","dlnadoc","pov_tv","hbbtv","ce-html"];function Li(e,t){return-1!==e.indexOf(t)}function Ri(e){return Li(ki,e)}function Di(e){return Pi.className.match(new RegExp(e,"i"))}function xi(e){var t=null;Di(e)||(t=Pi.className.replace(/^\s+|\s+$/g,""),Pi.className=t+" "+e)}function zi(e){Di(e)&&(Pi.className=Pi.className.replace(" "+e,""))}function Vi(){Ci.landscape()?(zi("portrait"),xi("landscape"),Mi("landscape")):(zi("landscape"),xi("portrait"),Mi("portrait")),Bi()}function Mi(e){for(var t=0;t<Oi.length;t++)Oi[t](e)}Ci.macos=function(){return Ri("mac")},Ci.ios=function(){return Ci.iphone()||Ci.ipod()||Ci.ipad()},Ci.iphone=function(){return!Ci.windows()&&Ri("iphone")},Ci.ipod=function(){return Ri("ipod")},Ci.ipad=function(){var e="MacIntel"===navigator.platform&&navigator.maxTouchPoints>1;return Ri("ipad")||e},Ci.android=function(){return!Ci.windows()&&Ri("android")},Ci.androidPhone=function(){return Ci.android()&&Ri("mobile")},Ci.androidTablet=function(){return Ci.android()&&!Ri("mobile")},Ci.blackberry=function(){return Ri("blackberry")||Ri("bb10")},Ci.blackberryPhone=function(){return Ci.blackberry()&&!Ri("tablet")},Ci.blackberryTablet=function(){return Ci.blackberry()&&Ri("tablet")},Ci.windows=function(){return Ri("windows")},Ci.windowsPhone=function(){return Ci.windows()&&Ri("phone")},Ci.windowsTablet=function(){return Ci.windows()&&Ri("touch")&&!Ci.windowsPhone()},Ci.fxos=function(){return(Ri("(mobile")||Ri("(tablet"))&&Ri(" rv:")},Ci.fxosPhone=function(){return Ci.fxos()&&Ri("mobile")},Ci.fxosTablet=function(){return Ci.fxos()&&Ri("tablet")},Ci.meego=function(){return Ri("meego")},Ci.cordova=function(){return window.cordova&&"file:"===location.protocol},Ci.nodeWebkit=function(){return"object"===Ii(window.process)},Ci.mobile=function(){return Ci.androidPhone()||Ci.iphone()||Ci.ipod()||Ci.windowsPhone()||Ci.blackberryPhone()||Ci.fxosPhone()||Ci.meego()},Ci.tablet=function(){return Ci.ipad()||Ci.androidTablet()||Ci.blackberryTablet()||Ci.windowsTablet()||Ci.fxosTablet()},Ci.desktop=function(){return!Ci.tablet()&&!Ci.mobile()},Ci.television=function(){for(var e=0;e<Ni.length;){if(Ri(Ni[e]))return!0;e++}return!1},Ci.portrait=function(){return screen.orientation&&Object.prototype.hasOwnProperty.call(window,"onorientationchange")?Li(screen.orientation.type,"portrait"):Ci.ios()&&Object.prototype.hasOwnProperty.call(window,"orientation")?90!==Math.abs(window.orientation):window.innerHeight/window.innerWidth>1},Ci.landscape=function(){return screen.orientation&&Object.prototype.hasOwnProperty.call(window,"onorientationchange")?Li(screen.orientation.type,"landscape"):Ci.ios()&&Object.prototype.hasOwnProperty.call(window,"orientation")?90===Math.abs(window.orientation):window.innerHeight/window.innerWidth<1},Ci.noConflict=function(){return window.device=Ai,this},Ci.ios()?Ci.ipad()?xi("ios ipad tablet"):Ci.iphone()?xi("ios iphone mobile"):Ci.ipod()&&xi("ios ipod mobile"):Ci.macos()?xi("macos desktop"):Ci.android()?Ci.androidTablet()?xi("android tablet"):xi("android mobile"):Ci.blackberry()?Ci.blackberryTablet()?xi("blackberry tablet"):xi("blackberry mobile"):Ci.windows()?Ci.windowsTablet()?xi("windows tablet"):Ci.windowsPhone()?xi("windows mobile"):xi("windows desktop"):Ci.fxos()?Ci.fxosTablet()?xi("fxos tablet"):xi("fxos mobile"):Ci.meego()?xi("meego mobile"):Ci.nodeWebkit()?xi("node-webkit"):Ci.television()?xi("television"):Ci.desktop()&&xi("desktop"),Ci.cordova()&&xi("cordova"),Ci.onChangeOrientation=function(e){"function"==typeof e&&Oi.push(e)};var Ui="resize";function ji(e){for(var t=0;t<e.length;t++)if(Ci[e[t]]())return e[t];return"unknown"}function Bi(){Ci.orientation=ji(["portrait","landscape"])}Object.prototype.hasOwnProperty.call(window,"onorientationchange")&&(Ui="orientationchange"),window.addEventListener?window.addEventListener(Ui,Vi,!1):window.attachEvent?window.attachEvent(Ui,Vi):window[Ui]=Vi,Vi(),Ci.type=ji(["mobile","tablet","desktop"]),Ci.os=ji(["ios","iphone","ipad","ipod","android","blackberry","macos","windows","fxos","meego","television"]),Bi();const $i=Ci;let Fi,Hi=null,Gi=!1,qi=null;const Wi=new class{isSmartphone(){return $i.mobile()}isTablet(){return $i.tablet()}isDesktop(){return!this.isSmartphone()&&!this.isTablet()}checkBlocking(e=(()=>{}),t=(()=>{})){return new Promise((e=>{if(!Gi){if("undefined"==typeof BlockAdBlock)return void e(!0);Fi=new BlockAdBlock({checkOnLoad:!1,resetOnEnd:!0,loopCheckTime:50,loopMaxNumber:5}),Gi=!0}Fi.onDetected((()=>e(!0))),Fi.onNotDetected((()=>e(!1))),Fi.check(!0)})).then((i=>(i?e():t(),i)))}getDeviceType(){return this.isTablet()?"tablet":this.isSmartphone()?"smartphone":"desktop"}getDeviceMode(){return window.matchMedia("(max-width: 840px)").matches?"mobile":"desktop"}getOperatingSystem(){if(null!==qi)return qi;const{userAgent:e}=window.navigator;return qi="unknown",-1!==e.indexOf("Win")&&(qi="Windows"),-1!==e.indexOf("Mac")&&(qi="OSX"),-1!==e.indexOf("Linux")&&(qi="Linux"),-1!==e.indexOf("Android")&&(qi="Android"),-1!==e.indexOf("like Mac")&&(qi="iOS"),qi}getBrowser(){if(null!==Hi)return Hi;const{appName:e,appVersion:t,userAgent:i}=window.navigator;let n,s=i.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(s[1])?(n=/\brv[ :]+(\d+)/g.exec(i)||[""],Hi=`IE ${n[1]||""}`,Hi):"Chrome"===s[1]&&(n=i.match(/\b(OPR|Edge)\/(\d+)/),null!==n)?(Hi=n.slice(1).join(" ").replace("OPR","Opera"),Hi):(s=s[2]?[s[1],s[2]]:[e,t,"-?"],n=i.match(/version\/(\d+)/i),null!==n&&s.splice(1,1,n[1]),Hi=s.join(" "),Hi)}isChromeBrowser(){return"Chrome"===this.getBrowser().split(" ")[0]}isSafari(){return"Safari"===this.getBrowser().split(" ")[0]}isSteamPlatform(){const{userAgent:e}=window.navigator;return e.toLowerCase().indexOf("steam")>-1}};function Ki(e,t){let i=null;return function(...n){clearTimeout(i),i=setTimeout((()=>{e.apply(this,n)}),t)}}function Yi(e){let t=null;return function(i,n,s){const r=s.value;return s.value=function(...i){clearTimeout(t),t=setTimeout((()=>{r.apply(this,i)}),e)},s}}function Qi(e){return function(t,i,n){const s=n.value;return n.value=e.call(this,s),n}}var Ji;function Xi(e){return e?parseFloat(getComputedStyle(e,null).width.replace("px","")):0}function Zi(e){return e?parseFloat(getComputedStyle(e,null).height.replace("px","")):0}function en(e){let t=!1;const i={display:"",height:""};e.classList.contains(Ji.HIDDEN_AD_CLASS)&&(t=!0,i.display=e.style.display,i.height=e.style.height,e.classList.remove(Ji.HIDDEN_AD_CLASS),e.style.display="block",e.style.height="1px");const n=function(e){const t=e.getBoundingClientRect(),i=window.pageXOffset||document.documentElement.scrollLeft,n=window.pageYOffset||document.documentElement.scrollTop;return{top:t.top+n,left:t.left+i}}(e);return t&&(e.classList.add(Ji.HIDDEN_AD_CLASS),e.style.display=i.display,e.style.height=i.height),n}function tn(e){return en(e).top}function nn(e){return en(e).left}function sn(){return Math.max(document.documentElement.clientHeight,window.innerHeight||0)}function rn(){return Math.max(document.documentElement.clientWidth,window.innerWidth||0)}function on(e,{topOffset:t=0,bottomOffset:i=0,areaThreshold:n=.5}={}){const s=window.getComputedStyle(e).position;if(["fixed","sticky"].includes(s))return!0;const r=e.offsetHeight,o=tn(e),a=o+r,d=window.scrollY,l=sn(),c=n*r;return o>=t+d-c&&a<=i+d+l+c}function an(e,t=[]){if(null===e.offsetParent)return!1;const i=e.offsetHeight,n=tn(e),s=sn();return t.some((t=>{if(e.previousSibling&&e.previousSibling.isSameNode(t)||e.nextSibling&&e.nextSibling.isSameNode(t))return!0;const r=t.offsetHeight,o=tn(t);return(o<n?n-o-r:o-n-i)<s}))}function dn(e){return"IFRAME"===e.tagName}function ln(e){try{return e.self!==e.top}catch(e){return!0}}!function(e){e.AD_CLASS="gpt-ad",e.AD_SLOT_PLACEHOLDER_CLASS="ad-slot-placeholder",e.HIDDEN_AD_CLASS="hidead"}(Ji||(Ji={}));class cn{static getFirstElementChild(e){return e.firstElementChild}}class un{fetch(e){return c(this,arguments,void 0,(function*(e,t=2e3,i){const n=new AbortController,s=setTimeout((()=>n.abort()),t),r=yield fetch(e,Object.assign({signal:n.signal},i));return clearTimeout(s),r}))}}const pn=(e=0)=>new Promise(((t,i)=>{"number"==typeof e?setTimeout(t,e):i(new Error("Delay value must be a number."))}));function hn(e,...t){return new Promise(((i,n)=>{"function"==typeof e?setTimeout((()=>i(e(...t))),0):n(new Error("Expected a function."))}))}function gn(e,t,i={}){const n="object"==typeof e&&"function"==typeof e.addEventListener,s="boolean"==typeof i?{capture:i}:Object.assign({},i);return new Promise(((i,r)=>{n?e.addEventListener(t,i,Object.assign(Object.assign({},s),{once:!0})):r(new Error("Emitter does not have `addEventListener` nor `once` method."))}))}function mn(e){return new Promise(((t,i)=>{setTimeout(i,e)}))}function fn(e,t=2e3){return Promise.race([new Promise(e),mn(t)])}function vn(){let e,t;const i=new Promise(((i,n)=>{e=i,t=n}));return i.resolve=e,i.reject=t,i}function bn(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}function yn(){return O.get("geo.country")}function Sn(){return O.get("geo.continent")}function wn(){return O.get("geo.region")}function _n(e=[]){return!!(e&&e.indexOf&&e.indexOf(yn())>-1)}function En(e){const t="undefined"!=typeof window&&window||"undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==s.g&&s.g||void 0;let i;return void 0!==t&&(i=t[e]),i}var Tn=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),In="Singleton",An=function(){function e(){}return e.prototype.reset=function(e){},e}(),Cn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Tn(t,e),t.prototype.resolve=function(e,t){return e()},t}(An),On=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.instances=new Map,t}return Tn(t,e),t.prototype.resolve=function(e,t){var i=this.instances.get(t);return i||(i=e(),this.instances.set(t,i)),i},t.prototype.reset=function(e){this.instances.delete(e)},t}(An),Pn="wikia-ioc:paramtypes",kn="wikia-ioc:taggedtypes",Nn="wikia-ioc:autobind",Ln="wikia-ioc:scope";function Rn(e){return void 0===e&&(e={}),function(t){if(Reflect.hasOwnMetadata(Pn,t))throw new Error("Cannot apply @Injectable decorator multiple times.");var i=Reflect.getMetadata("design:paramtypes",t)||[];return Reflect.defineMetadata(Pn,i,t),"boolean"==typeof e.autobind&&Reflect.defineMetadata(Nn,e.autobind,t),"string"==typeof e.scope&&Reflect.defineMetadata(Ln,e.scope,t),t}}function Dn(e){return function(t,i,n){if(i||"number"!=typeof n)throw new Error("Cannot apply @Inject decorator to a property.");var s=Reflect.getMetadata(kn,t)||{};if(s[n.toString()])throw new Error("Cannot apply @Inject decorator multiple times on the same parameter.");return s[n.toString()]=e,Reflect.defineMetadata(kn,s,t),t}}function xn(e,t){return"value"in t?e.value(t.value):"to"in t?e.to(t.to):"provider"in t?e.provider(t.provider):e}function zn(e){var t=typeof e;return Vn(e)||"symbol"===t||"string"===t}function Vn(e){return"function"==typeof e}s(741);var Mn=function(){function e(e,t,i,n){var s,r;if(this.sourceType=e,this.container=t,this.scopes=i,this.paramTypes=[],!Vn(this.sourceType))return this.scope(n.defaultScope);this.scope(null!==(s=Reflect.getMetadata(Ln,this.sourceType))&&void 0!==s?s:n.defaultScope),(null!==(r=Reflect.getMetadata(Nn,this.sourceType))&&void 0!==r?r:n.defaultAutobind)&&this.to(this.sourceType)}return e.prototype.to=function(e){return function(e){if(!Vn(e))throw new TypeError("Invalid type requested to IoC container. Type must be Class.")}(e),this.targetType=e,this.paramTypes=this.getMetadataParamTypes(),this.sourceType===this.targetType?this.provideSourceType(e):this.provideTargetType(e),this},e.prototype.getMetadataParamTypes=function(){var e=Reflect.getMetadata(Pn,this.targetType)||[],t=Reflect.getMetadata(kn,this.targetType)||{};return e.map((function(e,i){return t[i]||e}))},e.prototype.provideSourceType=function(e){var t=this;this.provider((function(){var i=t.getParameters();return new(e.bind.apply(e,function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),s=0;for(t=0;t<i;t++)for(var r=arguments[t],o=0,a=r.length;o<a;o++,s++)n[s]=r[o];return n}([void 0],i)))}))},e.prototype.getParameters=function(){var e=this;return this.paramTypes.map((function(t){return e.container.get(t)}))},e.prototype.provideTargetType=function(e){var t=this;this.provider((function(){return t.container.get(e)}))},e.prototype.value=function(e){return this.provider((function(){return e}))},e.prototype.provider=function(e){return this._provider=e,this._scope.reset(this.sourceType),this},e.prototype.scope=function(e){return this._scope=this.scopes[e],this._scope.reset(this.sourceType),this},e.prototype.withParams=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.paramTypes=e,this},e.prototype.getInstance=function(){var e=this;if(!this._provider)throw new Error(this.sourceType.toString()+" is not bound to anything.");return this._scope.resolve((function(){return e._provider(e.container)}),this.sourceType)},e.prototype.getType=function(){return this.targetType},e}(),Un=function(){return Un=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var s in t=arguments[i])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},Un.apply(this,arguments)},jn=function(){function e(t){void 0===t&&(t={}),this.bindings=new Map,this.scopes={Singleton:new On,Transient:new Cn},this.containerOptions=Un({defaultScope:In,defaultAutobind:!0},t),this.bind(e).scope(In).value(this)}return e.prototype.bind=function(e){var t=zn(e)?e:null==e?void 0:e.bind;return this.bindings.has(t)?this.bindings.get(t):Vn(e)?xn(this.ensureBinding(t),{bind:e,to:e}):zn(e)?this.ensureBinding(t):xn(this.ensureBinding(t),e)},e.prototype.unbind=function(e){var t=zn(e)?e:null==e?void 0:e.bind;this.bindings.delete(t)},e.prototype.get=function(e){return this.ensureBinding(e).getInstance()},e.prototype.getType=function(e){return this.ensureBinding(e).getType()},e.prototype.ensureBinding=function(e){!function(e){if(!zn(e))throw new TypeError("Invalid type requested to IoC container. TypeKey must be Class, symbol or string.")}(e);var t=this.bindings.get(e);return t||(t=new Mn(e,this,this.scopes,this.containerOptions),this.bindings.set(e,t)),t},e}();const Bn=E.getDebugGroup()||"",$n=Bn.split(",");""!==Bn&&window.console.info("AdEngine debug mode - groups:","1"===Bn?"all":$n);const Fn=Date.now();function Hn(){var e,t;return null!==(t=null===(e=window.performance)||void 0===e?void 0:e.timeOrigin)&&void 0!==t?t:Fn}function Gn(){return Date.now()-Hn()}function qn(){return(Gn()/1e3).toFixed(4)}function Wn(e,...t){""!==Bn&&("1"!==Bn&&-1===$n.indexOf(e)||window.console.info(`${qn()}s\t\t [AE] ${e}`,t))}function Kn(e,...t){""!==Bn&&("1"!==Bn&&-1===$n.indexOf(e)||window.console.warn(`${qn()}s\t\t [AE] ${e}`,t))}let Yn=class{constructor(){this.timeouts={}}get(e){return Wn("global-timeout",`Getting timeout ${e}`),this.timeouts[e]}set(e,t){return this.timeouts[e]?(Wn("global-timeout",`Timeout ${e} already set`),this.timeouts[e]):(Wn("global-timeout",`Setting timeout ${e} for ${t}ms`),this.timeouts[e]=new Promise((e=>{setTimeout((()=>{e()}),t)})),this.timeouts[e])}};Yn=a([Rn({scope:"Singleton"})],Yn);const Qn={en:{advertisement:"Advertisement","learn-more":"Learn More"},ar:{advertisement:"إعلان"},bn:{advertisement:"বিজ্ঞাপন"},br:{advertisement:"Bomm bruderezh"},ca:{advertisement:"Anunci"},cs:{advertisement:"Reklama"},de:{advertisement:"Anzeige","learn-more":"Erfahre mehr"},es:{advertisement:"Anuncio","learn-more":"Conoce más"},eu:{advertisement:"Iragarkia"},fa:{advertisement:"تبلیغات"},fo:{advertisement:"Lýsing"},fr:{advertisement:"Publicité","learn-more":"En savoir plus"},fy:{advertisement:"Advertinsje"},gl:{advertisement:"Anuncio"},gv:{advertisement:"Soilsheen"},he:{advertisement:"פרסומת"},hu:{advertisement:"Hirdetés"},id:{advertisement:"Iklan","learn-more":"Baca Selengkapnya"},inh:{advertisement:"дебат"},it:{advertisement:"Pubblicità","learn-more":"Ulteriori informazioni"},ja:{advertisement:"広告","learn-more":"もっと見る"},ko:{advertisement:"광고"},krc:{advertisement:"Pеклама"},lb:{advertisement:"Reklamm"},mk:{advertisement:"Pеклама"},mr:{advertisement:"जाहिरात"},ms:{advertisement:"Iklan"},nl:{advertisement:"Advertentie","learn-more":"Meer te weten komen"},no:{advertisement:"Reklame"},pl:{advertisement:"Reklama","learn-more":"Czytaj więcej"},ps:{advertisement:"خبرتيا"},pt:{advertisement:"Anúncio","learn-more":"Saiba Mais"},"roa-tara":{advertisement:"Pubblecetà"},ru:{advertisement:"Pеклама","learn-more":"Узнать больше"},si:{advertisement:"ප්‍රචාරක දැන්වීම"},sl:{advertisement:"Oglas"},"sr-ec":{advertisement:"Pеклама"},sv:{advertisement:"Annons"},te:{advertisement:"వాణిజ్య ప్రకటన"},th:{advertisement:"การโฆษณา"},tr:{advertisement:"Reklam"},"tt-cyrl":{advertisement:"Pеклама"},uk:{advertisement:"Pеклама"},vi:{advertisement:"Quảng cáo"},"zh-hans":{advertisement:"广告","learn-more":"了解更多"},"zh-hant":{advertisement:"廣告","learn-more":"閱讀更多"}},Jn="en";function Xn(e){const t=O.get("wiki.targeting.wikiLanguage"),i=t&&void 0!==Qn[t]?t:Jn;return Qn[i][e]||Qn[Jn][e]}class Zn{create(e,t){const i=this.createEmptyIframe();return e.appendChild(i),t&&(i.contentWindow.document.open(),i.contentWindow.document.write(t),i.contentWindow.document.close()),i}createEmptyIframe(){const e=document.createElement("iframe");return e.height="0",e.width="0",e.border="0px",e.hspace="0",e.vspace="0",e.marginWidth="0",e.marginHeight="0",e.style.border="0",e.scrolling="no",e.frameBorder="0",e.src="about:blank",e.style.display="inline",e.style.overflow="hidden",e}}var es;!function(e){e.site="site",e.page="page",e.tracking="tracking",e.targeting="targeting",e.partners="partners"}(es||(es={}));const ts=new class{constructor(){this.logGroup="GlobalContextService",window.fandomContext||this.createEmptyContext()}createEmptyContext(){Wn(this.logGroup,"Creating empty fandomContext"),window.fandomContext={site:{},page:{},tracking:{},partners:{},targeting:{}}}isObject(e){return"object"==typeof e&&!Array.isArray(e)}merge(e,t){const i=i=>this.isObject(t[i])&&Object.prototype.hasOwnProperty.call(e,i)&&this.isObject(e[i]),n=Object.getOwnPropertyNames(t).map((n=>({[n]:i(n)?this.merge(e[n],t[n]):t[n]}))).reduce(((e,t)=>Object.assign(Object.assign({},e),t)),{});return Object.assign(Object.assign({},e),n)}setValue(e,t){window.fandomContext||this.createEmptyContext(),window.fandomContext[e]||(window.fandomContext[e]={}),window.fandomContext[e]=this.merge(window.fandomContext[e],t)}getValue(e,t){if(!window.fandomContext)return;const i=window.fandomContext[e];if(i)return i[t];Wn(this.logGroup,`Attempting to retrieve invalid category "${e}" in context!`)}hasBundle(e){var t,i,n,s;return null===(s=null===(n=null===(i=null===(t=window.fandomContext)||void 0===t?void 0:t.site)||void 0===i?void 0:i.tags)||void 0===n?void 0:n.bundles)||void 0===s?void 0:s.includes(e)}};function is(){return ts.getValue(es.partners,"directedAtChildren")}function ns(e,t){if("function"!=typeof t)throw new Error("LazyQueue used with callback not being a function");if(!(e instanceof Array))throw new Error("LazyQueue requires an array as the first parameter");e.start=()=>{for(;e.length>0;)t(e.shift());e.push=e=>{t(e)}}}class ss{get length(){return this.items.length}constructor(...e){this.itemFlushCallbacks=[],this.items=[],this.items=[...e],this.setPreFlushPush()}flush(){for(;this.items.length>0;)this.emit(this.items.shift());this.setPostFlushPush()}push(...e){this.pushCommand(...e)}onItemFlush(e){if("function"!=typeof e)throw new Error("onItemFlush used with callback not being a function");this.itemFlushCallbacks.push(e)}setPreFlushPush(){this.pushCommand=(...e)=>{this.items.push(...e)}}setPostFlushPush(){this.pushCommand=(...e)=>{e.forEach((e=>{this.emit(e)}))}}emit(e){this.itemFlushCallbacks.forEach((t=>{t(e)}))}}const rs=new class{constructor(){this.MAX=100,this.ALWAYS_ALLOWED_THRESHOLD=100}isOutboundTrafficAllowed(e="default"){const t=O.get(`services.${e}.allowed`);if("boolean"==typeof t)return t;const i=O.get(`services.${e}.threshold`),n=i>=0&&i<=100?i:this.ALWAYS_ALLOWED_THRESHOLD;let s=!0;return n!==this.ALWAYS_ALLOWED_THRESHOLD&&(s=this.getSeed()<n),n<1&&(s=!1),Wn("outbound-traffic-restrict",`Outbound traffic for: "${e}" is allowed: ${s}`,`Threshold: ${n}`),O.set(`services.${e}.allowed`,s),s}getSeed(){return Math.random()*this.MAX}};function os(e){let t;const i=new Promise((i=>{t=setTimeout((()=>i(e)),e)}));return{cancel(){clearTimeout(t)},promise:i}}const as=new class{sample(e,t,i=100){return!!function(e){return-1!==(y.get("ignored_samplers")||"").split(",").indexOf(e)}(e)||function(e,t){return Math.floor(Math.random()*(t-0))+0}(0,i)<t}};class ds{createScript(e,t=!0,i=null,n={},s={}){const r=document.createElement("script");if(r.async=t,r.defer=!t,r.src=e,Object.keys(n).forEach((e=>{r.setAttribute(e,n[e])})),Object.keys(s).forEach((e=>{r.dataset[e]=s[e]})),"string"==typeof i){const e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(r,e)}else(i||document.body).appendChild(r);return r}loadScript(e,t=!0,i=null,n={},s={}){return new Promise(((r,o)=>{const a=this.createScript(e,t,i,n,s);a.onload=r,a.onerror=o}))}loadAsset(e,t="json"){const i=new XMLHttpRequest;return i.open("GET",e,!0),i.responseType=t,new Promise((e=>{i.addEventListener("timeout",(()=>{e(null)})),i.addEventListener("error",(()=>{e(null)})),i.onreadystatechange=function(){this.readyState===this.DONE&&(200===this.status?e(this.response):e(null))},i.send()}))}loadSync(e){try{const t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),200===t.status&&0!==t.responseText.length&&t.responseText}catch(e){return!1}}}const ls=new ds;function cs(){return["fandom.com","tvguide.com","metacritic.com","gamespot.com","giantbomb.com","muthead.com","fandom-ae-assets.s3.amazonaws.com","fanatical.com"].find((e=>window.location.hostname.includes(e)))?"https://services.fandom.com/":"https://services.fandom-dev."+(location.hostname.match(/(?!\.)(pl|us)$/)||["us"])[0]+"/"}const us=new class{constructor(){this.adTargeting={},this.onChangeCallbacks=[],this.pageTargetingGroupName="PAGE_TARGETING",this.sentryEnabled=!1,this.sentryKey="fs",this.sentryValue="t",E.isDebugMode()&&(window.ads.adTargeting=this.adTargeting)}clear(e=null){const t=e||this.pageTargetingGroupName;this.adTargeting[t]={}}extend(e,t=null){const i=t||this.pageTargetingGroupName;this.adTargeting[i]=this.adTargeting[i]||{},this.adTargeting[i]=Object.assign(this.adTargeting[i],e),this.ensureSentryIsLast(i)}dump(e=null){const t=e||this.pageTargetingGroupName;return this.adTargeting[t]=this.adTargeting[t]||{},this.ensureSentryIsLast(t),this.adTargeting[t]}get(e,t=null){const i=t||this.pageTargetingGroupName;if(this.adTargeting[i])return this.ensureSentryIsLast(i),this.adTargeting[i][e]}set(e,t,i=null){if(void 0!==t){const n=i||this.pageTargetingGroupName;this.adTargeting[n]=this.adTargeting[n]||{},this.adTargeting[n][e]=t,n===this.pageTargetingGroupName&&this.triggerOnChange(e,t),this.ensureSentryIsLast(n)}}remove(e,t=null){const i=t||this.pageTargetingGroupName;this.adTargeting[i]&&this.adTargeting[i][e]&&(delete this.adTargeting[i][e],i===this.pageTargetingGroupName&&this.triggerOnChange(e,null),this.ensureSentryIsLast(i))}onChange(e){this.onChangeCallbacks=this.onChangeCallbacks||[],this.onChangeCallbacks.push(e)}removeListeners(){this.onChangeCallbacks=[]}triggerOnChange(e,t){this.onChangeCallbacks.forEach((i=>{i(e,t)}))}addSentryFlag(e){this.sentryEnabled=e}ensureSentryIsLast(e){if(this.sentryEnabled&&this.adTargeting[e]&&Object.keys(this.adTargeting[e]||{}).length>0){const t=this.adTargeting[e],i=this.sentryKey,n=(t[i],function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i}(t,["symbol"==typeof i?i:i+""]));this.adTargeting[e]=Object.assign(Object.assign({},n),{[this.sentryKey]:this.sentryValue})}}},ps=new class{build(e,t={}){const i=e.match(/{(.+?)}/g);let n=e;return i&&i.forEach((e=>{const i=e.replace("{","").replace("}",""),s=O.get(i),r=i.split(".");let o,a,d=t[r[0]];if(d)for(o=1;o<r.length;o+=1){if(a=r[o],void 0===d[a]){d=void 0;break}d=d[a]}void 0===d&&i.startsWith("targeting.")&&(d=us.get(i.replace("targeting.",""))),void 0===d&&(d=s),void 0!==d&&(n=n.replace(e,d))})),n}};class hs{constructor(e){this.container=e}static containsValue(e,t){const i=t.toUpperCase();return e.some((e=>e.toUpperCase()===i))}getHostnamePrefix(){const e=this.container.location.hostname.toLowerCase(),t=/(^|.)(showcase|externaltest|preview|verify|stable|sandbox-[^.]+)\./.exec(e);if(t&&t.length>2)return t[2];const i=e.split(".");return i.length?i[0]:void 0}getRawDbName(e){return`_${e||"wikia"}`.replace("/[^0-9A-Z_a-z]/","_")}getTargetingBundles(e){const t=us.get("bundles")||[];try{const i=[];Object.keys(e).forEach((t=>{this.matchesTargetingBundle(e[t])&&i.push(t)})),i.forEach((e=>{hs.containsValue(t,e)||t.push(e)}))}catch(e){Wn("targeting-bundles","Invalid input data!")}return this.applyCodeLevelBundles(t)}applyCodeLevelBundles(e){(new b).getItem("_ae_intrsttl_imp")&&e.push("interstitial_disabled");const t=us.get("skin");t&&t.includes("ucp_")&&!hs.containsValue(e,"VIDEO_TIER_1_AND_2_BUNDLE")&&e.push("VIDEO_TIER_3_BUNDLE");const i=us.get("word_count")||-1;return i>-1&&i<=100&&(e.push("short_page"),O.set("custom.short_page",!0)),e}matchesTargetingBundle(e){return!Object.keys(e).some((t=>{const i=us.get(t);if(!i)return!0;if(Array.isArray(i)){if(!e[t].some((e=>i.includes(e))))return!0}else if(!e[t].includes(i))return!0;return!1}))}}const gs=new hs(window),ms=new class extends ds{loadScriptWithStatus(e,t){const i=Object.create(null,{loadScript:{get:()=>super.loadScript}});return c(this,arguments,void 0,(function*(e,t,n=!0,s=null,r={},o={}){Wn(t,"loading"),_i.emit(Ei.PARTNER_LOAD_STATUS,{status:t+"_started"});const a=yield i.loadScript.call(this,e,n,s,r,o);return _i.emit(Ei.PARTNER_LOAD_STATUS,{status:t+"_loaded"}),Wn(t,"ready"),a}))}};function fs(e={},t=[]){if(e)return t.find((t=>{if("string"!=typeof t)throw new Error("property name must be a string");return t in e}))}function vs(e,t=[]){const i=fs(e,t);if(i){const t=e[i];return"function"==typeof t?t.bind(e):t}}var bs;!function(e){e.CUSTOM_EVENT="customEvent",e.SLOT_ADDED_EVENT="slotAdded",e.SLOT_REQUESTED_EVENT="slotRequested",e.SLOT_RESPONSE_RECEIVED="slotResponseReceived",e.SLOT_LOADED_EVENT="slotLoaded",e.SLOT_VIEWED_EVENT="slotViewed",e.SLOT_RENDERED_EVENT="slotRendered",e.SLOT_VISIBILITY_CHANGED="slotVisibilityChanged",e.SLOT_BACK_TO_VIEWPORT="slotBackToViewport",e.SLOT_LEFT_VIEWPORT="slotLeftViewport",e.SLOT_STATUS_CHANGED="slotStatusChanged",e.DESTROYED_EVENT="slotDestroyed",e.DESTROY_EVENT="slotDestroy",e.HIDDEN_EVENT="slotHidden",e.SHOWED_EVENT="slotShowed",e.VIDEO_VIEWED_EVENT="videoViewed",e.VIDEO_AD_REQUESTED="videoAdRequested",e.VIDEO_AD_ERROR="videoAdError",e.VIDEO_AD_IMPRESSION="videoAdImpression",e.VIDEO_AD_USED="videoAdUsed",e.TEMPLATES_LOADED="Templates Loaded"}(bs||(bs={}));const ys={category:"[Ad Engine]",name:"BAB detection finished",payload:{_as:"props",_p:void 0}},Ss={category:"[AdEngine OptIn]",name:"set opt in",payload:{_as:"props",_p:void 0}},ws={category:"[AdEngine OptIn]",name:"update opt in",payload:{_as:"props",_p:void 0}},_s={name:"GPT Ready"},Es={name:"Ad engine load time init"},Ts={name:"MessageBox event",payload:{_as:"props",_p:void 0}},Is={name:"Partners Ready"},As={name:"Ad Stack started"},Cs={name:"Ad Stack completed"},Os={name:"Template loaded",payload:{_as:"props",_p:void 0}},Ps={category:"[Platform]",name:"Before page change"},ks=new class{constructor(){this.serviceName="scroll-listener",this.callbacks={}}init(){let e=!1;document.addEventListener("scroll",(t=>{e||(window.requestAnimationFrame((()=>{e=!1,Object.keys(this.callbacks).forEach((e=>{"function"==typeof this.callbacks[e]&&this.callbacks[e](t.type,e)}))})),e=!0)})),Wn(this.serviceName,"Service initialised.")}addSlot(e,{threshold:t,distanceFromTop:i}={}){const n=document.getElementById(e);n?void 0!==t||void 0!==i?void 0===t||void 0===i?(Wn(this.serviceName,`Add slot ${e}.`),this.addCallback(((e,s)=>{const r=window.scrollY||window.pageYOffset||document.documentElement.scrollTop;if(void 0!==t){const e=tn(n);r+sn()>e-t&&(this.removeCallback(s),Qr.pushSlot(n))}else r>i&&(this.removeCallback(s),Qr.pushSlot(n))}))):Wn(this.serviceName,"either threshold or distanceFromTop can be initialised, not both"):Wn(this.serviceName,"either threshold or distanceFromTop must be initialised"):Wn(this.serviceName,`Node with id ${e} not found.`)}addCallback(e){const t=this.getUniqueId();return this.callbacks[t]=e,t}removeCallback(e){delete this.callbacks[e]}getUniqueId(){return(16777216*(1+Math.random())).toString(16).substring(1)}},Ns="message-bus",Ls=new class{constructor(e=window){this.source=e,this.isInitialized=!1,this.callbacks=[]}init(){this.isInitialized||(Wn(Ns,"Register message listener"),this.source.addEventListener("message",(e=>this.onMessage(e)),!1),this.isInitialized=!0)}register(e,t){this.init(),this.callbacks.push({match:e,fn:t})}onMessage(e){let t,i=0;if(this.isAdEngineMessage(e))for(Wn(Ns,"Message received",e),i=0;i<this.callbacks.length;i+=1)if(t=this.callbacks[i],this.messageMatch(t.match,e))return Wn(Ns,"Matching message",e,t),t.fn(this.getDataFromMessage(e).AdEngine),void(t.match.infinite||this.callbacks.splice(i,1))}isAdEngineMessage(e){const t=this.getDataFromMessage(e);return!!t&&!!t.AdEngine}messageMatch(e,t){let i=!0;if(e.origin&&!e.origin.includes(t.origin))return!1;if(e.keys){const n=this.getDataFromMessage(t).AdEngine;e.keys.forEach((e=>{i=i&&n[e]}))}return i}getDataFromMessage(e){if("string"==typeof e.data)try{return JSON.parse(e.data)}catch(e){return}return e.data}},Rs="slot-tweaker";class Ds{forceRepaint(e){return e.offsetWidth}addDefaultClasses(e){const t=e.getElement(),i=e.getConfigProperty("defaultClasses")||[];t&&i.length&&i.forEach((e=>t.classList.add(e)))}collapse(e){const t=e.getElement();t.style.maxHeight=`${t.scrollHeight}px`,this.forceRepaint(t),t.classList.add("slot-animation"),t.style.maxHeight="0"}expand(e){const t=e.getElement();t.style.maxHeight=`${t.offsetHeight}px`,t.classList.remove(Ji.HIDDEN_AD_CLASS),t.classList.add("slot-animation"),t.style.maxHeight=`${t.scrollHeight}px`}makeResponsive(e){return c(this,arguments,void 0,(function*(e,t=null,i=!0){e.addClass("slot-responsive"),Wn(Rs,"make responsive",e.getSlotName());const n=yield this.onReady(e);return this.setPaddingBottom(n,t,i),n}))}setPaddingBottom(e,t,i=!0){let n,s=t;if(dn(e)){if(!t){const t=e.contentWindow.document.body.scrollHeight;s=e.contentWindow.document.body.scrollWidth/t}n=e.parentElement}else n=e;i&&(n.style.paddingBottom=100/s+"%")}onReady(e){function t(){const t=e.getIframe();if(!t)throw new Error("Cannot find iframe element");return t}return e.getConfigProperty("useGptOnloadEvent")?e.loaded.then(t):new Promise((i=>{const n=t();let s=null;try{s=n.contentWindow.document}catch(t){Wn(Rs,e.getSlotName(),"loaded through SafeFrame")}s&&"complete"===s.readyState?i(n):n.addEventListener("load",(()=>i(n)))}))}adjustIframeByContentSize(e){return c(this,void 0,void 0,(function*(){const t=yield this.onReady(e);if(dn(t)){const i=t.contentWindow.document.body.scrollHeight,n=t.contentWindow.document.body.scrollWidth;t.width=n.toString(),t.height=i.toString(),Wn(Rs,"adjust size",e.getSlotName(),n,i)}return t}))}registerMessageListener(e){Ls.register({keys:["action","slotName"],infinite:!0},(t=>{if(!t.slotName)return void Wn(Rs,"Missing slot name");const i=e(t.slotName);switch(t.action){case"expand":this.expand(i);break;case"collapse":this.collapse(i);break;case Ji.HIDDEN_AD_CLASS:i.hide();break;case"show":i.show();break;case"make-responsive":this.makeResponsive(i,t.aspectRatio);break;default:Wn(Rs,"Unknown action",t.action)}}))}setDataParam(e,t,i){const n=e.getElement();n&&(n.dataset[t]="string"==typeof i?i:JSON.stringify(i))}}Ds.SLOT_CLOSE_IMMEDIATELY="force-close";const xs=new Ds;var zs;!function(e){e.STATUS_BLOCKED="blocked",e.STATUS_COLLAPSE="collapse",e.STATUS_NO_AD="no-ad",e.STATUS_DISABLED="disabled",e.STATUS_FORCED_COLLAPSE="forced_collapse",e.STATUS_FORCED_SUCCESS="forced_success",e.STATUS_SKIP_TEMPLATE="skip_template",e.STATUS_MANUAL="manual",e.STATUS_REQUESTED="requested",e.STATUS_ERROR="error",e.STATUS_SUCCESS="success",e.STATUS_CLICKED="clicked",e.STATUS_VIEWPORT_CONFLICT="viewport-conflict",e.STATUS_HIVI_COLLAPSE="hivi-collapse",e.STATUS_HEAVY_AD_INTERVENTION="heavy-ad-intervention",e.STATUS_UNKNOWN_INTERVENTION="unknown-intervention"}(zs||(zs={}));const Vs={category:"[GAM iframe]",name:"Ad intervention",payload:{_as:"props",_p:void 0}},Ms={category:"[GAM iframe]",name:"Delayed collapse",payload:{_as:"props",_p:void 0}},Us={category:"[GAM iframe]",name:"Load template",payload:{_as:"payload",_p:void 0}},js={isGdprConsentRequired:function(){return!!O.get("options.geoRequiresConsent")},isOptedIn:function(e){return!!(null!=e?e:O.get("options.trackingOptIn"))},isOptOutSale:function(e){return!!O.get("options.isSubjectToCcpa")||!!(null!=e?e:O.get("options.optOutSale"))}},Bs={name:"UAP DOM changed",payload:{_as:"props",_p:void 0}},$s={name:"UAP Load status",payload:{_as:"props",_p:void 0}},Fs={name:"UAP NTC loaded"},Hs="btf-blocker",Gs=new class{constructor(){this.firstCallEnded=!1,this.unblockedSlotNames=[],this.resetState()}resetState(){this.firstCallEnded=!1,this.unblockedSlotNames=[],this.slotsQueue=new ss,this.slotsQueue.onItemFlush((({adSlot:e,fillInCallback:t})=>{Wn(Hs,e.getSlotName(),"Filling delayed second call slot"),this.disableAdSlotIfHasConflict(e),this.fillInSlotIfEnabled(e,t)})),window.ads&&window.ads.runtime&&(window.ads.runtime.disableBtf=!1,window.ads.runtime.disableSecondCall=!1)}init(){_i.onSlotEvent(bs.SLOT_RENDERED_EVENT,(({slot:e})=>{Wn(Hs,e.getSlotName(),"Slot rendered"),!this.firstCallEnded&&e.isFirstCall()&&this.finishFirstCall()})),0===Qr.getFirstCallSlotNames().filter((e=>Qr.getEnabledSlotNames().includes(e))).length&&this.finishFirstCall()}finishFirstCall(){this.firstCallEnded=!0,Wn(Hs,"first call queue finished"),window.ads.runtime.disableSecondCall?this.disableSecondCall([]):window.ads.runtime.disableBtf&&this.disableSecondCall([...this.unblockedSlotNames]),_i.on($s,(()=>{this.slotsQueue.flush()}))}disableSecondCall(e){const t=O.get("slots")||{};Wn(Hs,"second call queue disabled"),Object.keys(t).forEach((i=>{t[i].firstCall||-1!==e.indexOf(i)||Qr.disable(i,zs.STATUS_BLOCKED)}))}push(e,t){if(!this.firstCallEnded&&!e.isFirstCall())return this.slotsQueue.push({adSlot:e,fillInCallback:t}),void Wn(Hs,e.getSlotName(),"second call slot pushed to queue");this.disableAdSlotIfHasConflict(e),this.fillInSlotIfEnabled(e,t)}disableAdSlotIfHasConflict(e){Qr.hasViewportConflict(e)&&Qr.disable(e.getSlotName(),zs.STATUS_VIEWPORT_CONFLICT)}fillInSlotIfEnabled(e,t){e.isEnabled()?(Wn(Hs,e.getSlotName(),"Filling in slot"),t(e)):Wn(Hs,e.getSlotName(),"Slot blocked",e.getStatus())}unblock(e){Wn(Hs,e,"Unblocking slot"),this.unblockedSlotNames.push(e),Qr.enable(e)}},qs=new class{updateOnCreate(e){xs.setDataParam(e,"gptPageParams",us.dump()),xs.setDataParam(e,"gptSlotParams",e.getTargeting())}updateOnRenderEnd(e){!function(e){const t="top_leaderboard"==e.getSlotName(),i=void 0!==window.smTracking&&"function"==typeof window.smTracking.recordRenderedAd;t&&i&&window.smTracking.recordRenderedAd(e),delete window.smTracking}(e),xs.setDataParam(e,"gptAdvertiserId",e.advertiserId),xs.setDataParam(e,"gptOrderId",e.orderId),xs.setDataParam(e,"gptCreativeId",e.creativeId),xs.setDataParam(e,"gptLineItemId",e.lineItemId),xs.setDataParam(e,"gptCreativeSize",e.creativeSize)}},Ws="gpt-size-map";class Ks{constructor(e=[]){this.sizeMap=e,Wn(Ws,this.sizeMap,"creating new size map")}addSize(e,t){Wn(Ws,e,t,"adding new size mapping"),this.sizeMap.push({viewportSize:e,sizes:t})}build(){Wn(Ws,this.sizeMap,"creating GPT size mapping builder");const e=window.googletag&&window.googletag.sizeMapping();return e?(this.sizeMap.forEach((({viewportSize:t,sizes:i})=>{e.addSize(t,i)})),e.build()):(Wn(Ws,"cannot create GPT size mapping builder"),null)}isEmpty(){return!this.sizeMap.length}mapAllSizes(e){return new Ks(this.sizeMap.map((({viewportSize:t,sizes:i},n)=>{const s=e(i,t,n);return Wn(Ws,t,i,s,"mapping viewport sizes"),{viewportSize:t,sizes:s}})))}toString(){Wn(Ws,this.sizeMap,"casting to string");const e={};return this.sizeMap.forEach((({viewportSize:t,sizes:i})=>{e[t.join("x")]=i})),JSON.stringify(e)}}function Ys(e,t){const i=window.googletag.pubads();null==t?i.clearTargeting(e):"function"==typeof t?i.setTargeting(e,t()):i.setTargeting(e,t)}var Qs,Js;const Xs="gpt-provider",Zs="AdX",er=["https://tpc.googlesyndication.com","https://googleads.g.doubleclick.net"],tr=y.get("no-fill-ad-slot"),ir=parseInt(y.get("no-fill-start-rv-val"),10),nr=null!==(Qs=parseInt(y.get("no-fill-end-rv-val"),10))&&void 0!==Qs?Qs:99,sr=[0,0];function rr(e){return function(...t){setTimeout((()=>(window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[],window.googletag.cmd.push((()=>e.apply(this,t))))))}}let or=[],ar=!1;function dr(e){const t=e.slot.getSlotElementId();return Qr.get(t)}class lr{constructor(){window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[],this.init()}isInitialized(){return ar}init(){this.isInitialized()||(function(){const e=us.dump()||{};Object.keys(e).forEach((t=>{Ys(t,e[t])}))}(),us.onChange(((e,t)=>{null===e?Object.keys(t).forEach((e=>{Ys(e,t[e])})):Ys(e,t)})),function(){const e=window.googletag.pubads();e.disableInitialLoad(),e.addEventListener("slotRequested",(e=>{const t=dr(e);t&&(t.setStatus(zs.STATUS_REQUESTED),t.emit(bs.SLOT_REQUESTED_EVENT))})),e.addEventListener("slotResponseReceived",(e=>{dr(e).emit(bs.SLOT_RESPONSE_RECEIVED)})),e.addEventListener("slotOnload",(e=>{const t=dr(e);null==t||t.emit(bs.SLOT_LOADED_EVENT)})),e.addEventListener("slotRenderEnded",(e=>{hn((()=>{const t=dr(e);if(!t)return;const i=function(e,t){let i=!1;const n=dr(e);if(e.isEmpty)return O.get("experiments.refreshCollapseExperiment")&&n&&!n.isRefreshAttemptLimitReached()?(Wn(Xs,"Refresh experiment active. Returning no-ad event on isEmpty slot."),zs.STATUS_NO_AD):zs.STATUS_COLLAPSE;try{i=!!t.contentWindow.document.querySelector}catch(e){Wn(Xs,"getAdType","iframe is not accessible")}return i&&t.contentWindow.AdEngine_adType?t.contentWindow.AdEngine_adType:zs.STATUS_SUCCESS}(e,t.getIframe());return function(e){const t=O.get("templates.sizeOverwritingMap"),i=e.getIframe();if(!t||!i)return;const n=`${i.width}x${i.height}`;t[n]&&(i.width=t[n].originalSize[0].toString(),i.height=t[n].originalSize[1].toString())}(t),t.emit(bs.SLOT_RENDERED_EVENT,{event:e,adType:i},!1)}))})),e.addEventListener("impressionViewable",(e=>{const t=dr(e);null==t||t.emit(bs.SLOT_VIEWED_EVENT)})),e.addEventListener("slotVisibilityChanged",(function(e){const t=dr(e);if(t)return null==t||t.emit(bs.SLOT_VISIBILITY_CHANGED,e),e.inViewPercentage>50?t.emit(bs.SLOT_BACK_TO_VIEWPORT,e):e.inViewPercentage<50?t.emit(bs.SLOT_LEFT_VIEWPORT,e):void 0})),window.googletag.enableServices()}(),this.setupRestrictDataProcessing(),this.setPPID(),_i.on(Ps,(()=>this.updateCorrelator()),!1),_i.onSlotEvent(bs.DESTROY_EVENT,(({slot:e})=>{this.destroySlot(e.getSlotName()),e.emit(bs.DESTROYED_EVENT)})),ar=!0)}setupRestrictDataProcessing(){const e=window.googletag.pubads(),t={restrictDataProcessing:js.isOptOutSale()};is()&&(t.childDirectedTreatment=!0),e.setPrivacySettings(t)}setPPID(){const e=us.get("ppid");e&&window.googletag.pubads().setPublisherProvidedId(e)}fillIn(e){const t=Wr()||[];Gs.push(e,((...e)=>{this.fillInCallback(...e)})),0===t.length&&this.flush()}fillInCallback(e){const t=e.getSlotName(),i=e.getTargeting();t===tr&&1===ir&&1===Number(i.rv)&&(Wn(Xs,"fillInCallback","Forcing no ad fill for slot ",t," on rv === ",i.rv),us.set("src","externaltest",t),i.src="externaltest");const n=new Ks(e.getSizes()),s=this.createGptSlot(e,n);s&&(O.get("experiments.refreshCollapseExperiment")?(Wn(Xs,"Setting setCollapseEmptyDiv(false)"),s.addService(window.googletag.pubads()).setCollapseEmptyDiv(!1)):(Wn(Xs,"Setting setCollapseEmptyDiv(true)"),s.addService(window.googletag.pubads()).setCollapseEmptyDiv(!0)),this.applyTargetingParams(s,i),qs.updateOnCreate(e),e.updateWinningPbBidderDetails(),window.googletag.display(t),or.push(s),e.isFirstCall()||this.flush(),Wn(Xs,t,"slot added"))}createGptSlot(e,t){var i;return e.isOutOfPage()?e.getConfigProperty("outOfPageFormat")?window.googletag.defineOutOfPageSlot(e.getAdUnit(),window.googletag.enums.OutOfPageFormat[e.getConfigProperty("outOfPageFormat")]):window.googletag.defineOutOfPageSlot(e.getAdUnit(),e.getSlotName()):null===(i=window.googletag.defineSlot(e.getAdUnit(),e.getDefaultSizes(),e.getSlotName()))||void 0===i?void 0:i.defineSizeMapping(t.build())}applyTargetingParams(e,t){!function(e){const t=e.pos.constructor==Array&&"top_leaderboard"==e.pos[0]||"top_leaderboard"==e.pos,i=void 0!==window.smTracking&&window.smTracking.recordRequestTargeting;t&&i&&window.smTracking.recordRequestTargeting(e)}(t),Object.keys(t).forEach((i=>{let n=t[i];n=Array.isArray(n)?n.map((e=>e.toString())):n.toString(),e.setTargeting(i,n)}))}updateCorrelator(){window.googletag.pubads().updateCorrelator()}flush(){or.length&&(window.googletag.pubads().refresh(or,{changeCorrelator:!1}),or=[])}destroySlot(e){const t=window.googletag.pubads().getSlots().find((t=>e===t.getSlotElementId()));return t?(this.destroyGptSlot(t),!0):(Wn(Xs,"destroySlot","slot doesn't return element id",e),!1)}destroyGptSlot(e){Wn(Xs,"destroySlot",e),window.googletag.destroySlots([e])||Wn(Xs,"destroySlot",e,"failed")}static refreshSlot(e){const t=window.googletag.pubads().getSlots().find((t=>t.getSlotElementId()===e.getSlotName())),{targeting:i}=e;t.clearTargeting();const n=window.googletag.sizeMapping();e.getDefaultSizes().forEach((t=>{t[1]<=e.getElement().clientHeight&&n.addSize(sr,t)})),t.defineSizeMapping(n.build()),function(e,t,i){const n=i.rv?String(Number(i.rv)+1):"1",s=t.getSlotName();if(s===tr){Wn(Xs,"No ad fill triggered for ad slot: ",s);const e=parseInt(n);e>=ir&&e<=nr?(Wn(Xs,"updateGptSlotTargeting","Forcing no ad fill for slot ",s),us.set("src","externaltest",s),i.src="externaltest"):(Wn(Xs,"updateGptSlotTargeting","Resetting src for slot ",s),us.set("src",O.get("src"),s),i.src=O.get("src"))}e.updateTargetingFromMap(i),e.setTargeting("rv",n),us.set("rv",n,t.getSlotName())}(t,e,i),window.googletag.pubads().refresh([t])}static setConfig(e){window.googletag.setConfig(e)}}function cr(e,t,i){var n=Ze(e)||t||i?{next:e,error:t,complete:i}:e;return n?Ot((function(e,t){var i;null===(i=n.subscribe)||void 0===i||i.call(n);var s=!0;e.subscribe(Pt(t,(function(e){var i;null===(i=n.next)||void 0===i||i.call(n,e),t.next(e)}),(function(){var e;s=!1,null===(e=n.complete)||void 0===e||e.call(n),t.complete()}),(function(e){var i;s=!1,null===(i=n.error)||void 0===i||i.call(n,e),t.error(e)}),(function(){var e,t;s&&(null===(e=n.unsubscribe)||void 0===e||e.call(n)),null===(t=n.finalize)||void 0===t||t.call(n)})))})):Tt}a([Qi(rr),l("design:type",Function),l("design:paramtypes",[]),l("design:returntype",void 0)],lr.prototype,"init",null),a([Qi(rr),l("design:type",Function),l("design:paramtypes",[Object]),l("design:returntype",void 0)],lr.prototype,"fillIn",null),a([Qi(rr),l("design:type",Function),l("design:paramtypes",[]),l("design:returntype",void 0)],lr.prototype,"updateCorrelator",null),a([Qi(rr),l("design:type",Function),l("design:paramtypes",["function"==typeof(Js="undefined"!=typeof googletag&&googletag.Slot)?Js:Object]),l("design:returntype",void 0)],lr.prototype,"destroyGptSlot",null),a([Qi(rr),l("design:type",Function),l("design:paramtypes",[Object]),l("design:returntype",void 0)],lr,"setConfig",null);const ur=new class{constructor(){this.templates={}}setInitializer(e){this.initializer=e}register(e,t=null){if("function"!=typeof e.getName)throw new Error("Template does not implement getName method.");const i=e.getName();let n=O.get(`templates.${i}`)||{};"function"==typeof e.getDefaultConfig&&(n=Object.assign(Object.assign({},e.getDefaultConfig()),n)),t&&(n=Object.assign(Object.assign({},n),t)),O.set(`templates.${i}`,n),this.templates[i]=e}init(e,t=null,i={}){var n;if(null===(n=this.initializer)||void 0===n?void 0:n.has(e))return this.initializer.init(e,t,i);if(Wn("template-service","Load template",e,t,i),!this.templates[e])throw new Error(`Template ${e} does not exist.`);return i&&("string"==typeof i.slotName||i.slotName instanceof String)&&(i.slotName=i.slotName.split(",").shift()),new this.templates[e](t).init(i)}subscribeCommunicator(){_i.action$.pipe(Si(_i.getGlobalAction(Us)),cr((({payload:e})=>{const t=Qr.get(e.slotName);this.init(e.type,t,e)}))).subscribe()}},pr={name:"A9 without consents"},hr={name:"A9 Apstag HEM sent"},gr={category:"[Prebid]",name:"Bidding done",payload:{_as:"props",_p:void 0}},mr={category:"[Prebid]",name:"Bids called"},fr={category:"[Prebid]",name:"Bids refresh",payload:{_as:"props",_p:void 0}},vr={category:"[Prebid]",name:"Bids response",payload:{_as:"props",_p:void 0}},br={category:"[Prebid]",name:"Auction done"},yr={category:"[Prebid]",name:"Call per group",payload:{_as:"props",_p:void 0}},Sr={category:"[Bidders]",name:"Filter adSlot sizes taller than rendered adSlot",payload:{_as:"props",_p:void 0}},wr={category:"[Prebid]",name:"DSA available",payload:{_as:"props",_p:void 0}},_r={category:"DSA",name:"Modal opened",payload:{_as:"props",_p:void 0}},Er={category:"DSA",name:"Modal closed",payload:{_as:"props",_p:void 0}};class Tr{constructor(e={}){this.props=e}render(){return document.createDocumentFragment()}getClassNames(){var e,t;return null!==(t=null===(e=this.props)||void 0===e?void 0:e.classNames)&&void 0!==t?t:[]}}class Ir extends Tr{render(){const e=document.createElement("button");return this.getClassNames().forEach((t=>e.classList.add(t))),e.addEventListener("click",(e=>this.onClick(e))),e}getClassNames(){return["button-control",...super.getClassNames()]}onClick(e){const{onClick:t}=this.props;"function"==typeof t&&t(e)}}const Ar=JSON.parse('{"CROSS":"<svg width=\\"24\\" height=\\"24\\" viewBox=\\"0 0 24 24\\" xmlns=\\"http://www.w3.org/2000/svg\\"><path d=\\"M19.707 4.293a.999.999 0 0 0-1.414 0L12 10.586 5.707 4.293a.999.999 0 1 0-1.414 1.414L10.586 12l-6.293 6.293a.999.999 0 1 0 1.414 1.414L12 13.414l6.293 6.293a.997.997 0 0 0 1.414 0 .999.999 0 0 0 0-1.414L13.414 12l6.293-6.293a.999.999 0 0 0 0-1.414\\" fill-rule=\\"evenodd\\"/></svg>","LEARN_MORE":"<svg width=\\"24\\" height=\\"24\\" viewBox=\\"0 0 24 24\\" xmlns=\\"http://www.w3.org/2000/svg\\"><g stroke=\\"none\\" stroke-width=\\"1\\" fill-rule=\\"evenodd\\"><g transform=\\"translate(-753.000000, -1764.000000)\\" fill-rule=\\"nonzero\\"><g transform=\\"translate(153.000000, 1746.000000)\\"><g transform=\\"translate(5.000000, 0.000000)\\"><g transform=\\"translate(459.000000, 0.000000)\\"><g transform=\\"translate(136.000000, 18.000000)\\"><polygon points=\\"24 0 15 0 18.4395 3.4395 9.033 12.846 11.154 14.967 20.5605 5.5605 24 9\\"></polygon><path d=\\"M19.5,24 L1.5,24 C0.672,24 0,23.328 0,22.5 L0,4.5 C0,3.672 0.672,3 1.5,3 L10.5,3 L10.5,6 L3,6 L3,21 L18,21 L18,13.5 L21,13.5 L21,22.5 C21,23.328 20.328,24 19.5,24 Z\\"></path></g></g></g></g></g></g></svg>","PAUSE":"<svg width=\\"24\\" height=\\"24\\" viewBox=\\"0 0 24 24\\" xmlns=\\"http://www.w3.org/2000/svg\\"><g fill-rule=\\"evenodd\\"><rect width=\\"7\\" height=\\"22\\" rx=\\"1\\" x=\\"3\\" y=\\"1\\"></rect><rect x=\\"14\\" width=\\"7\\" height=\\"22\\" rx=\\"1\\" y=\\"1\\"></rect></g></svg>","PLAY":"<svg width=\\"24\\" height=\\"24\\" viewBox=\\"0 0 24 24\\" xmlns=\\"http://www.w3.org/2000/svg\\"><path d=\\"M19.69 12.6L5.143 22.867a.722.722 0 0 1-.753.05.733.733 0 0 1-.391-.65V1.733c0-.274.15-.524.391-.65a.724.724 0 0 1 .753.05l14.545 10.266a.734.734 0 0 1 0 1.201z\\" fill-rule=\\"evenodd\\"></path></svg>","REPLAY":"<svg width=\\"24\\" height=\\"24\\" viewBox=\\"0 0 24 24\\" xmlns=\\"http://www.w3.org/2000/svg\\"><path d=\\"M12 23c6.065 0 11-4.863 11-10.84a.992.992 0 0 0-1-.985c-.553 0-1 .44-1 .986 0 4.89-4.037 8.868-9 8.868s-9-3.978-9-8.868c0-4.89 4.037-8.869 9-8.869a8.991 8.991 0 0 1 6.975 3.292l-3.794-.501a.996.996 0 0 0-1.124.845.987.987 0 0 0 .858 1.108l5.946.785a.996.996 0 0 0 1.124-.845l.797-5.86a.987.987 0 0 0-.858-1.107.994.994 0 0 0-1.124.846l-.446 3.28A10.997 10.997 0 0 0 12 1.322c-6.065 0-11 4.862-11 10.839C1 18.137 5.935 23 12 23\\" fill-rule=\\"evenodd\\"/></svg>","FULLSCREEN_OFF":"<svg width=\\"24\\" height=\\"24\\" viewBox=\\"0 0 24 24\\" xmlns=\\"http://www.w3.org/2000/svg\\"><path d=\\"M5.5 9H8V2H5v4H1v3h4.5zm13 0H16V2h3v4h4v3h-4.5zm-13 6H8v7H5v-4H1v-3h4.5zm13 0H16v7h3v-4h4v-3h-4.5z\\" fill-rule=\\"evenodd\\"/></svg>","FULLSCREEN_ON":"<svg width=\\"24\\" height=\\"24\\" viewBox=\\"0 0 24 24\\" xmlns=\\"http://www.w3.org/2000/svg\\"><path d=\\"M21.5 22H23v-7h-3v4h-4v3h5.5zM23 3.5V9h-3V5h-4V2h7v1.5zm-22 17V15h3v4h4v3H1v-1.5zM2.5 2H1v7h3V5h4V2H2.5z\\" fill-rule=\\"evenodd\\"/></svg>","VOLUME_OFF":"<svg viewBox=\\"0 0 28 28\\" xmlns=\\"http://www.w3.org/2000/svg\\"><defs><style>.cls-1{fill:#fff;opacity:0.4;}.cls-2{fill:#231f20;}</style></defs><title>sound_off_button</title><circle class=\\"cls-1\\" cx=\\"14.06\\" cy=\\"13.96\\" r=\\"13.74\\"/><path class=\\"cls-2\\" d=\\"M16,2.93A13.07,13.07,0,1,1,2.93,16,13.08,13.08,0,0,1,16,2.93M16,2A14,14,0,1,0,30,16,14,14,0,0,0,16,2Z\\" transform=\\"translate(-2 -2)\\"/><g id=\\"Page-1\\"><g id=\\"Video-Player-Skin\\"><g id=\\"Video-Copy\\"><g id=\\"volume-off\\"><path id=\\"Shape\\" class=\\"cls-2\\" d=\\"M14.25,9.17l-3.79,4.11H6.84c-.78,0-1,.46-1,.89V17.7a1,1,0,0,0,1,1h3.65l3.79,4.18a1.09,1.09,0,0,0,.53.14,1,1,0,0,0,.5-.14,1,1,0,0,0,.5-.9V10a1,1,0,0,0-.5-.9,1.06,1.06,0,0,0-1,.05Z\\" transform=\\"translate(-2 -2)\\"/><path id=\\"Fill-1\\" class=\\"cls-2\\" d=\\"M22.91,16.21l3-3a.92.92,0,1,0-1.3-1.3l-3,3-3-3a.92.92,0,1,0-1.3,1.3l3,3-3,3a.92.92,0,1,0,1.3,1.3l3-3,3,3a.92.92,0,1,0,1.3-1.3Z\\" transform=\\"translate(-2 -2)\\"/></g></g></g></g></svg>","VOLUME_ON":"<svg viewBox=\\"0 0 28 28\\" xmlns=\\"http://www.w3.org/2000/svg\\"><defs><style>.cls-1{fill:#fff;opacity:0.4;}.cls-2{fill:#231f20;}</style></defs><title>sound_on_button</title><circle class=\\"cls-1\\" cx=\\"13.96\\" cy=\\"14.06\\" r=\\"13.74\\"/><path class=\\"cls-2\\" d=\\"M16,2.93A13.07,13.07,0,1,1,2.93,16,13.08,13.08,0,0,1,16,2.93M16,2A14,14,0,1,0,30,16,14,14,0,0,0,16,2Z\\" transform=\\"translate(-2 -2)\\"/><g id=\\"Page-1\\"><g id=\\"Video-Player-Skin\\"><g id=\\"Video-Copy\\"><g id=\\"volume\\"><path id=\\"Shape\\" class=\\"cls-2\\" d=\\"M14.24,9.17l-3.79,4.11H6.82c-.78,0-1,.46-1,.89V17.7a1,1,0,0,0,1,1h3.65l3.79,4.18a1.09,1.09,0,0,0,.53.14,1,1,0,0,0,.5-.14,1,1,0,0,0,.5-.9V10a1,1,0,0,0-.5-.9,1.06,1.06,0,0,0-1,.05Z\\" transform=\\"translate(-2 -2)\\"/><path id=\\"Shape-2\\" data-name=\\"Shape\\" class=\\"cls-2\\" d=\\"M19.18,19.33a4.39,4.39,0,0,0,0-6.19.71.71,0,0,0-1,1,3,3,0,0,1,0,4.19.71.71,0,0,0,1,1Z\\" transform=\\"translate(-2 -2)\\"/><path id=\\"Shape-3\\" data-name=\\"Shape\\" class=\\"cls-2\\" d=\\"M23.3,16.23a6.19,6.19,0,0,0-1.81-4.39.71.71,0,1,0-1,1,4.81,4.81,0,0,1,0,6.79.71.71,0,1,0,1,1,6.19,6.19,0,0,0,1.81-4.39Z\\" transform=\\"translate(-2 -2)\\"/></g></g></g></g></svg>","HIVI_VOLUME_OFF":"<svg width=\\"24\\" height=\\"24\\" viewBox=\\"0 0 24 24\\" xmlns=\\"http://www.w3.org/2000/svg\\"><path d=\\"M6 8.007H1.347C.333 8.007 0 8.769 0 9.391v5.032C0 15.045.333 16 1.347 16H6l5.007 5.796c.215.132.454.205.693.205.24 0 .436-.063.65-.196.429-.265.65-.75.65-1.28V3.447c0-.53-.221-1.02-.65-1.284-.429-.265-.935-.187-1.365.078L6 8.007zM20.305 12l2.425-2.425a.922.922 0 1 0-1.306-1.305l-2.425 2.424-2.423-2.424a.923.923 0 0 0-1.306 1.305L17.695 12l-2.425 2.425a.922.922 0 1 0 1.306 1.304L19 13.306l2.425 2.423a.92.92 0 0 0 1.306 0 .922.922 0 0 0 0-1.304L20.305 12z\\" fill-rule=\\"evenodd\\"></path></svg>","HIVI_VOLUME_ON":"<svg width=\\"24\\" height=\\"24\\" viewBox=\\"0 0 24 24\\" xmlns=\\"http://www.w3.org/2000/svg\\"><g fill-rule=\\"evenodd\\"><path d=\\"M6 8.007H1.347C.333 8.007 0 8.769 0 9.391v5.032C0 15.045.333 16 1.347 16H6l5.007 5.796c.215.132.454.205.693.205.24 0 .436-.063.65-.196.429-.265.65-.75.65-1.28V3.447c0-.53-.221-1.02-.65-1.284-.429-.265-.935-.187-1.365.078L6 8.007zm11.612 8.524a5.858 5.858 0 0 0 0-8.253.944.944 0 0 0-1.337 1.332 3.97 3.97 0 0 1 0 5.59.943.943 0 1 0 1.337 1.331z\\"></path><path d=\\"M23.03 12.135c0-2.21-.859-4.292-2.418-5.857a.943.943 0 1 0-1.337 1.332 6.37 6.37 0 0 1 1.868 4.525 6.37 6.37 0 0 1-1.868 4.525.943.943 0 1 0 1.338 1.332 8.249 8.249 0 0 0 2.418-5.857z\\"></path></g></svg>","INFO":"<svg width=\\"24\\" height=\\"24\\" xmlns=\\"http://www.w3.org/2000/svg\\" viewBox=\\"0 0 24 24\\"><path d=\\"M12 22C6.48605 22 2.00005 17.514 2.00005 12C2.00005 6.486 6.48605 2 12 2C17.514 2 22 6.486 22 12C22 17.514 17.514 22 12 22M12 0C5.383 0 0 5.383 0 12C0 18.617 5.383 24 12 24C18.617 24 24 18.617 24 12C24 5.383 18.617 0 12 0\\" clip-rule=\\"evenodd\\"/><path d=\\"M10.9998 18.0171V10.0096C10.9998 9.4556 11.4467 9.00777 11.9997 9.00777 12.5527 9.00777 12.9997 9.4556 12.9997 10.0096V18.0171C12.9997 18.5711 12.5527 19.0189 11.9997 19.0189 11.4467 19.0189 10.9998 18.5711 10.9998 18.0171zM12.0057 7.01379C11.4527 7.01379 10.9998 6.55995 10.9998 6.00693 10.9998 5.4539 11.4527 5.00006 12.0057 5.00006 12.5587 5.00006 13.0107 5.4539 13.0107 6.00693 13.0107 6.55995 12.5587 7.01379 12.0057 7.01379\\" clip-rule=\\"evenodd\\"/></svg>"}');var Cr=s.t(Ar,2);const Or=new window.DOMParser;function Pr(e,t=[]){if(Cr[e]){const i=Or.parseFromString(Cr[e],"image/svg+xml").documentElement;return i.setAttribute("class",t.join(" ")),i}return null}const kr=Object.keys(Cr).reduce(((e,t)=>(e[t]=t,e)),{});class Nr extends Tr{render(){const{onClick:e}=this.props,t=new Ir({onClick:e,classNames:this.getClassNames()}).render(),i=Pr(kr.CROSS,["icon",...this.getIconClassNames()]);return i&&t.appendChild(i),t}getClassNames(){return["button-close",...super.getClassNames()]}getIconClassNames(){var e,t;return null!==(t=null===(e=this.props)||void 0===e?void 0:e.iconClassNames)&&void 0!==t?t:[]}}class Lr extends Tr{constructor(e){super(e),this.dialog=document.createElement("dialog"),this.dialog.classList.add("dsa-dialog"),this.dialog.id=Lr.getDialogId(e.slot)}static getDialogId(e){return`dsa-dialog-${e}`}render(){return this.renderHeader(),this.renderAdvertiserInfo(),this.dialog}getElement(){return this.dialog}renderHeader(){const e=document.createElement("header");e.classList.add("dsa-dialog-header");const t=document.createElement("h2");t.classList.add("dsa-dialog-title"),t.innerText="About this ad",e.appendChild(t);const i=new Nr({onClick:e=>{e.preventDefault(),this.dialog.close(),_i.emit(Er,{adSlotName:this.props.slot})},classNames:["dsa-button-close"]}).render();e.appendChild(i),this.dialog.appendChild(e),this.dialog.appendChild(this.renderSeparator())}renderAdvertiserInfo(){const{behalf:e,paid:t}=this.props,i=document.createElement("div");i.classList.add("dsa-dialog-container");const n=document.createElement("h3");n.classList.add("dsa-dialog-subtitle"),n.innerText="Advertiser",i.appendChild(n);const s=document.createElement("span");s.innerHTML="On behalf: <i>"+e+"</i>",i.appendChild(s);const r=document.createElement("span");r.innerHTML="Paid by: <i>"+t+"</i>",i.appendChild(r),i.appendChild(this.renderSeparator());const o=document.createElement("h4");o.innerText="This ad is based on:",i.appendChild(o);const a=document.createElement("ul");a.style.listStyle="inside";const d=document.createElement("li");d.innerText="The information on the website you were viewing",a.appendChild(d),i.appendChild(a),this.dialog.appendChild(i)}renderSeparator(){const e=document.createElement("hr");return e.classList.add("dsa-dialog-separator"),e}}class Rr extends Tr{render(){const{onClick:e,elementId:t}=this.props,i=document.createElement("div");i.id=t;const n=Pr(kr.INFO,["icon",...super.getClassNames()]);return n&&(i.appendChild(n),n.addEventListener("click",e)),i.classList.add("learn-more"),i}}class Dr extends Tr{render(){const e=document.createElement("div");e.classList.add("advertisement-label"),e.setAttribute("data-slot-name",this.props.slot);const t=document.getElementById(`dsa-dialog-${this.props.slot}`);if(null!==t){const i=e=>{e.preventDefault(),t.showModal(),_i.emit(_r,{adSlotName:this.props.slot})},n=new Rr({classNames:["dsa-advertisement-label-icon","dsa-advertisement-label-clickable"],elementId:this.getInfoIconId(t),onClick:i}),s=document.createElement("span");s.classList.add("dsa-advertisement-label-clickable"),s.innerHTML=`${Xn("advertisement")} ${n.render().innerHTML}`,s.addEventListener("click",i),e.appendChild(s)}else e.innerText=Xn("advertisement");return e}getInfoIconId(e){return`learn-more-${e.id}`}static clearPlaceholderLabels(e){var t,i;if(!e.getElement())return!0;if("interstitial"===e.getSlotName())return!0;const n=e.getAdLabels();null==n||n.forEach((e=>e.remove()));const s=null===(i=null===(t=e.getPlaceholder())||void 0===t?void 0:t.parentElement)||void 0===i?void 0:i.querySelector(".ae-translatable-label");return s&&s.remove(),!1}}const xr=new class{constructor(){this.isRegistered=!1}isEnabled(){var e;return null!==(e=O.get("options.dsa.modal.enabled"))&&void 0!==e&&e}register(){this.isRegistered?Wn("DSA","DSA handler already registered"):(this.isRegistered=!0,Wn("DSA","Registering DSA handler"),_i.on(wr,(({slot:e,behalf:t,paid:i})=>{Wn("DSA","DSA data available for slot "+e.getSlotName(),{slot:e,behalf:t,paid:i}),e?e.getElement()?this.render({slot:e,behalf:t,paid:i}):Wn("DSA","Slot "+e.getSlotName()+" element does not exist"):Wn("DSA","Slot does not exist")}),!1))}render({behalf:e,paid:t,slot:i}){if(!this.isEnabled())return;if("interstitial"===i.getSlotName())return;const n=new Lr({behalf:e,paid:t,slot:i.getSlotName()}),s=n.getElement();this.alreadyHasDsaModal(s.id)||(document.body.appendChild(n.render()),this.renderAdLabel(i))}rerender(e){if(!this.isEnabled())return;const t=Lr.getDialogId(e.getSlotName()),i=document.getElementById(t);null!==i&&(i.remove(),this.renderAdLabel(e))}renderAdLabel(e){const t=e.getElement();if(!t)return;Dr.clearPlaceholderLabels(e),Wn("DSA","Rendering ad label for slot "+e.getSlotName());const i=t.querySelector(`.${ze}`);i&&i.remove();const n=new Dr({slot:e.getSlotName()});t.appendChild(n.render())}alreadyHasDsaModal(e){const t=document.getElementById(e);return null!==t&&"DIALOG"===t.nodeName}reset(){this.isRegistered=!1}};class zr{constructor(e){this.customIframe=null,this.element=null,this.status=null,this.isEmpty=!0,this.advertiserId=null,this.orderId=null,this.creativeId=null,this.creativeSize=null,this.lineItemId=null,this.winningBidderDetails=null,this.trackStatusAfterRendered=!1,this.slotViewed=!1,this.refreshAttemptCount=0,this.requested=null,this.loaded=null,this.rendered=null,this.viewed=null,this.logger=(...e)=>Wn(zr.LOG_GROUP,...e),this.config=O.get(`slots.${e.id}`)||{},this.enabled=!this.config.disabled,this.config.uid||O.set(`slots.${e.id}.uid`,bn()),this.config.slotName=this.config.slotName||e.id,this.config.slotNameSuffix=this.config.slotNameSuffix||"",this.setUpSlotTargeting(),delete this.config.targeting,this.requested=new Promise((e=>{_i.onSlotEvent(bs.SLOT_REQUESTED_EVENT,(()=>{this.pushTime=(new Date).getTime(),e()}),this.getSlotName())})),this.loaded=new Promise((e=>{_i.onSlotEvent(bs.SLOT_LOADED_EVENT,(()=>{xs.setDataParam(this,"slotLoaded",!0),e()}),this.getSlotName())})),this.rendered=new Promise((e=>{_i.onSlotEvent(bs.SLOT_RENDERED_EVENT,(({payload:t})=>{const{event:i,adType:n}=t;this.setupSizesTracking(n),this.updateOnRenderEnd(i,n),e()}),this.getSlotName())})),this.viewed=new Promise((e=>{_i.onSlotEvent(bs.SLOT_VIEWED_EVENT,(()=>{xs.setDataParam(this,"slotViewed",!0),e()}),this.getSlotName())})).then((()=>{this.slotViewed=!0})),this.addClass(Ji.AD_CLASS),this.enabled||this.hide()}setUpSlotTargeting(){const e=this.config.targeting||{};e.src=e.src||O.get("src"),e.pos=e.pos||this.getSlotName(),e.rv=e.rv||"1",us.extend(e,this.getSlotName())}getAdUnit(){return this.adUnit||(this.adUnit=ps.build(this.config.adUnit||O.get("adUnitId"),{slotConfig:this.config})),this.adUnit}getVideoAdUnit(){return ps.build(this.config.videoAdUnit||O.get("vast.adUnitId"),{slotConfig:this.config})}getIframeSize(){const e=document.querySelector(`#${this.getSlotName()} iframe`);return{width:e.clientWidth,height:e.clientHeight}}getElement(){return this.element||(this.element=document.getElementById(this.getSlotName())),this.element}getPlaceholder(){var e;const t=null===(e=this.getElement())||void 0===e?void 0:e.parentElement;return(null==t?void 0:t.classList.contains(Ji.AD_SLOT_PLACEHOLDER_CLASS))?t:null}getAdLabels(e){var t;if(e){const t=document.querySelector(e);return null==t?void 0:t.querySelectorAll(`.${ze}`)}return null===(t=this.getPlaceholder())||void 0===t?void 0:t.querySelectorAll(`.${ze}`)}getAdContainer(){const e=this.getElement();return e?e.querySelector('div[id*="_container_"]'):null}getIframe(){const e=this.getElement();return e?this.customIframe?this.customIframe:e.querySelector('div[id*="_container_"] iframe'):null}overrideIframe(e){this.customIframe=e}getFrameType(){const e=this.getIframe();return e?"true"===e.dataset.isSafeframe?"safe":"regular":null}getCreativeSize(){return Array.isArray(this.creativeSize)?this.creativeSize.join("x"):this.creativeSize}getCreativeSizeAsArray(){if(!this.creativeSize)return null;const e=Array.isArray(this.creativeSize)?this.creativeSize:this.creativeSize.split("x").map(Number);return[e[0],e[1]]}getMainPositionName(){const{pos:e=""}=us.dump(this.getSlotName());return(Array.isArray(e)?e:e.split(","))[0].toLowerCase()}getUid(){return this.config.uid}getSlotName(){return this.config.slotName}getSizes(){return this.config.sizes}get targeting(){return us.dump(this.getSlotName())}getTargeting(){let e={};return this.config.bidderAlias&&(e=us.dump(this.config.bidderAlias)),e=Object.assign(Object.assign({},e),us.dump(this.getSlotName())),this.parseTargetingParams(e)}parseTargetingParams(e){const t={};return Object.keys(e).forEach((i=>{let n=e[i];"function"==typeof n&&(n=n()),null!==n&&(t[i]=n)})),t}getDefaultSizes(){return this.config.defaultSizes}getVideoSizes(){return this.config.videoSizes}getViewportConflicts(){return this.config.viewportConflicts||[]}hasDefinedViewportConflicts(){return this.getViewportConflicts().length>0}getStatus(){return this.status}getPushTime(){return this.pushTime}getRefreshAttemptCount(){return this.refreshAttemptCount}updatePushTimeAfterBid(){const e=O.get("bidders.timeout")||2e3;this.pushTime=(new Date).getTime()+e}setStatus(e=null){this.status=e,null!==e&&(this.emit(e),xs.setDataParam(this,"slotResult",this.getStatus()),this.emit(bs.SLOT_STATUS_CHANGED))}resetRefreshAttemptCount(){this.refreshAttemptCount=0,this.logger(this.getSlotName(),"Reset refresh attempt count to 0.")}incrementRefreshAttemptCount(){this.refreshAttemptCount++,this.logger(this.getSlotName(),`Incremented refresh attempt count to ${this.refreshAttemptCount}`)}isEnabled(){return this.enabled}isFirstCall(){return!!this.config.firstCall}isViewed(){return this.slotViewed}isOutOfPage(){return!!this.config.outOfPage}isRefreshAttemptLimitReached(){return this.refreshAttemptCount>=zr.REFRESH_ATTEMPT_LIMIT}isRefreshAttemptStarted(){return this.refreshAttemptCount>0}isVideo(){return!!this.config.isVideo}getCopy(){return JSON.parse(JSON.stringify(this.config))}getTopOffset(){const e=this.getElement();return e?tn(e):null}enable(){this.enabled=!0}disable(e=null){this.enabled=!1,this.setStatus(e),this.hide()}destroy(){this.disable(),this.emit(bs.DESTROY_EVENT),this.destroyTracking()}destroyTracking(){var e;null===(e=this.placementResizeObserver)||void 0===e||e.disconnect(),delete this.placementResizeObserver}getConfigProperty(e){return O.get(`slots.${this.config.slotName}.${e}`)}getTargetingProperty(e){return us.get(e,this.getSlotName())}setConfigProperty(e,t){O.set(`slots.${this.config.slotName}.${e}`,t)}setTargetingConfigProperty(e,t){us.set(e,t,this.config.slotName)}success(e=zs.STATUS_SUCCESS){this.getConfigProperty("showManually")||this.show(),this.setStatus(e);const t=this.getConfigProperty("skipTemplates")?[]:this.getConfigProperty("defaultTemplates")||[];t&&t.length&&t.forEach((e=>ur.init(e,this))),this.emit(bs.TEMPLATES_LOADED,t),_i.emit(vi,{name:this.getSlotName(),state:zs.STATUS_SUCCESS}),this.setupDelayedCollapse()}setupDelayedCollapse(){_i.on(Ms,(e=>{e.source.includes(this.getSlotName())&&(this.logger(this.getSlotName(),"GAM_AD_DELAYED_COLLAPSE event received.","138315346255"===this.creativeId?"IndexExchange Creative was served":"Non IndexExchange Creative."),this.collapse())}),!1)}collapse(e=zs.STATUS_COLLAPSE){_i.emit(vi,{name:this.getSlotName(),state:zs.STATUS_COLLAPSE}),this.hide(),this.setStatus(e)}refresh(){const e=this.getSlotName();if(this.incrementRefreshAttemptCount(),this.logger(e,`Refreshing ad slot after no ad was served. Attempt ${this.getRefreshAttemptCount()}.`),this.isRefreshAttemptLimitReached())return this.logger(e,"Refresh attempt for ad slot count exceeded 5. Disabling slot."),void this.collapse();O.get(`slots.${e}.bidGroup`)||O.set(`slots.${e}.bidGroup`,e),_i.emit(yr,{group:O.get(`slots.${e}.bidGroup`),callback:()=>{lr.refreshSlot(this),xr.rerender(this)},shouldUpdateTargetingBeforeCallback:!0})}updateWinningPbBidderDetails(){this.getTargetingProperty("hb_bidder")&&this.getTargetingProperty("hb_pb")?this.winningBidderDetails={name:this.getTargetingProperty("hb_bidder"),price:this.getTargetingProperty("hb_pb")}:this.winningBidderDetails=null}updateWinningA9BidderDetails(){this.getTargetingProperty("amznbid")?this.winningBidderDetails={name:"a9",price:this.getTargetingProperty("amznbid")}:this.winningBidderDetails=null}updateOnRenderEnd(e,t){if(!e)return;let i=e.creativeId,n=e.lineItemId;if(this.isEmpty=e.isEmpty,!e.isEmpty&&e.slot){const t=e.slot.getResponseInformation();t&&(this.orderId=t.campaignId,this.advertiserId=t.advertiserId,e.sourceAgnosticCreativeId&&e.sourceAgnosticLineItemId?(this.logger("set line item and creative id to source agnostic values"),i=e.sourceAgnosticCreativeId,n=e.sourceAgnosticLineItemId):null===t.creativeId&&null===t.lineItemId&&(i=Zs,n=Zs)),this.isRefreshAttemptStarted()&&this.resetRefreshAttemptCount()}switch(this.creativeId=i,this.lineItemId=n,this.creativeSize=this.isOutOfPage()?"out-of-page":e.size,qs.updateOnRenderEnd(this),t){case zs.STATUS_NO_AD:this.refresh();break;case zs.STATUS_COLLAPSE:case zs.STATUS_FORCED_COLLAPSE:this.collapse(t);break;case zs.STATUS_MANUAL:this.setStatus(t);break;case zs.STATUS_SKIP_TEMPLATE:this.setConfigProperty("skipTemplates",!0),this.success();break;default:this.success()}}addClass(e){const t=this.getElement();return!!t&&(t.classList.add(e),!0)}removeClass(e){const t=this.getElement();return!!t&&(t.classList.remove(e),!0)}hide(){const e=this.addClass(Ji.HIDDEN_AD_CLASS);this.getPlaceholder()&&this.isHidingTopPlaceholderApplicable()&&this.getPlaceholder().classList.add(Ji.HIDDEN_AD_CLASS),e&&this.emit(bs.HIDDEN_EVENT)}isHidingTopPlaceholderApplicable(){return e=this.config,O.get("state.condition.hide.slot.placeholder")&&!!(null==e?void 0:e.hideTopPlaceholderOnUapAndRuap);var e}show(){const e=this.removeClass(Ji.HIDDEN_AD_CLASS);this.getPlaceholder()&&this.isHidingTopPlaceholderApplicable()&&this.getPlaceholder().classList.remove(Ji.HIDDEN_AD_CLASS),e&&this.emit(bs.SHOWED_EVENT)}emit(e,t={},i=!0){_i.emit(fi,{event:e.toString(),slot:this,adSlotName:this.getSlotName(),payload:i?JSON.parse(JSON.stringify(t)):t}),this.logger(this.getSlotName(),e,t)}emitEvent(e=null){null!==e&&this.emit(bs.CUSTOM_EVENT,{status:e})}setupSizesTracking(e){const t=document.querySelector(`#${this.getMainPositionName()}`),i=this.getPushTime();if(t instanceof Element&&e.includes("success")&&window.ResizeObserver&&!this.placementResizeObserver){const e=Ki((()=>{i!==this.lastReportedRefreshId&&(_i.emit(bi,{slot:this}),this.lastReportedRefreshId=i)}),1e3);this.placementResizeObserver=new ResizeObserver((()=>{e()})),this.placementResizeObserver.observe(t)}}}zr.LOG_GROUP="AdSlot",zr.REFRESH_ATTEMPT_LIMIT=5;class Vr{constructor(e){this.context=e}isEnabled(){const e=this.context.get("services.nativo.enabled")&&this.context.get("wiki.opts.enableNativeAds");return Vr.log("Is Nativo enabled?",e),e}load(){Vr.log("Loading Nativo API..."),ls.loadScript("//s.ntv.io/serve/load.js",!0,null,{},{ntvSetNoAutoStart:""}).then((()=>{Vr.log("Nativo API loaded."),this.watchNtvEvents()}))}scrollTriggerCallback(e){this.context.push("state.adStack",{id:e})}replaceAndShowSponsoredFanAd(){const e=document.getElementById(Vr.FEED_AD_SLOT_NAME),t=document.querySelector(".recirculation-prefooter__item.is-sponsored.can-nativo-replace");e&&t?(t.replaceWith(e),Vr.log("Replacing sponsored element with Nativo feed ad")):Vr.log("Could not replace sponsored element with Nativo feed ad")}static log(...e){Wn("nativo",...e)}watchNtvEvents(){var e,t,i,n;null===(t=null===(e=window.ntv.Events)||void 0===e?void 0:e.PubSub)||void 0===t||t.subscribe("noad",(e=>{const t=Vr.AD_SLOT_MAP[e.data[0].id];this.handleNtvNativeEvent(e,t,zs.STATUS_COLLAPSE)})),null===(n=null===(i=window.ntv.Events)||void 0===i?void 0:i.PubSub)||void 0===n||n.subscribe("adRenderingComplete",(e=>{const t=Vr.extractSlotIdFromNativoCompleteEventData(e);this.handleNtvNativeEvent(e,t,zs.STATUS_SUCCESS)}))}static extractSlotIdFromNativoNoAdEventData(e){var t;return(null===(t=e.data[0])||void 0===t?void 0:t.adLocation)?e.data[0].adLocation.substring(1):Vr.AD_SLOT_MAP[e.data[0].id]}static extractSlotIdFromNativoCompleteEventData(e){return e.data.placement?Vr.AD_SLOT_MAP[e.data.placement]:Vr.AD_SLOT_MAP[e.data.id]}handleNtvNativeEvent(e,t,i){if(Vr.log("Nativo native event fired",e,t,i),!t)return;const n=Qr.get(t);Vr.log("Handling Nativo native event",t,n),n&&n.getSlotName()===t&&(i===zs.STATUS_COLLAPSE&&n.hide(),i===zs.STATUS_SUCCESS&&t===Vr.FEED_AD_SLOT_NAME&&this.replaceAndShowSponsoredFanAd(),n.getStatus()!==i?n.setStatus(i):Vr.log("Slot status already tracked",n.getSlotName(),i))}}Vr.FEED_AD_SLOT_NAME="ntv_feed_ad",Vr.AD_SLOT_MAP={1142668:Vr.FEED_AD_SLOT_NAME,1142669:Vr.FEED_AD_SLOT_NAME,456441:Vr.FEED_AD_SLOT_NAME},window.pbjs=window.pbjs||{},window.pbjs.que=window.pbjs.que||[];const Mr=new class{init(){if(!this.instancePromise){const e=O.get("bidders.prebid.libraryUrl");ls.loadScript(e,!0,"first"),this.instancePromise=new Promise((e=>window.pbjs.que.push((()=>{Wn("pbjs-factory","Prebid library loaded"),e(window.pbjs)}))))}return this.instancePromise}};class Ur{constructor(){this.iframeBuilder=new Zn}fillIn(e){return c(this,void 0,void 0,(function*(){const t=yield Mr.init();_i.action$.pipe(Si(_i.getGlobalAction(gr)),pi((t=>"prebid"===t.provider&&t.slotName===e.getSlotName())),hi(1)).subscribe((()=>{var i,n;const s=this.getIframeDoc(e),r=this.getAdId(e);s&&r&&(t.renderAd(s,r),null===(n=null===(i=e.getElement())||void 0===i?void 0:i.classList)||void 0===n||n.remove(Ji.HIDDEN_AD_CLASS),e.success(),Wn("prebidium-provider",e.getSlotName(),"slot added"))}))}))}getIframeDoc(e){return this.iframeBuilder.create(e.getElement()).contentWindow.document}getAdId(e){return us.get("hb_adid",e.getSlotName())}}class jr{constructor(e){this.ntvApi=e||{},this.ntvApi.cmd=this.ntvApi.cmd||[]}fillIn(e){return Wn("nativo",`Filling ${e.getSlotName()} by pushing Nativo's command queue`),this.getQueue().push((()=>{window.PostRelease.Start()})),!0}getQueue(){return this.ntvApi.cmd}}class Br{fillIn(e){e.setStatus(zs.STATUS_SUCCESS)}}const $r="slot-refresher",Fr={timeoutMS:28e3,slots:[]};function Hr(e,t){O.get(`slots.${e}.bidGroup`)||O.set(`slots.${e}.bidGroup`,e),_i.emit(yr,{group:O.get(`slots.${e}.bidGroup`),callback:t,shouldUpdateTargetingBeforeCallback:!0})}const Gr=new class{constructor(){this.slotsInTheViewport=[]}log(...e){Wn($r,...e)}isSlotRefreshable(e){return this.config.slots.includes(e)}removeHigherSlotSizes(e){const t=e.getSlotName(),i=O.get("slotConfig.slotRefresher.sizes");if(!i)return;const n=i[t][1];if(!n)return;const s=e=>e[1]<=n&&e[1]>3,r=O.get(`slots.${e.getSlotName()}.sizes`);if(r&&r.length>0){const t=r.map((e=>Object.assign(Object.assign({},e),{sizes:e.sizes.filter(s)})));O.set(`slots.${e.getSlotName()}.sizes`,t)}const o=O.get(`slots.${e.getSlotName()}.defaultSizes`);o&&O.set(`slots.${e.getSlotName()}.defaultSizes`,o.filter(s)),e.config.sizes&&(e.config.sizes=e.config.sizes.filter(s)),e.config.defaultSizes&&(e.config.defaultSizes=e.config.defaultSizes.filter(s)),_i.emit(Sr,{adSlot:e,filterCallback:s})}addSlotSizeToContext(e){O.set(`slotConfig.slotRefresher.sizes.${e.getSlotName()}`,[e.getElement().clientWidth,e.getElement().clientHeight])}refreshSlot(e){if(!this.isSlotRefreshable(e.getSlotName()))return;const t=O.get("slotConfig.slotRefresher.sizes")||{};e.getSlotName()in t||setTimeout((()=>{this.addSlotSizeToContext(e),this.removeHigherSlotSizes(e)}),1e3),setTimeout((()=>{if(e.isEnabled()){if(this.slotsInTheViewport.includes(e.getSlotName()))return e.updatePushTimeAfterBid(),void Hr(e.getSlotName(),(()=>{e.destroyTracking(),lr.refreshSlot(e),xr.rerender(e)}));this.log(`refreshSlot() - ${e.getSlotName()} waiting for being in viewport.`),function(e){window.googletag.pubads().addEventListener("slotVisibilityChanged",(function t(i){i.slot.getSlotElementId()===e.getSlotName()&&(Wn($r,`${e.getSlotName()} back in the viewport, refreshing.`,i),Hr(e.getSlotName(),(()=>{lr.refreshSlot(e),xr.rerender(e)})),window.googletag.pubads().removeEventListener("slotVisibilityChanged",t))}))}(e)}}),this.config.timeoutMS)}addSlotsConfiguredToRefreshing(){const e=Qr.slotConfigsMap;Object.entries(e).forEach((([e,t])=>{t.slotRefreshing&&this.config.slots.push(e)}))}setupSlotRefresher(e,t,i){this.config=Object.assign(Object.assign({},Fr),e),this.addSlotsConfiguredToRefreshing(),this.config.slots.length<1||t?i("disabled"):(_i.onSlotEvent(bs.SLOT_VIEWED_EVENT,(({adSlotName:e,slot:t})=>{this.isSlotRefreshable(e)&&(i(`${e} viewed`),this.refreshSlot(t))})),_i.onSlotEvent(zs.STATUS_COLLAPSE,(({adSlotName:e})=>{this.isSlotRefreshable(e)&&i(`${e} collapse`)})),_i.onSlotEvent(bs.SLOT_BACK_TO_VIEWPORT,(({adSlotName:e})=>{this.isSlotRefreshable(e)&&this.slotsInTheViewport.push(e)})),_i.onSlotEvent(bs.SLOT_LEFT_VIEWPORT,(({adSlotName:e})=>{this.isSlotRefreshable(e)&&(this.slotsInTheViewport=this.slotsInTheViewport.filter((t=>t!==e)))})),i("enabled",this.config))}init(){return c(this,void 0,void 0,(function*(){this.setupSlotRefresher(O.get("services.slotRefresher.config"),yield function(){return c(this,void 0,void 0,(function*(){return new Promise((e=>{_i.on($s,(t=>{const i=t.isLoaded||"ruap"===t.adProduct;e(i)}))}))}))}(),this.log)}))}},qr="ad-engine";function Wr(){const e=O.get("state.adStack");return Wn(qr,"getting adStack: ",...e),e}class Kr{constructor(e=null){this.started=!1,O.extend(e),window.ads=window.ads||{},window.ads.runtime=window.ads.runtime||{},_i.on(Ps,(()=>{Qr.removeAll()}),!1)}init(){return c(this,void 0,void 0,(function*(){var e;this.setupProviders(),this.setupAdStack(),Gs.init(),(e=O.get("options.customAdLoader.globalMethodName"))&&(window[e]=e=>{var t;const i=(null==e?void 0:e.slotName)?Qr.get(e.slotName):null;ur.init(null!==(t=null==e?void 0:e.type)&&void 0!==t?t:"bfaa",i,e)}),Ls.init(),ur.subscribeCommunicator(),xs.registerMessageListener(Qr.get.bind(Qr)),this.runAdQueue(),ks.init(),Gr.init(),this.setupPushOnScrollQueue()}))}setupProviders(){const e=O.get("state.provider");this.defaultProvider=this.createProvider(e);const t=new Vr(O);t.isEnabled()&&t.load()}setupAdStack(){this.adStack=Wr(),this.adStack.start||ns(this.adStack,(e=>{const t=new zr(e);this.pushSlot(t)}))}pushSlot(e){const t=O.get(`slots.${e.getSlotName()}.providers`)||[];if(Qr.add(e),t.length>0){const i=t.shift();this.createProvider(i).fillIn(e)}else this.defaultProvider.fillIn(e)}createProvider(e){switch(e){case"prebidium":return new Ur;case"nativo":return new jr(window.ntv);case"nothing":return new Br;default:return new lr}}setupPushOnScrollQueue(){if(O.get("events.pushOnScroll")){const e=O.get("events.pushOnScroll.ids")||[],t=new ss(...e);t.onItemFlush((e=>{ks.addSlot(e,{threshold:O.get("events.pushOnScroll.threshold")||0})})),O.set("events.pushOnScroll.ids",t),t.flush()}}runAdQueue(){_i.on(Is,(()=>{this.started||(_i.emit(As),this.started=!0,this.adStack.start(),_i.emit(Cs))}))}}const Yr="slot-service",Qr=new class{constructor(){this.slotStatuses={},this.slotStates={},this.slots={}}add(e){const t=e.getSlotName();this.slots[t]=e,!1===this.slotStates[t]&&e.disable(this.slotStatuses[t]),!0===this.slotStates[t]&&e.enable(),xs.addDefaultClasses(e),_i.emit(mi,{name:t,slot:e,state:bs.SLOT_ADDED_EVENT})}removeAll(){Object.values(this.slots).forEach((e=>this.remove(e)))}remove(e){const t=e.getSlotName();O.removeListeners(`slots.${t}`),e.destroy(),delete this.slots[t],delete this.slotStates[t],delete this.slotStatuses[t]}get(e){if(e.includes("gpt_unit_")){const t=this.getGptAdSlot(e);return this.setGptAdSlotInsertId(t,e),t}const[t]=e.split(",");if(this.slots[t])return this.slots[t];let i=null;return this.forEach((e=>{if(null!==i)return;const n=us.get("pos",e.getSlotName())||[];n!==t&&n[0]!==t||(i=e)})),i}getSlotId(e){let t=O.get(`slots.${e}.uid`);return t||(t=bn(),O.set(`slots.${e}.uid`,t)),t}forEach(e){Object.keys(this.slots).forEach((t=>{e(this.slots[t])}))}enable(e){this.setState(e,!0)}disable(e,t=null){this.setState(e,!1,t)}getState(e){return!1!==this.slotStates[e]}setState(e,t,i=null){const n=this.get(e);this.slotStates[e]=t,this.slotStatuses[e]=i,n?(n.setStatus(i),t?n.enable():n.disable()):t?O.set(`slots.${e}.disabled`,!1):O.set(`slots.${e}.disabled`,!0),Wn(Yr,"set state",e,t)}hasViewportConflict(e){if(!e.hasDefinedViewportConflicts()||null===e.getElement())return!1;const t=e.getElement().offsetHeight,i=tn(e.getElement()),n=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,s=e.getViewportConflicts().some((e=>function(e,t,i,n){const s=document.getElementById(n);if(null===s.offsetParent)return!1;const r=s.offsetHeight,o=tn(s);return(o<t?t-o-r:o-t-e)<i}(t,i,n,e)));return Wn(Yr,"hasViewportConflict",e.getSlotName(),s),s}get slotConfigsMap(){return O.get("slots")||{}}getFirstCallSlotNames(){return Object.entries(this.slotConfigsMap).filter((([,e])=>!!e.firstCall)).map((([e])=>e))}getNonFirstCallSlotNames(){return Object.entries(this.slotConfigsMap).filter((([,e])=>!e.firstCall)).map((([e])=>e))}getEnabledSlotNames(){return Object.entries(this.slotConfigsMap).filter((([,e])=>!e.disabled)).map((([e])=>e))}pushSlot(e){this.pushSlotById(e.id)}pushSlotById(e){const t=Wr();t?(Wn(Yr,`Push slot ${e} to adStack.`),this.addToAdStack(t,e)):Wn(Yr,`Could not push slot ${e} because adStack is not present.`)}addToAdStack(e,t){!function(e,t){const i=!!O.get(`slots.${e}.bidBeforeRun`),n=O.get(`slots.${e}.bidGroup`);i&&n?(Wn("bid-before-run",`Bid before push ${e}`),_i.emit(yr,{group:n,callback:()=>{t()}})):t()}(t,(()=>{e.push({id:t})}))}getGptAdSlot(e){const t=O.get("custom.serverPrefix"),i=new RegExp(`/${t?`${t}.`:""}[A-Z]+/(?<slotName>[a-z_]+)/`),n=e.match(i);try{return this.slots[n.groups.slotName]}catch(e){throw new Error("Unsupported GPT Template slot id format")}}setGptAdSlotInsertId(e,t){e.setConfigProperty("insertId",t)}},Jr=["preroll","midroll","postroll"],Xr="https://pubads.g.doubleclick.net/gampad/ads?";function Zr(e,t={},i=!0){const n=us.dump()||{},s={};Object.keys(n).forEach((e=>{!function(e,t){"function"==typeof t?s[e]=t():"undefined"!==t&&null!==t&&(s[e]=t)}(e,n[e])})),_i.emit(yi,{slot:e});const r=Object.assign(Object.assign(Object.assign({},s),e.getTargeting()),t),o=Object.keys(r).filter((e=>r[e])).map((e=>`${e}=${r[e]}`)).join("&");return i?encodeURIComponent(o):o}function eo(e,t,i={}){const n=["output=xml_vast4","env=vp","gdfp_req=1","impl=s","unviewed_position_start=1",`url=${encodeURIComponent(window.location.href)}`,`description_url=${encodeURIComponent(window.location.href)}`,`correlator=${Math.round(1e10*Math.random())}`],s=Qr.get(t),r=us.get("ppid"),o=us.get("over18");if(o&&n.push(`over_18=${o}`),r&&n.push(`ppid=${r}`),is()&&n.push("tfcd=1"),s)n.push(`iu=${s.getVideoAdUnit()}`),n.push(`sz=${function(e){const t=e.getVideoSizes();return t?t.map((e=>e.join("x"))).join("|"):"640x480"}(s)}`),n.push(`cust_params=${Zr(s,i.targeting)}`);else{if(!i.videoAdUnitId||!i.customParams)throw Error("Slot does not exist!");n.push(`iu=${i.videoAdUnitId}`),n.push("sz=640x480"),n.push(`cust_params=${encodeURIComponent(i.customParams)}`)}if(i.contentSourceId&&i.videoId&&(n.push(`cmsid=${i.contentSourceId}`),n.push(`vid=${i.videoId}`)),i.vpos&&Jr.indexOf(i.vpos)>-1&&n.push(`vpos=${i.vpos}`),void 0!==i.numberOfAds&&n.push(`pmad=${i.numberOfAds}`),n.push("rdp="+(js.isOptOutSale()?1:0)),n.push("npa="+(js.isOptedIn()?0:1)),i.isTagless){const e=O.get("options.geoRequiresConsent"),t=O.get("options.geoRequiresSignal");n.push("tagless=1"),e?n.push("gdpr=1"):n.push("gdpr=0"),e&&i.gdpr_consent&&n.push(`gdpr_consent=${i.gdpr_consent}`),t&&i.us_privacy&&n.push(`us_privacy=${i.us_privacy}`)}return Xr+n.join("&")}const to={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};var io,no=new Uint8Array(16);function so(){if(!io&&!(io="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return io(no)}for(var ro=[],oo=0;oo<256;++oo)ro.push((oo+256).toString(16).slice(1));const ao=function(e,t,i){if(to.randomUUID&&!t&&!e)return to.randomUUID();var n=(e=e||{}).random||(e.rng||so)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){i=i||0;for(var s=0;s<16;++s)t[i+s]=n[s];return t}return function(e,t=0){return(ro[e[t+0]]+ro[e[t+1]]+ro[e[t+2]]+ro[e[t+3]]+"-"+ro[e[t+4]]+ro[e[t+5]]+"-"+ro[e[t+6]]+ro[e[t+7]]+"-"+ro[e[t+8]]+ro[e[t+9]]+"-"+ro[e[t+10]]+ro[e[t+11]]+ro[e[t+12]]+ro[e[t+13]]+ro[e[t+14]]+ro[e[t+15]]).toLowerCase()}(n)},lo=new class{v4(){return ao()}},co={addListener:function(e,t,i={}){const n={element:e,callback:t,offsetTop:i.offsetTop||0,offsetBottom:i.offsetBottom||0,areaThreshold:i.areaThreshold,inViewport:!1},s=()=>{!function(e){const t=on(e.element,{topOffset:e.offsetTop,bottomOffset:e.offsetBottom,areaThreshold:e.areaThreshold});t!==e.inViewport&&(e.callback(t),e.inViewport=t)}(n)};return n.id=ks.addCallback(s),s(),n.id},removeListener:function(e){ks.removeCallback(e)}};class uo{constructor(e,t=100,i=0,n=0){this.condition=e,this.noTries=t,this.growingTimeout=i,this.fixedTimeout=n}until(){return c(this,void 0,void 0,(function*(){let e=0,t=this.growingTimeout||this.fixedTimeout,i=this.condition();for(;!i&&e<this.noTries;)yield this.delay(t),i=this.condition(),this.growingTimeout&&(t*=2),e++;return Promise.resolve(i)}))}delay(e){return new Promise((t=>{this.timeoutId=setTimeout(t,e)}))}reset(){this.timeoutId&&window.clearTimeout(this.timeoutId)}}class po{constructor(e){this.params=e,this.repository={}}init(){return c(this,arguments,void 0,(function*(e={}){const t={country:yn(),continent:Sn(),region:wn()},i=new Le(this.params),n=new Oe(new ye(Wi.getBrowser()),new we(Wi.getDeviceType()),new Ee,new Ie(t));return this.interpreter=yield i.getConfig().then((e=>(new xe).override(y.getURLSearchParams(),e))).then((t=>n.init(t,e))),this.repository=this.interpreter.getValues(),Wn("instant-config-service","instantiated with",this.repository),this}))}get(e,t){var i,n;return null!==(n=null===(i=this.repository)||void 0===i?void 0:i[e])&&void 0!==n?n:t}getActiveKeyValues(){return this.interpreter.getActiveKeyValues()}getActiveLabradorKeyValues(){return this.interpreter.getActiveLabradorKeyValues()}}var ho;const go=R("[AdEngine] set InstantConfig",{_as:"props",_p:void 0});let mo=class{constructor(e){this.container=e}execute(){return c(this,void 0,void 0,(function*(){var e,t;const{app:i,env:n,platform:s}=window.ads.context,r=null!=s?s:i,o="dev"===n?"https://services.fandom-dev.pl":"https://services.fandom.com",a=`https://script.wikia.nocookie.net/fandom-ae-assets/icbm/${null!=n?n:"prod"}/icbm_state_${r}.json`,d=yield new po(Object.assign({appName:r,instantConfigEndpoint:o,instantConfigFallbackEndpoint:a,instantConfigVariant:O.get("wiki.services_instantConfig_variant"),compact:!0},(null===(t=null===(e=null===window||void 0===window?void 0:window.ads)||void 0===e?void 0:e.context)||void 0===t?void 0:t.warp)?{lockDelay:0}:{})).init();O.set("services.instantConfig.appName",r),this.container.bind(po).value(d),_i.dispatch(go({instantConfig:d}))}))}};mo=a([Rn(),l("design:paramtypes",["function"==typeof(ho=void 0!==jn&&jn)?ho:Object])],mo);const fo=new class{constructor(){O.get("services.externalLogger.threshold")||O.set("services.externalLogger.threshold",1),this.isActive=rs.isOutboundTrafficAllowed("externalLogger")}log(e,t={}){if(!this.isActive)return;const i=O.get("services.externalLogger.endpoint");if(!i)return;const n=new FormData;n.set("message",e),Object.keys(t).forEach((e=>{n.set(e,t[e])}));const s=new XMLHttpRequest;s.open("POST",i,!0),s.send(n)}},vo="IntentIQ",bo=new class{constructor(){this.loaded=!1,this.fandomId=1187275693}preloadScript(){if(!this.isEnabled())return Promise.resolve();if(_i.emit(Ei.PARTNER_LOAD_STATUS,{status:"intentiq_started"}),this.loadPromise)return this.loadPromise;const e=`//script.wikia.nocookie.net/fandom-ae-assets/intentiq/\n\t\t\t${O.get("bidders.prebid.intentIQVersion")}/IIQUniversalID.js`;return this.loadPromise=ls.loadScript(e,!0,"first").then((()=>{this.loaded=!0,Wn(vo,"loaded")})),this.loadPromise}initialize(e){return c(this,void 0,void 0,(function*(){if(this.isEnabled()){if(this.loaded||(yield this.preloadScript(),yield new uo((()=>void 0!==window.IntentIqObject),10,10).until()),!this.intentIqObject){const t=window.location.hostname.includes(".fandom.com")?"fandom.com":window.location.hostname,i=O.get("bidders.prebid.intentIQTimeout"),n={partner:this.fandomId,pbjs:e,timeoutInMillis:i,ABTestingConfigurationSource:"percentage",abPercentage:97,manualWinReportEnabled:!0,domainName:t,vrBrowserBlackList:["chrome"]};return Wn(vo,"config",n),new Promise((e=>{var t,i,s,r;if(!window.IntentIqObject)return Kn(vo,"IntentIqObject not loaded!"),void e();this.intentIqObject=new window.IntentIqObject(Object.assign(Object.assign({},n),{callback:t=>{Wn(vo,"got data",t),e()}}));const o=null!==(r=null===(s=null===(i=null===(t=this.intentIqObject)||void 0===t?void 0:t.intentIqConfig)||void 0===i?void 0:i.abTesting)||void 0===s?void 0:s.currentTestGroup)&&void 0!==r?r:"U";us.set("intent_iq_group",o),_i.emit(Ei.PARTNER_LOAD_STATUS,{status:"intentiq_loaded"}),_i.emit(Ei.INTENT_IQ_GROUP_OBTAINED,{abTestGroup:o})}))}}else Wn(vo,"disabled")}))}reportPrebidWin(e){return c(this,void 0,void 0,(function*(){if(!this.isEnabled()||!this.intentIqObject||Wi.isChromeBrowser())return;const t={biddingPlatformId:1,bidderCode:e.bidderCode,prebidAuctionId:e.auctionId,cpm:e.cpm,currency:e.currency,originalCpm:e.originalCpm,originalCurrency:e.originalCurrency,status:e.status,placementId:e.adUnitCode};Wn(vo,"reporting prebid win",t),this.intentIqObject.reportExternalWin(t),fo.log("intentiq report",{report:JSON.stringify(t)})}))}isEnabled(){return O.get("bidders.prebid.intentIQ")&&O.get("options.trackingOptIn")&&!O.get("options.optOutSale")&&!is()}},yo="not-defined";function So(e,t){const i=O.get(`slots.${e}`);return t&&(null==i?void 0:i.a9Alias)||(null==i?void 0:i.bidderAlias)}function wo(e,t){return So(e,t)||e}function _o(e,t){return 0!==Object.entries(O.get(`slots.${e}`)||{}).length?e:Io(e,t).shift()||""}function Eo(e,t,i){let n=To(e);if(n===yo){const t=Io(e,i).shift();n=t?To(t):n}return n===t}function To(e){return O.get(`slots.${e}.bidGroup`)||yo}function Io(e,t){return Object.entries(Qr.slotConfigsMap).filter((([,i])=>i.bidderAlias===e||t&&i.a9Alias===e)).map((([e])=>e))}class Ao{constructor(e,t,i=2e3){this.name=e,this.bidderConfig=t,this.timeout=i,this.called=!1,this.response=!1,this.logGroup=`${e}-bidder`,this.resetState(),Wn(this.logGroup,"created")}resetState(){this.called=!1,this.response=!1,this.onResponseCallbacks=new ss,this.onResponseCallbacks.onItemFlush((e=>{e(this.name)}))}call(){this.response=!1,this.called=!0,this.callBids((()=>this.onBidResponse())),Wn(this.logGroup,"called")}onBidResponse(){this.response=!0,this.calculatePrices(),this.onResponseCallbacks.flush(),Wn(this.logGroup,"respond")}onNoSlotsError(){this.response=!0,this.onResponseCallbacks.flush()}getSlotBestPrice(e){return this.getBestPrice(e)}getSlotTargetingParams(e){return this.called&&this.isSlotSupported(e)?this.getTargetingParams(e):Promise.resolve({})}isSlotSupported(e){return this.isSupported(e)}waitForResponse(){return fn((e=>{this.hasResponse()?e():this.addResponseListener(e)}),this.timeout)}hasResponse(){return this.response}addResponseListener(e){this.onResponseCallbacks.push(e)}wasCalled(){return this.called}}class Co{constructor(){this.defaultVersion=2}get exists(){return!!window.__tcfapi}getTCData(e){return new Promise((t=>{window.__tcfapi("addEventListener",e||this.defaultVersion,(e=>t(e)))}))}override(e){window.__tcfapi=e}}const Oo=new Co;class Po{get exists(){return!!window.__uspapi}getSignalData(e){return new Promise((t=>{window.__uspapi("getUSPData",e,(e=>t(e)))}))}override(e){window.__uspapi=e}}const ko=new Po,No="universal-storage";class Lo{constructor(){this.storage={}}clear(){this.storage={}}getItem(e){return this.storage[e]}removeItem(e){delete this.storage[e]}setItem(e,t){this.storage[e]=t}}class Ro{constructor(e=(()=>window.localStorage)){this.fallbackStorage=new Lo;try{this.provider=e(),this.isAvailable()||(Wn(No,"StorageProvider doesn't work, fallback to the InMemoryProvider"),this.provider=this.fallbackStorage)}catch(e){Wn(No,"StorageProvider doesn't work, fallback to the InMemoryProvider"),this.provider=this.fallbackStorage}}isAvailable(){try{return this.provider.setItem("ae3-provider-storage-test","1"),this.provider.getItem("ae3-provider-storage-test"),this.provider.removeItem("ae3-provider-storage-test"),!0}catch(e){return!1}}getItem(e,t=!1){try{let i=this.provider.getItem(e);if(t)return i;try{i=JSON.parse(i)}catch(e){return i}return i}catch(t){return this.fallbackStorage.getItem(e)}}setItem(e,t,i){const n=t instanceof Object?JSON.stringify(t):t;try{this.provider.setItem(e,n,i)}catch(t){Wn(No,`Item ${e} wasn't set in the storage`,t),this.fallbackStorage.setItem(e,n)}return!0}removeItem(e){try{return this.provider.removeItem(e)}catch(t){this.fallbackStorage.removeItem(e)}}clear(){try{this.provider.clear()}catch(e){this.fallbackStorage.clear()}}}const Do="a9-apstag";class xo{static make(){return xo.instance||xo.reset(),xo.instance}static reset(){return xo.instance=new xo,xo.instance}constructor(){this.renderImpEndCallbacks=[],this.utils=e,this.tcf=Oo,this.usp=ko,this.storage=new Ro,this.insertScript(),this.configure(),this.addRenderImpHook()}insertScript(){this.script=ms.loadScriptWithStatus("//c.amazon-adsystem.com/aax2/apstag.js",Do,!0,"first")}hasRecord(){return!!this.storage.getItem("apstagRecord")}getRecord(){return this.storage.getItem("apstagRecord")}sendMediaWikiHEM(){const e=O.get("wiki.opts.userEmailHashes");if(!Array.isArray(e)||3!==(null==e?void 0:e.length))return;const t=e[2];this.sendHEM(t)}sendHEM(e,t){return c(this,void 0,void 0,(function*(){if(e){if(!O.get("bidders.a9.hem.cleanup")&&O.get("bidders.a9.hem.enabled"))try{yield this.script;const i=!js.isOptedIn(null==t?void 0:t.gdprConsent)||js.isOptOutSale(null==t?void 0:t.ccpaSignal),n=i?"1":"0",s=!!this.storage.getItem("apstagHEMsent",!0),r=s&&this.storage.getItem("apstagHEMsent",!0)<Date.now().toString(),o=this.storage.getItem("apstagHEMoptOut",!0)&&n!==this.storage.getItem("apstagHEMoptOut",!0),a=js.isGdprConsentRequired()?{gdpr:{enabled:!0,consent:(yield this.tcf.getTCData()).tcString}}:{},d=Object.assign({hashedRecords:[{type:"email",record:e}],optOut:i},a);o?(Wn(Do,"Updating user consents",d,"optOut",i),window.apstag.upa(d)):s&&!r||(Wn(Do,"Sending HEM to apstag",d,"optOut",i),window.apstag.rpa(d)),this.storage.setItem("apstagRecord",e),this.storage.setItem("apstagHEMsent",(Date.now()+xo.AMAZON_TOKEN_TTL).toString()),this.storage.setItem("apstagHEMoptOut",n),_i.emit(hr)}catch(e){Wn(Do,"Error sending HEM to apstag",e)}}else Kn(Do,"Trying to send HEM without source record")}))}configure(){window.apstag=window.apstag||{_Q:[]},void 0===window.apstag.init&&(window.apstag.init=(...e)=>{this.configureCommand("i",e)}),void 0===window.apstag.fetchBids&&(window.apstag.fetchBids=(...e)=>{this.configureCommand("f",e)})}addRenderImpHook(){return c(this,void 0,void 0,(function*(){yield this.script;const e=window.apstag.renderImp;window.apstag.renderImp=(...t)=>{e(...t);const[i,n]=t;this.renderImpEndCallbacks.forEach((e=>e(i,n)))}}))}configureCommand(e,t){window.apstag._Q.push([e,t])}init(){return c(this,void 0,void 0,(function*(){let e=null;this.usp.exists&&(e=yield this.usp.getSignalData());const t=this.getApstagConfig(e);if(yield this.script,window.apstag.init(t),O.get("bidders.a9.hem.cleanup")){if(v.get("AMZN-Token")||this.storage.getItem("apstagRecord"))return Wn(Do,"Cleaning Amazon Token..."),window.apstag.dpa(),this.storage.removeItem("apstagRecord"),this.storage.removeItem("apstagHEMsent"),this.storage.removeItem("apstagHEMoptOut"),void v.remove("AMZN-Token",{path:"/"});Wn(Do,"Amazon Token already cleaned")}this.hasRecord()&&this.sendHEM(this.getRecord()),this.sendMediaWikiHEM()}))}fetchBids(e){return c(this,void 0,void 0,(function*(){return yield this.script,js.isGdprConsentRequired()&&(yield this.tcf.getTCData()),new Promise((t=>{window.apstag.fetchBids(e,(e=>t(e)))}))}))}targetingKeys(){return c(this,void 0,void 0,(function*(){return yield this.script,window.apstag.targetingKeys()}))}enableDebug(){return c(this,void 0,void 0,(function*(){yield this.script,window.apstag.debug("enable")}))}disableDebug(){return c(this,void 0,void 0,(function*(){yield this.script,window.apstag.debug("disable")}))}onRenderImpEnd(e){return c(this,void 0,void 0,(function*(){if("function"!=typeof e)throw new Error("onRenderImpEnd used with callback not being a function");this.renderImpEndCallbacks.push(e)}))}getApstagConfig(e){var t;const i=O.get("bidders.a9.amazonId"),n=null!==(t=us.get("openrtb2","openrtb2"))&&void 0!==t?t:{};return fo.log("openrtb2 signals",{signals:JSON.stringify(n)}),Object.assign(Object.assign({pubID:i,videoAdServer:"DFP",deals:!0,gdpr:{cmpTimeout:2e3}},xo.getCcpaIfApplicable(e)),{signals:{ortb2:n}})}static getCcpaIfApplicable(e){return e&&e.uspString?{params:{us_privacy:e.uspString}}:{}}}xo.AMAZON_TOKEN_TTL=12096e5;const zo="A9Provider";class Vo extends Ao{static mapResponseToTrackingBidDefinition(e,t,i,n){return{responseTimestamp:i,timeToRespond:n,bidderName:"a9",buyerId:t.amznp,price:t.amznbid,size:t.amznsz,slotName:_o(e,!0),additionalInfo:void 0}}static isEnabled(){return O.get("bidders.a9.enabled")&&!is()}static initApstag(){xo.make()}constructor(e,t=2e3,i=yo){super("a9",e,t),this.bidderConfig=e,this.timeout=t,this.bidGroup=i,this.loaded=!1,this.apstag=xo.make(),this.bids={},this.priceMap={},this.targetingKeys=[],this.amazonId=this.bidderConfig.amazonId,this.slots=this.bidderConfig.slots,this.slotsNames=Object.keys(this.slots),this.bidsRefreshing=O.get("bidders.a9.bidsRefreshing")||{},_i.on(Sr,(({adSlot:e})=>{const t=e.getSlotName();this.setMaximumAdSlotHeight(t)}),!1),_i.on(Ei.MOBILE_MORE_ICB_EXPERIMENT,(()=>{O.remove("bidders.a9.slots.mobile_top_leaderboard")}),!1)}getTargetingKeys(){return this.targetingKeys}initIfNotLoaded(){return c(this,void 0,void 0,(function*(){if(!this.loaded){O.get("custom.hasFeaturedVideo")&&(_i.onSlotEvent(bs.VIDEO_AD_IMPRESSION,(({slot:e})=>this.removeBids(e))),_i.onSlotEvent(bs.VIDEO_AD_ERROR,(({slot:e})=>this.removeBids(e))),_i.on(yi,(({slot:e})=>this.invalidateSlotTargeting(e)),!1)),yield this.apstag.init();const e=Ki((e=>{const t=this.apstag.getRecord();t&&this.apstag.sendHEM(t,e)}),500);_i.on(ws,e,!1),_i.on(Ss,e,!0),js.isOptedIn()&&!js.isOptOutSale()||(Wn(zo,"A9 was initialized without consents"),_i.emit(pr)),this.loaded=!0}}))}removeBids(e){const t=wo(e.getSlotName(),!0);delete this.bids[t],e.isVideo()&&e.emit(bs.VIDEO_AD_USED)}invalidateSlotTargeting(e){if(Date.parse(us.get("amznExpirationDate",e.getSlotName()))<(new Date).getTime()){const t=wo(e.getSlotName(),!0);delete this.bids[t],this.targetingKeys.forEach((t=>{us.remove(t,e.getSlotName())}))}}getA9SlotsDefinitions(e){return e.filter((e=>Eo(e,this.bidGroup,!0))).map((e=>wo(e,!0))).filter((e=>this.isSlotEnabled(e))).map((e=>this.createSlotDefinition(e))).filter((e=>null!==e))}filterBidSizes(e,t){const i=Object.keys(t),n=e.filter((e=>{var n;if(!i.includes(e.slotID))return!0;const s=e.size.split("x"),r=parseInt(s[1],10),o=null===(n=t[e.slotID])||void 0===n?void 0:n[1];return void 0===o||r<=o}));return n}fetchBids(e){return c(this,arguments,void 0,(function*(e,t=!1){if(Wn(zo,"fetching bids for slots",e),!e||0===e.length)return Wn(zo,"there is no slots to fetch bids"),void this.onNoSlotsError();const i=(new Date).getTime(),n=yield this.apstag.fetchBids({slots:e,timeout:this.timeout});let s;const r=O.get("slotConfig.slotRefresher.sizes");r&&(s=this.filterBidSizes(n,r));const o=r?s:n,a=(new Date).getTime(),d=new Date(a+Vo.VIDEO_TTL);if(Wn(zo,"bids fetched for slots",e,"bids",n),this.configureApstagOnce(),yield Promise.all(o.map((e=>c(this,void 0,void 0,(function*(){const t=e.slotID,{keys:n,bidTargeting:s}=yield this.getBidTargetingWithKeys(e);this.updateBidSlot(t,n,s,d),_i.emit(vr,{bidResponse:Vo.mapResponseToTrackingBidDefinition(e.slotID,s,a,a-i)})}))))),this.onBidResponse(),t){const t=e.map((e=>e.slotName));_i.emit(fr,{refreshedSlotNames:t})}}))}configureApstagOnce(){Vo.isApstagConfigured||(Vo.isApstagConfigured=!0,this.addApstagRenderImpHook(),this.registerVideoBidsRefreshing())}addApstagRenderImpHook(){Wn(zo,"overwriting window.apstag.renderImp"),this.apstag.onRenderImpEnd(((e,t)=>{if(!t)return void Wn(zo,"apstag.renderImp() called with 1 argument only");const i=this.getRenderedSlot(t),n=i.getSlotName();i.addClass(Vo.A9_CLASS),Wn(zo,`bid used for slot ${n}`),delete this.bids[wo(n,!0)],this.refreshBid(i),i.updateWinningA9BidderDetails()}))}getRenderedSlot(e){return Object.values(Qr.slots).filter((t=>t.getTargeting().amzniid===e))[0]}refreshBid(e){if(!this.shouldRefreshSlot(e))return;const t=this.createSlotDefinition(wo(e.getSlotName(),!0));t&&(Wn(zo,"refresh bids for slot",t),this.fetchBids([t],!0))}shouldRefreshSlot(e){return this.bidsRefreshing.slots.includes(wo(e.getSlotName(),!0))}createSlotDefinition(e){const t=this.slots[e],i={slotName:e,slotID:e};return!t||!this.bidderConfig.videoEnabled&&"video"===t.type?null:("video"===t.type?i.mediaType="video":i.sizes=t.sizes,i)}registerVideoBidsRefreshing(){_i.onSlotEvent(bs.VIDEO_AD_IMPRESSION,(({slot:e})=>this.refreshVideoBids(e))),_i.onSlotEvent(bs.VIDEO_AD_ERROR,(({slot:e})=>this.refreshVideoBids(e)))}refreshVideoBids(e){this.shouldRefreshSlot(e)&&(this.removeBids(e),this.refreshBid(e))}getBidTargetingWithKeys(e){return c(this,void 0,void 0,(function*(){return yield this.apstag.targetingKeys(),{keys:e.helpers.targetingKeys,bidTargeting:e.targeting}}))}updateBidSlot(e,t,i,n){this.bids[e]={},t.forEach((t=>{-1===this.targetingKeys.indexOf(t)&&this.targetingKeys.push(t),this.bids[e][t]=i[t]})),O.get(`slots.${e}.isVideo`)&&(this.bids[e].amznExpirationDate=n.toString(),this.targetingKeys.push("amznExpirationDate"))}callBids(){this.bids={},this.priceMap={};const e=this.getA9SlotsDefinitions(this.slotsNames);this.initIfNotLoaded().then((()=>this.fetchBids(e)))}calculatePrices(){Object.keys(this.bids).forEach((e=>{this.priceMap[e]=this.bids[e].amznbid}))}getBestPrice(e){return c(this,void 0,void 0,(function*(){const t=wo(e,!0);return this.priceMap[t]?{a9:this.priceMap[t]}:{}}))}getTargetingParams(e){return c(this,void 0,void 0,(function*(){return this.bids[wo(e,!0)]||{}}))}isSupported(e){return!!this.slots[wo(e,!0)]}isSlotEnabled(e){const t=Object.keys(O.get("slots")).some((t=>So(t,!0)===e&&Qr.getState(t))),i=O.get(`slots.${e}`);return i&&Object.keys(i).length>0?Qr.getState(e):t}setMaximumAdSlotHeight(e){const t=O.get("slotConfig.slotRefresher.sizes");if(!t)return;const i=t[e][1];if(!i)return;const n=O.get(`bidders.a9.slots.${e}.sizes`);(null==n?void 0:n.length)&&O.set(`bidders.a9.slots.${e}.sizes`,n.filter((e=>e[1]<=i)))}}var Mo,Uo;Vo.A9_CLASS="a9-ad",Vo.VIDEO_TTL=6e5,Vo.isApstagConfigured=!1;let jo=class{constructor(e=null,t=null){this.instantConfig=e,this.globalTimeout=t,this.resetInitialized()}isEnabled(e,t=!0){const i="string"==typeof e&&e.startsWith("ic")?this.instantConfig.get(e):this.getContextVariablesValue(e);return t?i&&O.get("options.trackingOptIn")&&!O.get("options.optOutSale")&&!is():i}setOptions(e){return this.options=e,this}setInitialized(){this.resolve()}resetInitialized(){this.initialized=new Promise((e=>{this.resolve=e}))}call(){}execute(){return c(this,void 0,void 0,(function*(){var e;this.initializationTimeout=this.getTimeoutPromise(),this.initializationTimeout.then((()=>{this.setInitialized(),this.initialized||Wn("base-service-setup","timeout reached")})),(null===(e=this.options)||void 0===e?void 0:e.dependencies)&&(yield Promise.all(this.options.dependencies)),yield this.call(),this.setInitialized()}))}getContextVariablesValue(e){return"string"==typeof e?O.get(e):e.map((e=>O.get(e))).reduce(((e,t)=>e&&t),!0)}getTimeoutPromise(){var e;return(null===(e=this.options)||void 0===e?void 0:e.timeout)?new Promise((e=>{setTimeout(e,this.options.timeout)})):new uo((()=>!!this.globalTimeout)).until().then((()=>{var e,t,i;return null!==(i=null===(t=null===(e=this.globalTimeout)||void 0===e?void 0:e.get)||void 0===t?void 0:t.call(e,"partner-pipeline"))&&void 0!==i?i:Promise.resolve()}))}};jo=a([Rn(),l("design:paramtypes",["function"==typeof(Mo=void 0!==po&&po)?Mo:Object,"function"==typeof(Uo=void 0!==Yn&&Yn)?Uo:Object])],jo);const Bo="audigent",$o=()=>void 0!==window.au_seg;window.au=window.au||[];class Fo extends jo{constructor(){super(...arguments),this.isLoaded=!1}static loadSegmentLibrary(){Fo.segmentsScriptLoader=ls.loadScript("https://seg.ad.gt/api/v1/s/158",!0,"first").then((()=>{_i.emit(Ei.PARTNER_LOAD_STATUS,{status:"audigent_segment_library_loaded"})}))}loadMatchesLibrary(){this.matchesTagScriptLoader=ls.loadScript("https://a.ad.gt/api/v1/u/matches/158",!0,"first").then((()=>{_i.emit(Ei.PARTNER_LOAD_STATUS,{status:"audigent_matches_library_loaded"})}))}call(){return c(this,void 0,void 0,(function*(){this.isEnabled("icAudigent")?(us.set("AU_SEG","-1"),Fo.sampling=this.instantConfig.get("icAudigentTrackingSampling"),Fo.segmentLimit=this.instantConfig.get("icAudigentSegmentLimit"),!Fo.segmentsScriptLoader&&Fo.loadSegmentLibrary(),!this.matchesTagScriptLoader&&this.loadMatchesLibrary(),this.setupSegmentsListener(),this.isLoaded||(Wn(Bo,"loading..."),this.matchesTagScriptLoader.then((()=>{Wn(Bo,"audience tag script loaded")})),Fo.segmentsScriptLoader.then((()=>{Wn(Bo,"segment tag script loaded"),this.setup()})),this.isLoaded=!0),yield this.waitForAuSegGlobalSet().then((e=>{Wn(Bo,"Audigent global variable set",e,window.au_seg),this.setup()}))):Wn(Bo,"disabled")}))}setup(){$o()&&Fo.sliceAndSetSegmentsInTargeting()}setupSegmentsListener(){Wn(Bo,"setting up auSegReady event listener"),document.addEventListener("auSegReady",(function(e){Wn(Bo,"auSegReady event received",e),_i.emit(Ei.PARTNER_LOAD_STATUS,{status:"audigent_segments_ready"}),Fo.sliceAndSetSegmentsInTargeting()}))}static sliceAndSetSegmentsInTargeting(){const e=Fo.sliceSegments();Fo.trackWithExternalLoggerIfEnabled(e),Fo.setSegmentsInTargeting(e)}resetLoadedState(){this.isLoaded=!1,this.matchesTagScriptLoader=null,Fo.segmentsScriptLoader=null}static sliceSegments(){const e=window.au_seg.segments||[],t=Fo.segmentLimit||0;let i=e.length?e:"no_segments";return Fo.canSliceSegments(i,t)&&(i=i.slice(0,t)),Wn(Bo,"Sliced segments",i,t,e),i}static setSegmentsInTargeting(e){Wn(Bo,"Setting segments in the targeting",e),us.set("AU_SEG",e)}static canSliceSegments(e,t){return t>0&&"string"!=typeof e}static trackWithExternalLoggerIfEnabled(e){const t=100*Math.random(),i=Fo.sampling||0;i>0&&t<=i&&"string"!=typeof e&&fo.log("Audigent segments",{segmentsNo:e.length,segments:e})}waitForAuSegGlobalSet(e=5){const t=O.get("services.audigent.numberOfTries")||e;return new uo($o,t,250).until()}}class Ho extends jo{constructor(){super(...arguments),this.options={timeout:1e4}}call(){var e,t;if(null===(e=window.fandomPerf)||void 0===e?void 0:e.preloadGPT)return null===(t=window.fandomPerf)||void 0===t?void 0:t.preloadGPT.then((()=>{Wn("gpt-provider","ready"),_i.emit(_s,{time:Gn()})}));if(!this.loadPromise){Wn("gpt-provider","loading GPT...");const e=`https://securepubads.g.doubleclick.net/tag/js/gpt.js?network-code=${O.get("custom.dfpId")}`;this.loadPromise=ls.loadScript(e).then((()=>{Wn("gpt-provider","ready"),_i.emit(_s,{time:Gn()})}))}return this.loadPromise}}var Go,qo;const Wo="//static.wikia.nocookie.net/fandom-ae-assets/prebid.js/",Ko=new RegExp(`^(${Wo.replaceAll(".","\\.")})?[^/]+/((dev|prod)/)?([^/]+/)?[^/]+$`);let Yo=class{constructor(e,t){this.instantConfig=e,this.gptSetup=t,this.options=O.get("options.preload")}execute(){return c(this,void 0,void 0,(function*(){var e;return O.set("bidders.prebid.libraryUrl",this.getPrebidLibraryUrl()),this.preloadLibraries(),(null===(e=this.options)||void 0===e?void 0:e.gpt)?this.gptSetup.call():Promise.resolve()}))}preloadLibraries(){var e,t,i;(null===(e=this.options)||void 0===e?void 0:e.prebid)&&this.instantConfig.get("icPrebid")&&Mr.init().then((()=>{var e;if((null===(e=this.options)||void 0===e?void 0:e.intentIq)&&this.instantConfig.get("icPrebidIntentIQ"))return bo.preloadScript()})),(null===(t=this.options)||void 0===t?void 0:t.apstag)&&this.instantConfig.get("icA9Bidder")&&Vo.initApstag(),(null===(i=this.options)||void 0===i?void 0:i.audigent)&&this.instantConfig.get("icAudigent")&&Fo.loadSegmentLibrary()}getPrebidLibraryUrl(){let e=this.instantConfig.get("icPrebidVersion","latest/min.js");return Ko.test(e)||(e="latest/min.js"),e.startsWith(Wo)||(e=Wo+e),e.replaceAll("..","")}};Yo=a([Rn(),l("design:paramtypes",["function"==typeof(Go=void 0!==po&&po)?Go:Object,"function"==typeof(qo=void 0!==Ho&&Ho)?qo:Object])],Yo);const Qo="tracking-opt-in-wrapper";let Jo=class{constructor(){window.ads=window.ads||{},this.installConsentQueue()}execute(){return c(this,void 0,void 0,(function*(){return new Promise((e=>{Wn(Qo,"Waiting for consents"),_i.on(Ss,(t=>{this.setConsents(t),e()})),_i.on(ws,this.setConsents)}))}))}setConsents(e){Wn(Qo,"TrackingOptIn consents",e),O.set("options.trackingOptIn",e.gdprConsent),O.set("options.geoRequiresConsent",e.geoRequiresConsent),O.set("options.optOutSale",e.ccpaSignal),O.set("options.geoRequiresSignal",e.geoRequiresSignal)}installConsentQueue(){window.ads.consentQueue=new ss(...window.ads.consentQueue||[]),window.ads.pushToConsentQueue=window.ads.pushToConsentQueue||(e=>{window.ads.consentQueue.push(e)}),_i.on(Ss,(e=>{window.ads.consentQueue.onItemFlush((t=>{console.warn('[AdEngine] You are using deprecated API to get consent.\nPlease use PostQuecast action "[AdEngine OptIn] set opt in" instead.'),t(e)})),window.ads.consentQueue.flush()}))}};Jo=a([Rn(),l("design:paramtypes",[])],Jo);const Xo={AD_ENG_LOAD_TIMES:{name:"AdEngLoadTimes",icbmName:"loadTimes",url:"https://beacon.wikia-services.com/__track/special/adengloadtimes",allowed:{sampling:!0,aggregation:!0,aggregationLimit:5}},AD_ENG_BIDDERS:{name:"AdEngBidders",icbmName:"bidders",url:"https://beacon.wikia-services.com/__track/special/adengbidders",allowed:{sampling:!1,aggregation:!1}},AD_ENG_VIEWABILITY:{name:"AdEngViewability",icbmName:"viewability",url:"https://beacon.wikia-services.com/__track/special/adengviewability",allowed:{sampling:!1,aggregation:!1}},AD_ENG_PLAYER_INFO:{name:"AdEngPlayerInfo",icbmName:"playerInfo",url:"https://beacon.wikia-services.com/__track/special/adengplayerinfo",allowed:{sampling:!1,aggregation:!1}},KEY_VALS:{name:"KeyVals",icbmName:"kvs",url:"https://beacon.wikia-services.com/__track/special/keyvals",allowed:{sampling:!1,aggregation:!1}},TOPICS:{name:"GoogleTopics",icbmName:"topics",url:"https://beacon.wikia-services.com/__track/special/topics",allowed:{sampling:!1,aggregation:!1}},AD_ENG_AD_SIZE_INFO:{name:"AdEngAdSizeInfo",icbmName:"adSizeInfo",url:"https://beacon.wikia-services.com/__track/special/adengadsizeinfo",allowed:{sampling:!1,aggregation:!1}},AD_ENG_LABRADOR_INFO:{name:"AdEngLabradorInfo",icbmName:"labrador",url:"https://beacon.wikia-services.com/__track/special/adenglabradorinfo",allowed:{sampling:!1,aggregation:!1}},AD_ENG_DEV_LABRADOR_INFO:{name:"AdEngDevLabradorInfo",icbmName:"labradorDev",url:"https://beacon.wikia-services.com/__track/special/adengdevlabradorinfo",allowed:{sampling:!1,aggregation:!1}},AD_ENG_AD_INFO:{name:"AdEngAdInfo",icbmName:"adInfo",url:"https://beacon.wikia-services.com/__track/special/adengadinfo",allowed:{sampling:!1,aggregation:!1}},IDENTITY_INFO:{name:"IdentityInfo",icbmName:"idInfo",url:"https://beacon.wikia-services.com/__track/special/identityinfo",allowed:{sampling:!1,aggregation:!1}},TRACKING_EVENT:{name:"TrackingEvent",icbmName:"trackingEvent",url:"https://beacon.wikia-services.com/__track/special/trackingevent",allowed:{sampling:!1,aggregation:!1}},VIDEO_PLAYER_EVENT:{name:"VideoPlayerEvent",icbmName:"videoPlayerEvent",url:"https://beacon.wikia-services.com/__track/special/videoplayerevent",allowed:{sampling:!1,aggregation:!1}}};var Zo;let ea=class{constructor(e){this.instantConfig=e}execute(){return c(this,void 0,void 0,(function*(){var e,t;yield this.setTrackingParameters(),O.set("services.dw-tracker.compression",this.instantConfig.get("dwTrafficCompression",!1)),Object.values(Xo).forEach((e=>{var t,i;const n=e.name.toLowerCase();e.allowed.sampling&&O.set(`services.dw-tracker-${n}.threshold`,null===(t=this.instantConfig.get("dwTrafficLimits",{})[e.icbmName])||void 0===t?void 0:t.sample),O.set(`services.dw-tracker-${n}.aggregate`,!!e.allowed.aggregation&&(null===(i=this.instantConfig.get("dwTrafficLimits",{})[e.icbmName])||void 0===i?void 0:i.agg))})),(null===(t=null===(e=window.ads)||void 0===e?void 0:e.version)||void 0===t?void 0:t.ae)&&us.set("aeVer",window.ads.version.ae)}))}getTrackingParameters(){return c(this,void 0,void 0,(function*(){return yield new uo((()=>{var e;return!!(null===(e=window.fandomContext)||void 0===e?void 0:e.tracking)}),10,100).until(),Object.assign({},window.fandomContext.tracking)}))}setTrackingParameters(){return c(this,void 0,void 0,(function*(){const e=yield this.getTrackingParameters();O.set("wiki",Object.assign(Object.assign({},O.get("wiki")),e))}))}};ea=a([Rn(),l("design:paramtypes",["function"==typeof(Zo=void 0!==po&&po)?Zo:Object])],ea);const ta=new class{constructor(e=!1){this.isActive=e}activate(){this.isActive=!0}sendToMeteringSystem(e){if(!this.isActive)return;const t=this.getEndpointInfoFromContext(),i=this.getEndpointUrlFor("time",t),n=[];Object.entries(e).forEach((([e,t])=>{n.push(`${e}=${encodeURIComponent(t)}`)})),(new un).fetch(`${i}?app=${t.appName}&${n.join("&")}`,2e3,{mode:"no-cors"})}getEndpointInfoFromContext(){return{baseUrl:O.get("services.monitoring.endpoint"),service:O.get("services.monitoring.service"),appName:O.get("services.instantConfig.appName")}}getEndpointUrlFor(e,{baseUrl:t,service:i}){return[t,i,"api","adengine","meter",e].filter((e=>!!e)).join("/")}},ia={stateMetric:["top_leaderboard"],timingMetric:["top_leaderboard"],reportedGamSlotRequests:[],reportedGamSlotRenders:[]};class na{constructor(e){this.sender=e,this.isActive=rs.isOutboundTrafficAllowed("monitoring-default")}initialise(){this.isActive&&(this.trackLibInitialization(),this.trackGptLibReady(),this.trackGamSlotRequest(),this.trackGamSlotRendered())}trackLibInitialization(){this.sender.sendToMeteringSystem({action:"init",duration:Math.round(Gn())})}trackGptLibReady(){_i.on(_s,(()=>{this.sender.sendToMeteringSystem({action:"gpt-ready",duration:Math.round(Gn())})}))}trackGamSlotRequest(){_i.onSlotEvent(bs.SLOT_REQUESTED_EVENT,(({slot:e})=>{ia.reportedGamSlotRequests.includes(e.getSlotName())||(this.sendSlotInfoToMeteringSystem(e,"request"),ia.reportedGamSlotRequests.push(e.getSlotName()))}))}trackGamSlotRendered(){_i.onSlotEvent(bs.SLOT_RENDERED_EVENT,(({slot:e})=>{ia.reportedGamSlotRenders.includes(e.getSlotName())||(this.sendSlotInfoToMeteringSystem(e,"render"),ia.reportedGamSlotRenders.push(e.getSlotName()))}))}sendSlotInfoToMeteringSystem(e,t){if(!ia.stateMetric.includes(e.getSlotName()))return;this.sender.sendToMeteringSystem({action:`${t}_${e.getSlotName()}`,duration:Math.round(Gn())});const i=O.get("wiki").targeting.wikiDbName;["plpankleks","kiepscy","prisonbreak","harrypotter"].includes(i)&&this.sender.sendToMeteringSystem({action:`${i}_${t}_${e.getSlotName()}`,duration:Math.round(Gn())})}}var sa;let ra=class{constructor(e){this.instantConfig=e}execute(){return c(this,void 0,void 0,(function*(){const e=cs()||"";O.set("services.monitoring.endpoint",e.replace(/\/+$/,"")),O.set("services.monitoring.service","adeng");const t=this.instantConfig.get("icMonitorTrafficThreshold",{default:0}),i="number"==typeof t?{default:t}:t;Object.keys(i).forEach((e=>{O.set(`services.monitoring-${e}.threshold`,i[e])})),rs.isOutboundTrafficAllowed("monitoring-default")&&ta.activate(),new na(ta).initialise()}))}};ra=a([Rn(),l("design:paramtypes",["function"==typeof(sa=void 0!==po&&po)?sa:Object])],ra);class oa{constructor(e,t,i){this.tasksList=e,this.batchSize=t,this.delay=i,this.batchedTasks=[],this.batchTasks()}batchTasks(){this.batchedTasks=[...this.tasksList].reduce(((e,t,i)=>{const n=Math.floor(i/this.batchSize);return e[n]||(e[n]=[]),e[n].push(t),e}),[])}dispatchEventsWithTimeout(e){const t=setInterval((()=>{this.batchedTasks.length<=0?clearInterval(t):this.batchedTasks.shift().forEach((t=>e(t)))}),this.delay)}}class aa{constructor(){this.contentEncoding="gzip"}compressionSupported(){return void 0!==this.browserSupportsCompression||(this.browserSupportsCompression="function"==typeof En("CompressionStream")&&"function"==typeof En("TextEncoder"),this.browserSupportsCompression||Wn("dw_gzip_compressor_debug","DwAggregatedDataGzipCompressor","Compression API not supported")),this.browserSupportsCompression}compress(e){return c(this,void 0,void 0,(function*(){try{if(!this.compressionSupported())return{compressed:e};const t=this.buildStream(e),i=this.gzipStream(t),n=yield this.readStream(i);return Wn("dw_gzip_compressor_debug","DwAggregatedDataGzipCompressor",{uncompressedStringLen:e.length,compressedBytesLen:n.byteLength}),{compressed:n,contentEncoding:this.contentEncoding}}catch(t){return Wn("dw_gzip_compressor_debug","DwAggregatedDataGzipCompressor","Error while compressing data, returning uncompressed data instead.",{error:t}),{compressed:e}}}))}buildStream(e){const t=(new TextEncoder).encode(e);return new ReadableStream({start(e){e.enqueue(t),e.close()}})}gzipStream(e){return e.pipeThrough(new CompressionStream("gzip"))}readStream(e){return c(this,void 0,void 0,(function*(){const t=[],i=e.getReader();let n;for(;!n;){const{done:e,value:s}=yield i.read();e||t.push(s),n=e}const s=new Uint8Array(t.reduce(((e,t)=>e+t.byteLength),0));let r=0;for(const e of t)s.set(new Uint8Array(e.buffer),r),r+=e.byteLength;return s}))}}const da="dw-track-sender";class la{constructor(e=new aa){this.dataCompressor=e}sendTrackData(e,t){const i=`${e}_v2`;this.isCompressionEnabled()?this.dataCompressor.compress(JSON.stringify(t)).then((e=>{this.sendRequest(i+e.contentEncoding||"",e.compressed)})):this.sendRequest(i,JSON.stringify(t))}isCompressionEnabled(){return O.get("services.dw-tracker.compression")&&this.dataCompressor.compressionSupported()}sendRequest(e,t){fetch(e,{method:"POST",body:t}).then((t=>{200===t.status?Wn(da,{status:"success",url:e}):Wn(da,{status:"failed",url:e})}))}}const ca=new class{constructor(){this.AGGREGATION_SECONDS_OFF=5,this.SEND_DATA_INTERVAL=1e3,this.AGGREGATION_LIMIT_PER_TRACK=5,this.sender=new la,this.tracksQueues={},this.enabled=!0,this.count=0,this.start()}isAggregatorActive(){return this.enabled}push(e,t){this.tracksQueues[e.name]||(this.tracksQueues[e.name]={track:e,params:[]}),this.tracksQueues[e.name].params.push(t),this.tracksQueues[e.name].params.length>=this.getAggregationLimit(e)&&this.fireAggregatedQueueByTrack(e)}getAggregationLimit(e){var t;return null!==(t=e.allowed.aggregationLimit)&&void 0!==t?t:this.AGGREGATION_LIMIT_PER_TRACK}fireAggregatedQueue(){Object.keys(this.tracksQueues).forEach((e=>{this.fireAggregatedQueueByTrack(this.tracksQueues[e].track)}))}fireAggregatedQueueByTrack(e){var t,i;const n=[];null===(i=null===(t=this.tracksQueues[e.name])||void 0===t?void 0:t.params)||void 0===i||i.forEach((e=>n.push(e))),0!==n.length&&(this.sender.sendTrackData(this.tracksQueues[e.name].track.url,n),this.tracksQueues[e.name]={track:e,params:[]})}start(){const e=setInterval((()=>{this.fireAggregatedQueue(),this.count++,this.count>=this.AGGREGATION_SECONDS_OFF&&(this.enabled=!1,clearInterval(e))}),this.SEND_DATA_INTERVAL);window.addEventListener("visibilitychange",(()=>{document.hidden&&this.fireAggregatedQueue()}))}},ua=Xo.TRACKING_EVENT.url,pa=Xo.VIDEO_PLAYER_EVENT.url;let ha=class{constructor(){this.eventsArray=[],this.init()}init(){O.get("options.delayEvents.enabled")&&document.addEventListener("readystatechange",(()=>{"complete"===document.readyState&&this.dispatchAndEmptyEventArray()}))}track(e,t){if(t&&!rs.isOutboundTrafficAllowed(`dw-tracker-${t.name.toLowerCase()}`))return;const i=Object.assign(Object.assign({},this.getDataWarehouseParams()),e);t?this.sendCustomEvent(i,t):this.sendTrackEvent(i)}getDataWarehouseParams(){return{session_id:O.get("wiki.sessionId")||"unknown",pv_number:O.get("wiki.pvNumber"),pv_number_global:O.get("wiki.pvNumberGlobal"),pv_unique_id:O.get("wiki.pvUID"),beacon:O.get("wiki.beaconId")||"unknown",c:O.get("wiki.wgCityId")||"unknown",ck:O.get("wiki.dsSiteKey")||"unknown",lc:O.get("wiki.wgUserLanguage")||"unknown",s:us.get("skin")||"unknown",ua:window.navigator.userAgent,u:js.isOptedIn()?O.get("options.userId")||0:-1,a:parseInt(us.get("artid")||-1),x:O.get("wiki.wgDBname")||"unknown",n:O.get("wiki.wgNamespaceNumber")||-1}}sendCustomEvent(e,t){const i=Object.assign(Object.assign({},e),this.getTimeBasedParams());O.get(`services.dw-tracker-${t.name.toLowerCase()}.aggregate`)&&ca.isAggregatorActive()&&ca.push(t,i);const n=this.buildDataWarehouseUrl(i,t.url);this.handleDwEvent(n,i)}sendTrackEvent(e,t="Event"){const i=Object.assign(Object.assign({},e),this.getTimeBasedParams());i.ga_category=i.category||"",i.ga_label=i.label||"",i.ga_action=i.action||"",i.ga_value=i.value||"",delete i.category,delete i.label,delete i.action,delete i.value;let n=this.buildDataWarehouseUrl(i,ua);this.handleDwEvent(n,i,t),"videoplayerevent"===i.eventName&&(n=this.buildDataWarehouseUrl(i,pa),this.handleDwEvent(n,i,t))}dispatchAndEmptyEventArray(){const{batchSize:e,delay:t}=O.get("options.delayEvents");new oa(this.eventsArray,e,t).dispatchEventsWithTimeout(this.sendRequest),this.eventsArray=[]}getTimeBasedParams(){return{cb:Math.floor(99999*Math.random()),url:document.URL}}buildDataWarehouseUrl(e,t){if(!t){const e="Error building DW tracking URL";throw Wn("data-warehouse-trackingParams",e),new Error(e)}return`${t}?${y.stringify(e)}`}handleDwEvent(e,t,i="Event"){const n={url:e,params:t,type:i};O.get("options.delayEvents.enabled")?this.afterDocumentCompleted().then((()=>{this.sendRequest(n)})).catch((()=>{this.eventsArray.push(n)})):this.sendRequest(n)}sendRequest({url:e,params:t,type:i="Event"}){const n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="json",n.addEventListener("load",(()=>Wn(`DW - Track ${i} Success`,{url:e,params:t}))),n.addEventListener("error",(n=>Wn(`DW - Track ${i} Failed`,{url:e,params:t,err:n}))),n.send()}afterDocumentCompleted(){return c(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{"complete"===document.readyState?e():t()}))}))}};ha=a([Rn(),l("design:paramtypes",[])],ha);const ga={ad_engine_configured:{name:"Configured"},ad_engine_stack_start:As,prebid_auction_started:mr,prebid_auction_ended:br,live_connect_cached:Ei.LIVE_CONNECT_CACHED,live_connect_started:Ei.LIVE_CONNECT_STARTED,live_connect_responded_uuid:Ei.LIVE_CONNECT_RESPONDED_UUID,live_connect_loaded:Ei.LIVE_CONNECT_LOADED,a9_without_consents:pr,a9_apstag_hem_sent:hr,yahoo_started:Ei.YAHOO_STARTED};class ma{constructor(){this.dataWarehouseTracker=new ha,this.initStartTime(),this.initLoadTimesTracker()}static make(){return ma.instance||(ma.instance=new ma),ma.instance}initStartTime(){const e=new Date;this.startTime||(this.startTime=Hn(),this.tzOffset=e.getTimezoneOffset()),_i.emit(Es,{timestamp:e})}getStartTime(){return this.startTime}getTimezoneOffset(){return this.tzOffset}initLoadTimesTracker(){_i.on(Es,(e=>{this.trackLoadTime("load_time_init",e.timestamp)})),Object.keys(ga).forEach((e=>{_i.on(ga[e],(()=>{this.trackLoadTime(e,Date.now())}))})),_i.onSlotEvent(bs.SLOT_REQUESTED_EVENT,(()=>{this.trackLoadTime("top_leaderboard_requested",Date.now())}),"top_leaderboard",!0),_i.onSlotEvent(bs.SLOT_RESPONSE_RECEIVED,(()=>{this.trackLoadTime("top_leaderboard_received",Date.now())}),"top_leaderboard",!0),_i.on(vi,(e=>{"top_leaderboard"==e.name&&this.trackLoadTime("top_leaderboard_loaded",Date.now())})),_i.on(Ei.PARTNER_LOAD_STATUS,(({status:e})=>{this.trackLoadTime(e,Date.now())}),!1)}trackLoadTime(e,t){this.dataWarehouseTracker.track({event_name:e,browser_ts:t,load_time:t-this.getStartTime(),tz_offset:this.getTimezoneOffset(),country:yn()||""},Xo.AD_ENG_LOAD_TIMES)}}let fa=class{execute(){ma.make()}};var va,ba;fa=a([Rn()],fa);let ya=va=class{constructor(e){this.instantConfig=e}execute(){const e=this.instantConfig.get("icSlotsConfig");return e&&va.extendSlotsConfiguration(O.get("slots"),e),Promise.resolve()}static extendSlotsConfiguration(e,t){Object.getOwnPropertyNames(t).forEach((i=>{e[i]&&va.extendBaseSlotConfiguration(e[i],t[i])}))}static extendBaseSlotConfiguration(e,t){Array.isArray(t.defaultSizes)&&(e.defaultSizes=va.mergeArrayOfArraysWithoutDuplicates(e.defaultSizes,t.defaultSizes)),t.targeting&&(e.targeting=e.targeting?Object.assign(e.targeting,t.targeting):t.targeting)}static mergeArrayOfArraysWithoutDuplicates(e,t){return e||(e=[]),Array.from(new Set([...e,...t].map((e=>JSON.stringify(e)))),(e=>JSON.parse(e)))}};function Sa(e,t){var i;const n=new URLSearchParams(null===window||void 0===window?void 0:window.location.search);return n.has(e)?null!==(i=n.get(e))&&void 0!==i?i:"":null!=t?t:""}ya=va=a([Rn(),l("design:paramtypes",["function"==typeof(ba=void 0!==po&&po)?ba:Object])],ya);const wa=()=>v.get("exp_bucket")||"";function _a(){const e=function(){const e=Sa("pf_pathfinder_force_bucket");return void 0===e||0===(null==e?void 0:e.length)?"":e}();return void 0!==e&&(null==e?void 0:e.length)>0?e:wa()||"100"}var Ea,Ta;(Ta=Ea||(Ea={})).Valid="Valid",Ta.Invalid="Invalid";const Ia=/\d{1,2}/,Aa=()=>"undefined"!=typeof window&&void 0!==window.document;function Ca(e=!1){return e||(Aa(),!!(/^localhost/.test(window.location.hostname)||"127.0.0.1"===window.location.hostname||/fandom-dev\.(pl|us)$/.test(window.location.hostname)||window.location.search.includes("pf_debug")||window.location.search.includes("debug")))}const Oa=Date.now();function Pa(){}const ka=(e,t,i=[])=>(n,...s)=>((e,t,i,n,...s)=>{const r=function(e){return"error"===e?console.error:"debug"===e?Ca()?console.debug:Pa:console.log}(e),o=`%c${t} | ${function(){var e;return((Date.now()-(Aa()?null===(e=window.performance)||void 0===e?void 0:e.timeOrigin:Oa))/1e3).toFixed(4)}()}s | ${n}`;s.length?r(o,i,...s):r(o,i)})(t,e,i.join(";"),n,...s);function Na(e){return["color: #fff","padding: 2px 4px","border-radius: 2px",`background-color: ${e}`]}function La(e){return{info:ka(`PathfinderLite | ${e}`,"info",Na("#334")),debug:ka(`PathfinderLite | ${e}`,"debug",Na("#550")),error:ka(`PathfinderLite | ${e}`,"error",Na("#800"))}}function Ra(e,t){const i=La("getExperiment"),n=function(e){if(!(null==e?void 0:e.length))return[];const t={};for(const i of e)t[i]=(t[i]||0)+1;return e.filter((e=>t[e]>1))}(Object.assign([],e).map((e=>e.buckets)).flat()),s=e.map((e=>(e.buckets.some((e=>n.includes(e)))&&(e.disabled=!0),e))).filter((e=>!e.disabled)).filter((e=>((e,t)=>{const i=Date.now();let n=!0;return"number"==typeof e&&i<e&&n&&(n=!1),"number"==typeof t&&i>t&&n&&(n=!1),n})(e.startDate,e.endDate)));if(!s)return i.debug("There were no experiment available at this time, if this was not intentional please check your experiment configuration."),null;const r=("function"==typeof t?t:_a)();if(!r)return i.debug("Could not retrieve the current bucket based on the identifier provided. Cannot determine which experiment is suitable to the user."),null;const o=s.find((e=>e.buckets.includes(r)));return o?o||null:(i.debug(`There were no experiment available with the current bucket: ${r}. If this was not intentional please check your experiment configuration.`),null)}function Da({name:e,buckets:t,disabled:i,startDate:n,endDate:s}){const r=La(e);let o=!1;(null==t?void 0:t.length)||(r.debug(`No buckets found for experiment [${e}]. Experiment will not be active.`),o=!0);const a=function(e){return e.map((e=>!Ia.test(e))).some(Boolean)?Ea.Invalid:Ea.Valid}(t);Ea.Invalid===a&&(r.debug(`The current bucket(s) [${t}] for experiment [${e}], are invalid. Experiment will not be active.`),o=!0);const d=Date.parse(Sa(`${e}-start-date`));console.debug(`startDateQueryParam: ${d}`);const l=Date.parse(Sa(`${e}-end-date`));return console.debug(`endDateQueryParam: ${l}`),n=isNaN(d)?n:d,console.debug(`startDate: ${n}`),s=isNaN(l)?s:l,console.debug(`endDate: ${s}`),{name:e,buckets:t,disabled:i||o,startDate:n,endDate:s,log:r}}function xa(e){const t=us.get("experiment_groups")||[];t.push(e),us.set("experiment_groups",t)}var za;ka("PathfinderLite","info",Na("#334")),ka("PathfinderLite","debug",Na("#550")),ka("PathfinderLite","error",Na("#800"));let Va=class{constructor(e){this.instantConfig=e,this.alreadyReported=!1,this.pathfinderExperimentVariantNames={control:"limit-bidders-mobile-experiment-control",noKargo:"limit-bidders-mobile-experiment-no-kargo",noSeedtag:"limit-bidders-mobile-experiment-no-seedtag",noGumgum:"limit-bidders-mobile-experiment-no-gumgum"},this.pathfinderActiveExperimentVariant=Ra([Da({name:this.pathfinderExperimentVariantNames.control,buckets:["60","61","62"]}),Da({name:this.pathfinderExperimentVariantNames.noKargo,buckets:["63","64","66"]}),Da({name:this.pathfinderExperimentVariantNames.noSeedtag,buckets:["79","85","86"]}),Da({name:this.pathfinderExperimentVariantNames.noGumgum,buckets:["87","92","93"]})])}getDisabledBidderName(){var e,t;if(function(e,t="",i){return e.get("icExperiments",[]).includes(t)&&!!i}(this.instantConfig,"limitBidders",this.pathfinderActiveExperimentVariant))switch(this.alreadyReported||(this.alreadyReported=!0,Wn("UcpMobileLimitBiddersExperiment","Experiment limit bidders enabled",null===(e=this.pathfinderActiveExperimentVariant)||void 0===e?void 0:e.name)),null===(t=this.pathfinderActiveExperimentVariant)||void 0===t?void 0:t.name){case this.pathfinderExperimentVariantNames.noKargo:return xa(this.pathfinderExperimentVariantNames.noKargo),"kargo";case this.pathfinderExperimentVariantNames.noSeedtag:return xa(this.pathfinderExperimentVariantNames.noSeedtag),"seedtag";case this.pathfinderExperimentVariantNames.noGumgum:return xa(this.pathfinderExperimentVariantNames.noGumgum),"gumgum";case this.pathfinderExperimentVariantNames.control:return xa(this.pathfinderExperimentVariantNames.control),!1;default:return!1}return!1}};var Ma,Ua;Va=a([Rn(),l("design:paramtypes",["function"==typeof(za=void 0!==po&&po)?za:Object])],Va);let ja=class{constructor(e,t){this.instantConfig=e,this.ucpMobileLimitBiddersExperiment=t,this.prebidBidders={appnexus:"icPrebidAppNexus",appnexusAst:"icPrebidAppNexusAst",appnexusNative:"icPrebidAppNexusNative",gumgum:"icPrebidGumGum",indexExchange:"icPrebidIndexExchange",kargo:"icPrebidKargo",medianet:"icPrebidMedianet",mgnipbs:"icPrebidMagniteS2s",nobid:"icPrebidNobid",ogury:"icPrebidOgury",ozone:"icPrebidOzone",openx:"icPrebidOpenX",pubmatic:"icPrebidPubmatic",relevantdigital:"icPrebidWebAds",rubicon_display:"icPrebidRubiconDisplay",roundel:"icPrebidRoundel",rubicon:"icPrebidRubicon",seedtag:"icPrebidSeedtag",triplelift:"icPrebidTriplelift",verizon:"icPrebidVerizon",yahoossp:"icPrebidYahooSsp",yahooConnectId:"icPrebidYahooConnectId"},this.notCoppaCompliantBidders=["kargo","verizon"],this.selectedBidder=y.get("select_bidder")||""}execute(){this.setupBidders(),Wn("bidders","setup finished",O.get("bidders"))}setupBidders(){const e=O.get("custom.hasFeaturedVideo");if(this.instantConfig.get("icA9Bidder")&&(O.set("bidders.a9.enabled",!0),O.set("bidders.a9.videoEnabled",this.instantConfig.get("icA9VideoBidder")&&e)),this.instantConfig.get("icPrebid")){O.set("bidders.prebid.enabled",!0);for(const[e,t]of Object.entries(this.prebidBidders))this.enableIfApplicable(e,t);const e=this.instantConfig.get("icPrebidTestBidder");e&&(O.set("bidders.prebid.testBidder",{name:e.name,slots:e.slots}),this.enableIfApplicable("testBidder","icPrebidTestBidder")),O.set("bidders.prebid.priceFloors.enabled",this.instantConfig.get("icPrebidPriceFloors")),O.set("bidders.prebid.priceFloors.config",this.instantConfig.get("icPrebidPriceFloorsConfig")),O.set("bidders.prebid.priceFloors.identityBasedConfig",this.instantConfig.get("icPrebidPriceFloorsIdentityBasedConfig")),O.set("bidders.prebid.auctionDelay",this.instantConfig.get("icPrebidAuctionDelay",0)),O.set("bidders.prebid.intentIQ",this.instantConfig.get("icPrebidIntentIQ",!1)),O.set("bidders.prebid.intentIQVersion",this.instantConfig.get("icPrebidIntentIQVersion","6.06-20240711")),O.set("bidders.prebid.intentIQTimeout",this.instantConfig.get("icPrebidIntentIQTimeout",500)),O.set("bidders.prebid.id5",this.instantConfig.get("icPrebidId5",!1))}O.set("bidders.enabled",O.get("bidders.prebid.enabled")||O.get("bidders.a9.enabled"))}enableIfApplicable(e,t){this.ucpMobileLimitBiddersExperiment.getDisabledBidderName()!==e?this.selectedBidder&&e!==this.selectedBidder?O.set(`bidders.prebid.${e}.enabled`,!1):!is()||this.isBidderCoppaCompliant(e)?O.set(`bidders.prebid.${e}.enabled`,!!this.instantConfig.get(t)):O.set(`bidders.prebid.${e}.enabled`,!1):O.set(`bidders.prebid.${e}.enabled`,!1)}isBidderCoppaCompliant(e){return!this.notCoppaCompliantBidders.includes(e)}};var Ba;ja=a([Rn(),l("design:paramtypes",["function"==typeof(Ma=void 0!==po&&po)?Ma:Object,"function"==typeof(Ua=void 0!==Va&&Va)?Ua:Object])],ja);let $a=class{constructor(e){this.dwTracker=e}track(e){var t,i;const n=new Date,s="dev"===(null===(i=null===(t=null===window||void 0===window?void 0:window.ads)||void 0===t?void 0:t.context)||void 0===i?void 0:i.env)?Xo.AD_ENG_DEV_LABRADOR_INFO:Xo.AD_ENG_LABRADOR_INFO;this.dwTracker.track({prop_value:e,timestamp:n.getTime(),tz_offset:n.getTimezoneOffset()},s)}};var Fa,Ha,Ga;$a=a([Rn(),l("design:paramtypes",["function"==typeof(Ba=void 0!==ha&&ha)?Ba:Object])],$a);let qa=class{constructor(e,t,i=null){this.labradorTracker=e,this.dwTracker=t,this.instantConfig=i}execute(){this.experimentGroupsTracker(),this.keyValsTracker(),this.googleTopicsTracker()}experimentGroupsTracker(){var e,t;const i=[...null!==(t=null===(e=this.instantConfig)||void 0===e?void 0:e.getActiveKeyValues())&&void 0!==t?t:[],...us.get("experiment_groups")||[]].join(";");i&&this.labradorTracker.track(i),_i.on(Ei.INTENT_IQ_GROUP_OBTAINED,(({abTestGroup:e})=>{this.labradorTracker.track(`intentIQ_${e}`)}))}keyValsTracker(){const e=Object.assign({},us.dump());delete e.AU_SEG,this.dwTracker.track({keyvals:JSON.stringify(e)},Xo.KEY_VALS)}googleTopicsTracker(){return c(this,void 0,void 0,(function*(){if("1"!==us.get("topics_available"))return;const e=yield document.browsingTopics({skipObservation:!0});this.dwTracker.track({ppid:us.get("ppid"),topic:JSON.stringify(e)},Xo.TOPICS)}))}};qa=a([Rn(),l("design:paramtypes",["function"==typeof(Fa=void 0!==$a&&$a)?Fa:Object,"function"==typeof(Ha=void 0!==ha&&ha)?Ha:Object,"function"==typeof(Ga=void 0!==po&&po)?Ga:Object])],qa);const Wa={category:"[Video]",name:"Setup done",payload:{_as:"props",_p:void 0}},Ka={category:"[Video]",name:"Video event",payload:{_as:"props",_p:void 0}},Ya={category:"[Video]",name:"Video player tracking",payload:{_as:"props",_p:void 0}},Qa={category:"[Video]",name:"Player rendered",payload:{_as:"props",_p:void 0}};class Ja{static getEventData(e){const t=new Date;return{ad_error_code:e.ad_error_code,ad_product:e.ad_product,audio:e.audio?1:0,browser:`${Wi.getOperatingSystem()} ${Wi.getBrowser()}`,content_type:e.content_type||"",country:yn()||"",creative_id:e.creative_id||"",ctp:e.ctp?1:0,event_name:e.event_name,line_item_id:e.line_item_id||"",player:e.player,position:e.position||"",pv_number:O.get("wiki.pvNumber"),rv:us.get("rv",e.position)||"",skin:us.get("skin")||"",timestamp:t.getTime(),tz_offset:t.getTimezoneOffset(),user_block_autoplay:e.user_block_autoplay,video_id:e.video_id||"",video_number:e.video_number||""}}static emit(e){e.ad_product&&e.player&&e.event_name&&_i.emit(Ya,{eventInfo:e})}static emitVideoEvent(e){_i.emit(Ka,{videoEvent:e})}}const Xa=new class{register(){const e={onEvent(e,t,i){const n=Ja.getEventData(i);Ja.emit(n)}};O.push("listeners.porvata",e)}},Za=({data:e,slot:t})=>({slot:t,data:Object.assign(Object.assign({},e),{ad_status:e.ad_status||t.getStatus(),advertiser_id:t.advertiserId||"",creative_id:t.creativeId||"",kv_pos:t.getMainPositionName(),kv_rv:t.getTargetingProperty("rv")||"",order_id:t.orderId||"",product_lineitem_id:t.lineItemId||"",slot_id:t.getUid()||"",slot_size:t.getCreativeSize()||""})});var ed;!function(e){e.ONE_TRUST="1t",e.TRACKING_OPT_IN="toi"}(ed||(ed={}));class td{constructor(){this.logGroup="identity-setup"}execute(){return c(this,void 0,void 0,(function*(){return Wn(this.logGroup,"initialized"),yield this.identityEngineReady(),this.setupOver18Targeting(),Promise.resolve()}))}identityEngineReady(){return c(this,void 0,void 0,(function*(){return new Promise((e=>{_i.on(Ei.IDENTITY_ENGINE_READY,(()=>{const t=ts.getValue("tracking","ppid");t&&us.set("ppid",t);const i=ts.getValue("tracking","pvUID");i&&us.set("pvuid",i),us.set("browser",ts.getValue(es.targeting,"browser")),us.set("cl",ts.getValue(es.tracking,"chromeLabel"));const n=ts.getValue(es.targeting,"adGroup");if(us.set("adGroup",(null==n?void 0:n.split(","))||[]),O.get("services.identityPartners")){const e=ts.getValue(es.targeting,"AU_SEG");us.set("AU_SEG",e)}ts.getValue(es.site,"directedAtChildren")&&us.set("monetization",is()?"restricted":"regular");const s="browsingTopics"in document&&"featurePolicy"in document&&document.featurePolicy.allowsFeature("browsing-topics")?1:0;us.set("topics_available",s.toString());const r="joinAdInterestGroup"in navigator&&document.featurePolicy.allowsFeature("join-ad-interest-group")&&document.featurePolicy.allowsFeature("run-ad-auction")?1:0;us.set("pa_available",r.toString()),us.set("cmp",this.getCmp()),Wn(this.logGroup,"ready"),e()}))}))}))}setupOver18Targeting(){_i.on(Ei.IDENTITY_PARTNER_DATA_OBTAINED,(()=>{const e=window.fandomContext.tracking.over_18;e&&us.set("over_18",e)}))}getCmp(){return void 0!==window.OneTrust?ed.ONE_TRUST:ed.TRACKING_OPT_IN}}const id=({data:e,slot:t})=>{var i;const n=new Date,s=n.getTime(),r=null!==(i=(null==t?void 0:t.getTargetingProperty("uap"))&&"none"!==(null==t?void 0:t.getTargetingProperty("uap")))&&void 0!==i&&i,o=us.dump(),a=(null==o?void 0:o.experiment_groups)||[],d=(null==o?void 0:o.labrador)||[];return{slot:t,data:Object.assign(Object.assign({},e),{timestamp:s,browser:`${Wi.getOperatingSystem()} ${Wi.getBrowser()}`,country:(yn()||"").toUpperCase(),region:(wn()||"").toUpperCase(),device:Wi.getDeviceType(),is_uap:r?1:0,kv_ah:window.document.body.scrollHeight,kv_lang:o.lang||"",kv_s0v:o.s0v||"",kv_s1:o.s1||"",kv_s2:o.s2||"",kv_skin:o.skin||"",labrador:[...d,...a].join(";"),opt_in:O.get("options.geoRequiresConsent")?O.get("options.trackingOptIn")?"yes":"no":"",opt_out_sale:O.get("options.geoRequiresSignal")?O.get("options.optOutSale")?"yes":"no":"",page_width:window.document.body.scrollWidth&&window.document.body.scrollWidth.toString()||"",ppid:o.ppid,pa_available:us.get("pa_available")||"",pv:O.get("wiki.pvNumber")||window.pvNumber||"",pv_unique_id:O.get("wiki.pvUID")||window.pvUID||"",scroll_y:window.scrollY||window.pageYOffset,topics_available:us.get("topics_available")||"",tz_offset:n.getTimezoneOffset(),viewport_height:window.innerHeight||0,rollout_tracking:void 0!==window.OneTrust?ed.ONE_TRUST:ed.TRACKING_OPT_IN})}},nd=({data:e,slot:t})=>{var i;return{slot:t,data:Object.assign(Object.assign({},e),{word_count:us.get("word_count")||-1,short_page:null!==(i=O.get("custom.short_page"))&&void 0!==i&&i})}};function sd(e,t){return c(this,void 0,void 0,(function*(){const i=t.getDfpSlotPrices(e),n=yield t.getCurrentSlotPrices(e);function s(e){return i&&i[e]?i[e]:n&&n[e]?`${n[e]}not_used`:""}return{bidder_0:s("wikia"),bidder_1:s("indexExchange"),bidder_2:s("appnexus"),bidder_4:s("rubicon"),bidder_8:s("wikiaVideo"),bidder_9:s("openx"),bidder_10:s("appnexusAst"),bidder_11:s("rubicon_display"),bidder_12:s("a9"),bidder_14:s("pubmatic"),bidder_17:s("kargo"),bidder_19:s("gumgum"),bidder_21:s("triplelift"),bidder_25:s("nobid"),bidder_28:s("verizon"),bidder_30:s("medianet"),bidder_31:s("roundel"),bidder_32:s("ogury"),bidder_34:s("yahoossp"),bidder_37:s("webAds"),bidder_38:s("seedtag")}}))}const rd=(e,t)=>c(void 0,[e,t],void 0,(function*({data:e,slot:t},i){return i?{slot:t,data:Object.assign(Object.assign(Object.assign({},e),{bidder_won:t.winningBidderDetails?t.winningBidderDetails.name:"",bidder_won_price:t.winningBidderDetails?t.winningBidderDetails.price:""}),yield sd(t.getSlotName(),i))}:{slot:t,data:e}}));class od{constructor(){this.disabled=!1,this.compilers=[]}disable(){this.disabled=!0}addCompiler(e){this.compilers.push(e)}compileData(e=null,t=null,i={}){let n={bid:t,slot:e,data:i};return this.compilers.forEach((e=>{n=e(n)})),n}}const ad=new class extends od{constructor(){super(...arguments),this.onRenderEndedStatusToTrack=[zs.STATUS_COLLAPSE,zs.STATUS_FORCED_COLLAPSE,zs.STATUS_MANUAL,zs.STATUS_SUCCESS],this.onChangeStatusToTrack=[zs.STATUS_BLOCKED,zs.STATUS_REQUESTED,zs.STATUS_CLICKED,zs.STATUS_ERROR,zs.STATUS_VIEWPORT_CONFLICT,zs.STATUS_HIVI_COLLAPSE,zs.STATUS_HEAVY_AD_INTERVENTION,zs.STATUS_UNKNOWN_INTERVENTION],this.compilers=[Za,id,nd]}isEnabled(){return!0}register(e,{bidders:t}){this.isEnabled()&&(_i.onSlotEvent(bs.SLOT_RENDERED_EVENT,(({slot:e})=>{e.trackStatusAfterRendered=!0})),_i.onSlotEvent(bs.SLOT_STATUS_CHANGED,(i=>c(this,[i],void 0,(function*({slot:i}){const n=i.getStatus();(i.trackStatusAfterRendered&&(delete i.trackStatusAfterRendered,this.onRenderEndedStatusToTrack.includes(n)||i.getConfigProperty("trackEachStatus"))||this.onChangeStatusToTrack.includes(n)||i.getConfigProperty("trackEachStatus"))&&e(yield rd(this.compileData(i),t))})))),_i.onSlotEvent(bs.CUSTOM_EVENT,(i=>c(this,[i],void 0,(function*({slot:i,payload:n}){e(yield rd(this.compileData(i,null,{ad_status:null==n?void 0:n.status}),t))})))))}},dd=({data:e,slot:t})=>{const i=new Date;return{slot:t,data:Object.assign(Object.assign({},e),{timestamp:i.getTime(),tz_offset:i.getTimezoneOffset()})}},ld=({data:e,slot:t})=>({slot:t,data:Object.assign(Object.assign({},e),{creative_id:t.creativeId||"",line_item_id:t.lineItemId||"",rv:t.getTargetingProperty("rv")||"",slot_id:t.getUid()||""})}),cd=new class extends od{constructor(){super(...arguments),this.compilers=[dd,ld]}isEnabled(){return!0}register(e){this.isEnabled()&&_i.onSlotEvent(bs.SLOT_VIEWED_EVENT,(({slot:t})=>{e(this.compileData(t))}))}},ud=new class extends od{constructor(){super(...arguments),this.compilers=[id]}register(e){_i.on(Ts,(({adSlotName:t,ad_status:i})=>{e(this.compileData(Qr.get(t),null,{ad_status:i}))}),!1)}},pd={name:"Video overlay added",payload:{_as:"props",_p:void 0}},hd={name:"Video toggle ui overlay clicked",payload:{_as:"props",_p:void 0}},gd={name:"Video learn more displayed",payload:{_as:"props",_p:void 0}},md=new class extends od{constructor(){super(...arguments),this.eventsToRegister=[gd,pd,hd],this.compilers=[id,Za]}register(e){_i.onSlotEvent(bs.SLOT_RENDERED_EVENT,(({adSlotName:t})=>{this.addClickTrackingListeners(e,t)})),this.eventsToRegister.map((t=>this.addToTracking(t,e)))}addToTracking(e,t){_i.on(e,(({adSlotName:e,ad_status:i})=>{t(this.compileData(Qr.get(e),null,{ad_status:i}))}),!1)}addClickTrackingListeners(e,t){this.clickDetection(t,e)}clickDetection(e,t){window.addEventListener("blur",(()=>{const i=document.activeElement;if(!i)return;if(null===i.closest(`div#${e}`))return;Wn("ad-click-tracker",`Click! on slot='${e}' is detected.`);const n=Qr.get(e);this.handleClickEvent(t,n),setTimeout((()=>{document.activeElement.blur()}),100)}))}handleClickEvent(e,t){const i={ad_status:zs.STATUS_CLICKED};e(this.compileData(t,null,i))}};function fd(e,t){const i=Qr.get(e);return!i||!i.getPushTime()||i.getPushTime()>t}const vd=({bid:e,data:t})=>{var i;const n=(new Date).getTime(),s=Qr.getSlotId(e.slotName),r=[];return e.buyerId&&r.push(`buyer_id=${e.buyerId}`),(null===(i=e.additionalInfo)||void 0===i?void 0:i.dsa)&&r.push(`dsa=${JSON.stringify(e.additionalInfo.dsa)}`),{bid:e,data:Object.assign(Object.assign({},t),{timestamp:n,slot_id:s,name:e.bidderName,size:e.size,price:e.price,response_time:e.timeToRespond,status:fd(e.slotName,e.responseTimestamp)?"on_time":"too_late",additional_flags:r.join(";")})}},bd=new class extends od{constructor(){super(...arguments),this.compilers=[vd]}isEnabled(){return!0}register(e){this.isEnabled()&&_i.on(vr,(({bidResponse:t})=>{e(this.compileData(null,t))}),!1)}};class yd{constructor(e){this.adapter=e,this.steps=[]}add(...e){return this.steps.push(...e),this}execute(e,t){const i=this.createFinalNext(t);return this.createExecutor(i)(e)}createFinalNext(e){return e?t=>this.adapter.execute(e,t):e=>c(this,void 0,void 0,(function*(){return e}))}createExecutor(e){return this.steps.reduceRight(((e,t)=>i=>this.adapter.execute(t,i,e)),e)}}class Sd{execute(e,t,i){return c(this,void 0,void 0,(function*(){return e(t,i)}))}}class wd extends yd{constructor(){super(new Sd)}}const _d={DataWarehouse:"DW",GoogleAnalytics:"GA"},Ed=(e,t)=>{if(Object.values(_d).includes(e.target)&&e.payload)return t({payload:e.payload,target:e.target})};class Td{constructor(e){this.requiredKeys=e,this.pipeline=new wd,this.pipeline.add(Ed)}register(e,t){if(this.isEnabled())return Ls.register({origin:t,keys:this.requiredKeys,infinite:!0},(t=>{this.pipeline.execute(Object.assign({},t),e)})),this}isEnabled(){return!0}}const Id="intervention-tracker",Ad=new class{register(){O.get("services.interventionTracker.enabled")?_i.action$.pipe(Si(_i.getGlobalAction(Vs)),cr((e=>this.handleIntervention(e)))).subscribe():Wn(Id,"Intervention tracker is disabled")}handleIntervention(e){const t=Qr.get(e.slotName);Wn(Id,e),t&&(t.setStatus(this.getInterventionStatus(e.id)),fo.log("Ad intervention",{interventionId:e.id,interventionMessage:e.message,lineItemId:t.lineItemId,slotName:e.slotName}))}getInterventionStatus(e){return"HeavyAdIntervention"===e?zs.STATUS_HEAVY_AD_INTERVENTION:zs.STATUS_UNKNOWN_INTERVENTION}},Cd={main_vertical:{from:"main_vertical",limit:"one-of-each"},main_entity_type:{from:"main_entity_type",limit:"one-of-each"},genre:{from:"genres",addConfidence:"site"},subgenre:{from:"subgenres",addConfidence:"site"},vertical:{from:"verticals",addConfidence:"all"},themes:{from:"themes",addConfidence:"site"}},Od={fran:{from:"franchises"}};function Pd(e){return"object"!=typeof e||null===e?e:Object.keys(e).reduce(((t,i)=>(e[i]&&e[i].length>0&&(t[i]=e[i]),t)),{})}class kd{constructor(e=window.fandomTaxonomy){this.fandomTaxonomy=e}static applyToTargetingService(){const e=new kd;us.extend(Object.assign(Object.assign(Object.assign({},us.dump()),e.getKeyValues()),e.getOrtb2IabCategorySiteFields()));const t=e.getTags();Object.keys(t).forEach((e=>{const i=us.get(e)||[],n=t[e]||[];if(Array.isArray(i)){const t=[...i,...n].filter(Boolean);us.set(e,t)}else us.set(e,[i,n])})),lr.setConfig({pps:{taxonomies:{IAB_CONTENT_2_2:{values:[...new Set([...e.getIABCategories("site"),...e.getIABCategories("page")])]}}}})}get isPresent(){return!!this.fandomTaxonomy}getIABCategories(e){var t,i,n;const s=[...null!==(n=null===(i=null===(t=this.fandomTaxonomy)||void 0===t?void 0:t[e])||void 0===i?void 0:i.iab_categories)&&void 0!==n?n:[]];let r=["1217","bsr004"];return 0===s.length?r.push("1014"):r=[...r,...s],r}getOrtb2IabCategorySiteFields(){const e=this.getIABCategories("site"),t=this.getIABCategories("page");return Wn("FandomTaxonomyService","iabSiteCat: ",e," iabPageCat: ",t),{cattax:6,cat:e,pagecat:t}}getKeyValues(){return Pd(Object.keys(Cd).reduce(((e,t)=>(e[t]=this.getValueForKey(Cd[t]),e)),{}))}getTags(){return Pd(Object.keys(Od).reduce(((e,t)=>(e[t]=this.getValueForKey(Od[t]),e)),{}))}getValueForKey(e){const{from:t,addConfidence:i=!1,limit:n}=e;let s=this.getValueFromTaxonomyWithPrefix("site",t),r=this.getValueFromTaxonomyWithPrefix("page",t);"site"!==i&&"all"!==i||(s=s.map(kd.addConfidenceToValue)),"page"!==i&&"all"!==i||(r=r.map(kd.addConfidenceToValue));let o=[];return"one-of-each"===n?(s.length&&o.push(s[0]),r.length&&o.push(r[0])):o=[...s,...r],o=kd.orderByConfidence(o),o.filter(Boolean).map(kd.getNormalizedValue).slice(0,50)}getValueFromTaxonomyWithPrefix(e,t){var i,n,s;const r={site:"s_",page:"p_"};let o=null!==(s=null===(n=null===(i=this.fandomTaxonomy)||void 0===i?void 0:i[e])||void 0===n?void 0:n[t])&&void 0!==s?s:[];return Array.isArray(o)||(o=[o]),o.filter((e=>"object"==typeof e&&e&&"string"==typeof(null==e?void 0:e.value)&&(null==e?void 0:e.value.length)>0&&"number"==typeof(null==e?void 0:e.confidence))).map((t=>Object.assign(Object.assign({},t),{value:`${r[e]}${t.value}`})))}static orderByConfidence(e){return e.sort(((e,t)=>t.confidence-e.confidence))}static addConfidenceToValue(e){return Object.assign(Object.assign({},e),{value:`${e.value}${t=e.confidence,isNaN(t)?"":t<.1?"_c0":t<.2?"_c1":t<.3?"_c2":t<.4?"_c3":t<.5?"_c4":t<.6?"_c5":t<.7?"_c6":t<.8?"_c7":t<.9?"_c8":"_c9"}`});var t}static getNormalizedValue(e){return e.value.substring(0,40)}}class Nd{static getPrebidNativeMediaTypes(e){return{sendTargetingKeys:!1,adTemplate:Nd.getPrebidNativeTemplate(),title:{required:!0,len:Nd.getMaxTitleLength(e)},body:{required:!0,len:Nd.getMaxBodyLength(e)},clickUrl:{required:!0},displayUrl:{required:!1},image:{required:!1,aspect_ratios:[{min_width:Nd.getMinImageSize(e),min_height:Nd.getMinImageSize(e),ratio_width:1,ratio_height:1}]}}}static getPrebidNativeTemplate(){return'<div id="native-prebid-ad" class="ntv-ad">\n\t\t\t\t\t<div class="ntv-wrapper">\n\t\t\t\t\t\t<a href="##hb_native_linkurl##" class="ntv-link" style="flex-shrink: 0;">\n\t\t\t\t\t\t\t<img src="##hb_native_image##" id="ntv-img" class="ntv-img">\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\t<div class="ntv-content">\n\t\t\t\t\t\t\t<p class="ntv-ad-label">Ad</p>\n\t\t\t\t\t\t\t<a href="##hb_native_linkurl##" class="ntv-link">\n\t\t\t\t\t\t\t\t<p class="ntv-ad-title ntv-headline">##hb_native_title##</p>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t<p class="ntv-ad-offer">##hb_native_body##</p>\n\t\t\t\t\t\t\t<a href="##hb_native_linkurl##" class="ntv-link">\n\t\t\t\t\t\t\t\t<button class="ntv-ad-button">##hb_native_displayUrl##</button>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>'}static getMinImageSize(e){return"mobile"==e?rn()<=320?90:120:126}static getMaxTitleLength(e){return"mobile"==e?40:60}static getMaxBodyLength(e){return"mobile"==e?30:120}}Nd.assetsMap={title:"hb_native_title",body:"hb_native_body",image:"hb_native_image",clickUrl:"hb_native_linkurl",displayUrl:"hb_native_displayUrl"};class Ld{constructor({enabled:e,slots:t}){this.isCustomBidAdapter=!1,this.enabled=e,this.slots=t,this.pageTargeting=Object.assign({},us.dump()||{}),Object.keys(this.pageTargeting).forEach((e=>{Array.isArray(this.pageTargeting[e])||(this.pageTargeting[e]=[this.pageTargeting[e]])}))}prepareAdUnits(){return Object.keys(this.slots).map((e=>this.prepareConfigForAdUnit(e,this.slots[e])))}filterSizesForRefreshing(e,t){if(!t)return t;const i=O.get("slotConfig.slotRefresher");if(!i||!i.sizes)return t;const n=Object.keys(i.sizes),s=i.sizes[e];return n.includes(e)?t.filter((e=>e[1]<=s[1])):t}getTargeting(e,t={}){return Object.assign(Object.assign(Object.assign({},this.pageTargeting),{src:O.get("src")||[""],pos:[e]}),t)}getOrtb2Imp(e){return{ext:{gpid:this.getGPIDValue(e)}}}getGPIDValue(e){return ps.build(O.get("adUnitId"),{slotConfig:{adProduct:e,group:"PB",slotNameSuffix:""}})}setMaximumAdSlotHeight(e,t){const i=O.get(`bidders.prebid.${this.bidderName}.slots.${e}`);i&&"sizes"in i&&O.set(`bidders.prebid.${this.bidderName}.slots.${e}.sizes`,O.get(`bidders.prebid.${this.bidderName}.slots.${e}.sizes`).filter((e=>e[1]<=t)))}extractSizeFromString(e,t){let i;return"pubmatic"===t?i=/@(\d+)x(\d+)/:"triplelift"===t?i=/_(\d+)x(\d+)_/:console.error("extractSizeFromString","Invalid type specified"),e.match(i)?[parseInt(e.match(i)[1],10),parseInt(e.match(i)[2],10)]:null}}class Rd extends Ld{constructor(e){super(e),this.bidderSettings={storageAllowed:!0},this.placements=e.placements}get bidderName(){return Rd.bidderName}isNativeModeOn(){return O.get("bidders.prebid.appnexusNative.enabled")}prepareConfigForAdUnit(e,{sizes:t,placementId:i,position:n="mobile"}){const s=this.filterSizesForRefreshing(e,t);return O.get(`slots.${e}.isNative`)&&O.get("bidders.prebid.native.enabled")&&this.isNativeModeOn()?this.prepareNativeConfig(e,{sizes:s,placementId:i,position:n}):this.prepareStandardConfig(e,{sizes:s,placementId:i,position:n})}prepareStandardConfig(e,{sizes:t,placementId:i,position:n}){return{code:e,mediaTypes:{banner:{sizes:t}},bids:this.getBids(e,{sizes:t,placementId:i,position:n})}}prepareNativeConfig(e,{sizes:t,placementId:i,position:n}){return{code:e,mediaTypes:{native:Nd.getPrebidNativeMediaTypes(n)},bids:this.getBids(e,{sizes:t,placementId:i,position:n})}}getBids(e,{placementId:t,position:i="mobile"}){return Array.isArray(t)&&t.length>0?t.map((t=>({bidder:this.bidderName,params:{placementId:t,keywords:Object.assign({},this.getTargeting(e))}}))):[{bidder:this.bidderName,params:{placementId:t||this.getPlacement(i),keywords:Object.assign({},this.getTargeting(e))}}]}getPlacement(e){let t=e;if("mobile"===e){const e=us.get("mappedVerticalName");t=e&&this.placements[e]?e:"other"}return this.placements[t]}}var Dd,xd;Rd.bidderName="appnexus",function(e){e[e.IN_STREAM=1]="IN_STREAM",e[e.IN_BANNER=2]="IN_BANNER",e[e.IN_ARTICLE=3]="IN_ARTICLE",e[e.IN_FEED=4]="IN_FEED",e[e.FLOATING=5]="FLOATING"}(Dd||(Dd={})),function(e){e[e.IN_STREAM=1]="IN_STREAM",e[e.ACCOMPANYING_CONTENT=2]="ACCOMPANYING_CONTENT",e[e.INTERSTITIAL=3]="INTERSTITIAL",e[e.STANDALONE=4]="STANDALONE"}(xd||(xd={}));class zd extends Ld{constructor(e){super(e),this.aliases={appnexus:[zd.bidderName]},this.bidderSettings={storageAllowed:!0},this.debugPlacementId=e.debugPlacementId,this.isDebugMode="1"===y.get("appnexusast_debug_mode")}get bidderName(){return zd.bidderName}prepareConfigForAdUnit(e,{placementId:t}){return{code:e,mediaTypes:{video:{context:"instream",playerSize:[640,480]}},bids:[{bidder:this.bidderName,params:{placementId:this.isDebugMode?this.debugPlacementId:t,keywords:Object.assign({},this.getTargeting(e)),video:{skippable:!1,playback_method:["auto_play_sound_off"],placement:Dd.IN_ARTICLE,plcmt:xd.ACCOMPANYING_CONTENT}}}]}}}zd.bidderName="appnexusAst";class Vd extends Ld{constructor(e){super(e)}get bidderName(){return Vd.bidderName}prepareConfigForAdUnit(e,{sizes:t,inScreen:i}){return{code:e,mediaTypes:{banner:{sizes:this.filterSizesForRefreshing(e,t)}},bids:[{bidder:this.bidderName,params:{inScreen:i}}]}}}Vd.bidderName="gumgum";class Md extends Ld{constructor(e){super(e),this.aliases={ix:[Md.bidderName]},this.bidderSettings={storageAllowed:!0}}get bidderName(){return Md.bidderName}prepareConfigForAdUnit(e,{sizes:t,siteId:i}){if(O.get(`slots.${e}.isVideo`))return this.getVideoConfig(e,i);const n=this.filterSizesForRefreshing(e,t);return this.getStandardConfig(e,{sizes:n,siteId:i})}getVideoConfig(e,t){return{code:e,mediaTypes:{video:{context:"instream",placement:Dd.IN_ARTICLE,playerSize:[640,480],plcmt:xd.ACCOMPANYING_CONTENT}},ortb2Imp:this.extendOrtbWithJwpRtdDataWhenStrategyRulesEnabled(this.getOrtb2Imp(e)),bids:[{bidder:this.bidderName,params:{siteId:t,size:[640,480],video:{context:"instream",playerSize:[640,480],mimes:["video/mp4","video/x-flv","video/webm","video/ogg","application/javascript"],minduration:1,maxduration:30,protocols:[2,3,5,6],api:[2],w:640,h:480}}}]}}getStandardConfig(e,{sizes:t,siteId:i}){return{code:e,mediaTypes:{banner:{sizes:t}},ortb2Imp:this.getOrtb2Imp(e),bids:this.getBids(t,i)}}getBids(e,t){return Array.isArray(t)&&t.length>0?this.getBidsForMultipleSiteIds(e,t):e.map((e=>({bidder:this.bidderName,params:{siteId:t,size:e}})))}getBidsForMultipleSiteIds(e,t){return t.map(((t,i)=>({bidder:this.bidderName,params:{size:e[i],siteId:t}})))}extendOrtbWithJwpRtdDataWhenStrategyRulesEnabled(e){const t=O.get("options.video.enableStrategyRules"),i=O.get("options.video.jwplayer.initialMediaId");return t?{ext:Object.assign(Object.assign({},e.ext),{data:{jwTargeting:{mediaID:i}}})}:e}}Md.bidderName="indexExchange";class Ud extends Ld{constructor(e){super(e),this.bidderSettings={storageAllowed:!0}}get bidderName(){return Ud.bidderName}prepareConfigForAdUnit(e,{sizes:t,placementId:i}){return{code:e,mediaTypes:{banner:{sizes:t}},bids:this.getBids(i)}}getBids(e){return Array.isArray(e)&&e.length>0?e.map((e=>({bidder:this.bidderName,params:{placementId:e}}))):[{bidder:this.bidderName,params:{placementId:e}}]}}Ud.bidderName="kargo";class jd extends Ld{constructor(e){super(e),this.accountId=e.accountId}get bidderName(){return jd.bidderName}prepareConfigForAdUnit(e,{sizes:t}){let i={banner:{sizes:this.filterSizesForRefreshing(e,t)}};return"featured"===e&&(i={video:{playerSize:t[0],context:"instream",api:[2],linearity:1,mimes:["video/mp4","video/x-flv","video/webm","video/ogg"],maxduration:30,minduration:1,protocols:[2,3,5,6],placement:Dd.IN_ARTICLE,plcmt:xd.ACCOMPANYING_CONTENT}}),{code:e,mediaTypes:i,ortb2Imp:this.getOrtb2Imp(e),bids:[{bidder:this.bidderName,params:{}}]}}}jd.bidderName="mgnipbs";class Bd extends Ld{constructor(e){super(e)}get bidderName(){return Bd.bidderName}prepareConfigForAdUnit(e,{sizes:t,cid:i,crid:n}){if(O.get(`slots.${e}.isVideo`))return this.getVideoConfig(e,i,n);const s=this.filterSizesForRefreshing(e,t);return this.getStandardConfig(e,s,i,n)}getVideoConfig(e,t,i){return{code:e,mediaTypes:{video:{playerSize:[640,480],context:"instream",api:[2],linearity:1,mimes:["video/mp4","video/x-flv","video/webm","video/ogg"],maxduration:30,protocols:[2,3,5,6],playbackmethod:[2,3],placement:Dd.IN_ARTICLE,plcmt:xd.ACCOMPANYING_CONTENT}},ortb2Imp:this.getOrtb2Imp(e),bids:[{bidder:this.bidderName,params:{cid:t,crid:i,video:{w:"640",h:"480",mimes:["video/mp4","video/x-flv","video/webm","video/ogg"],playbackmethod:[2,3],maxduration:30,minduration:1,startdelay:0}}}]}}getStandardConfig(e,t,i,n){return{code:e,mediaTypes:{banner:{sizes:t}},ortb2Imp:this.getOrtb2Imp(e),bids:[{bidder:this.bidderName,params:{cid:i,crid:n}}]}}}Bd.bidderName="medianet";class $d extends Ld{constructor(e){super(e),this.bidderSettings={storageAllowed:!0}}get bidderName(){return $d.bidderName}prepareConfigForAdUnit(e,{sizes:t,siteId:i}){return{code:e,mediaTypes:{banner:{sizes:t}},bids:[{bidder:this.bidderName,params:{siteId:i}}]}}}$d.bidderName="nobid";class Fd extends Ld{constructor(e){super(e)}get bidderName(){return Fd.bidderName}prepareConfigForAdUnit(e,{adUnitId:t,assetKey:i,sizes:n}){return{code:e,mediaTypes:{banner:{sizes:this.filterSizesForRefreshing(e,n)}},bids:[{bidder:this.bidderName,params:{assetKey:i,adUnitId:t,skipSizeCheck:!0}}]}}}Fd.bidderName="ogury";class Hd extends Ld{constructor(e){super(e),this.delDomain=e.delDomain}get bidderName(){return Hd.bidderName}prepareConfigForAdUnit(e,{sizes:t,unit:i}){return O.get(`slots.${e}.isVideo`)?this.getVideoConfig(e,i):this.getStandardConfig(e,t,i)}getVideoConfig(e,t){return{code:e,mediaTypes:{video:{context:"instream",mimes:["video/mp4","video/x-flv"],playerSize:[640,480],placement:Dd.IN_ARTICLE,plcmt:xd.ACCOMPANYING_CONTENT}},ortb2Imp:this.getOrtb2Imp(e),bids:[{bidder:this.bidderName,params:{unit:t,delDomain:this.delDomain}}]}}getStandardConfig(e,t,i){return{code:e,mediaTypes:{banner:{sizes:this.filterSizesForRefreshing(e,t)}},ortb2Imp:this.getOrtb2Imp(e),bids:[{bidder:this.bidderName,params:{unit:i,delDomain:this.delDomain}}]}}}Hd.bidderName="openx";class Gd extends Ld{constructor(e){super(e),this.testGroup=Math.floor(100*Math.random()).toString(),this.customTargeting={s1:[O.get("wiki.targeting.wikiIsTop1000")?us.get("s1")||"":"not a top1k wiki"],lang:[us.get("wikiLanguage")||us.get("lang")||"en"],testgroup:this.testGroup},this.dcn=e.dcn,this.enabled&&this.setTargeting()}get bidderName(){return Gd.bidderName}setTargeting(){const e=O.get("bidders.prebid.ozone");e&&e.slots&&(Object.keys(e.slots).forEach((e=>{us.set("testgroup",this.testGroup,e)})),_i.on($s,(t=>{t.adProduct&&"none"!==t.adProduct&&Object.keys(e.slots).forEach((e=>{us.remove("testgroup",e)}))})))}prepareConfigForAdUnit(e,{sizes:t,pos:i,placementId:n}){return{code:e,mediaTypes:{banner:{sizes:this.filterSizesForRefreshing(e,t)}},bids:[{bidder:"ozone",params:{publisherId:"OZONEFAN0001",siteId:"1500000156",placementId:n,pos:i,customData:[{settings:{},targeting:Object.assign({},this.getTargeting(e,this.customTargeting))}]}}]}}}Gd.bidderName="ozone";class qd extends Ld{constructor(e){super(e),this.publisherId=e.publisherId}get bidderName(){return qd.bidderName}setMaximumAdSlotHeight(e,t){super.setMaximumAdSlotHeight(e,t);const i=O.get(`bidders.prebid.${this.bidderName}.slots.${e}.ids`);if(!i)return;const n=i.filter((e=>{const i=this.extractSizeFromString(e,this.bidderName);return!(i&&i[1]>t)}));O.set(`bidders.prebid.${this.bidderName}.slots.${e}.ids`,n)}prepareConfigForAdUnit(e,{sizes:t,ids:i}){if(O.get(`slots.${e}.isVideo`))return this.getVideoConfig(e,i);const n=this.filterSizesForRefreshing(e,t);return this.getStandardConfig(e,n,i)}getVideoConfig(e,t){const i={video:{mimes:["video/mp4","video/x-flv","video/webm","video/ogg"],skippable:!0,minduration:1,maxduration:30,startdelay:0,playbackmethod:[2,3],api:[2],protocols:[2,3,5,6],linearity:1,placement:Dd.IN_ARTICLE,plcmt:xd.ACCOMPANYING_CONTENT}};return{code:e,mediaTypes:{video:{playerSize:[640,480],context:"instream",placement:Dd.IN_ARTICLE}},bids:this.getBids(t,i)}}getStandardConfig(e,t,i){return{code:e,mediaTypes:{banner:{sizes:t}},bids:this.getBids(i)}}getBids(e,t={}){if(e)return e.map((e=>({bidder:this.bidderName,params:Object.assign({adSlot:e,publisherId:this.publisherId},t)})))}}qd.bidderName="pubmatic";class Wd extends Ld{constructor(e){super(e),this.aliases={ix:[Wd.bidderName]},this.bidderSettings={storageAllowed:!0}}get bidderName(){return Wd.bidderName}prepareConfigForAdUnit(e,{sizes:t,siteId:i}){if(O.get(`slots.${e}.isVideo`))return this.getVideoConfig(e,i);const n=this.filterSizesForRefreshing(e,t);return this.getStandardConfig(e,{sizes:n,siteId:i})}getVideoConfig(e,t){return{code:e,mediaTypes:{video:{context:"instream",placement:Dd.IN_ARTICLE,playerSize:[640,480],plcmt:xd.ACCOMPANYING_CONTENT}},ortb2Imp:this.getOrtb2Imp(e),bids:[{bidder:this.bidderName,params:{siteId:t,size:[640,480],video:{mimes:["video/mp4","video/x-flv","video/webm","video/ogg","application/javascript"],minduration:1,maxduration:30,protocols:[2,3,5,6],api:[2]}}}]}}getStandardConfig(e,{sizes:t,siteId:i}){return{code:e,mediaTypes:{banner:{sizes:t}},ortb2Imp:this.getOrtb2Imp(e),bids:t.map((e=>({bidder:this.bidderName,params:{siteId:i,size:e}})))}}}Wd.bidderName="roundel";class Kd extends Ld{constructor(e){super(e),this.accountId=e.accountId,this.customTargeting={s1:[O.get("wiki.targeting.wikiIsTop1000")?us.get("s1")||"":"not a top1k wiki"],lang:[us.get("wikiLanguage")||us.get("lang")||"en"]}}get bidderName(){return Kd.bidderName}prepareConfigForAdUnit(e,{siteId:t,zoneId:i,sizeId:n,position:s}){return"featured"!==e||O.get("custom.hasFeaturedVideo")?{code:e,mediaTypes:{video:{playerSize:[640,480],context:"instream",api:[2],linearity:1,mimes:["video/mp4","video/x-flv","video/webm","video/ogg"],maxduration:30,protocols:[2,3,5,6],placement:Dd.IN_ARTICLE,plcmt:xd.ACCOMPANYING_CONTENT}},ortb2Imp:this.getOrtb2Imp(e),bids:[{bidder:this.bidderName,params:{position:s,siteId:t,zoneId:i,accountId:this.accountId,name:e,inventory:Object.assign({},this.getTargeting(e,this.customTargeting)),video:{playerWidth:"640",playerHeight:"480",size_id:n,language:this.customTargeting.lang[0]}}}]}:null}}Kd.bidderName="rubicon";class Yd extends Ld{constructor(e){super(e),this.aliases={rubicon:[Yd.bidderName]},this.accountId=e.accountId,this.customTargeting={s1:[O.get("wiki.targeting.wikiIsTop1000")?us.get("s1")||"":"not a top1k wiki"],lang:[us.get("wikiLanguage")||us.get("lang")||"en"]}}get bidderName(){return Yd.bidderName}prepareConfigForAdUnit(e,{siteId:t,zoneId:i,sizes:n,position:s,targeting:r}){return{code:e,mediaTypes:{banner:{sizes:this.filterSizesForRefreshing(e,n)}},ortb2Imp:this.getOrtb2Imp(e),bids:this.getBids(e,s,t,i,r)}}getBids(e,t,i,n,s){return Array.isArray(n)&&n.length>0?n.map((n=>({bidder:this.bidderName,params:{position:t,siteId:i,zoneId:n,accountId:this.accountId,name:e,keywords:["rp.fastlane"],inventory:Object.assign({},this.getTargeting(e,Object.assign(Object.assign({},s||{}),this.customTargeting)))}}))):[{bidder:this.bidderName,params:{position:t,siteId:i,zoneId:n,accountId:this.accountId,name:e,keywords:["rp.fastlane"],inventory:Object.assign({},this.getTargeting(e,Object.assign(Object.assign({},s||{}),this.customTargeting)))}}]}}Yd.bidderName="rubicon_display";class Qd extends Ld{constructor(e){super(e)}get bidderName(){return Qd.bidderName}prepareConfigForAdUnit(e,{sizes:t,publisherId:i,adUnitId:n,placement:s="inBanner"}){return O.get(`slots.${e}.isVideo`)?this.getVideoConfig(e,i,n):{code:e,mediaTypes:{banner:{sizes:this.filterSizesForRefreshing(e,t)}},bids:[{bidder:this.bidderName,params:{publisherId:i,adUnitId:n,placement:s}}]}}getVideoConfig(e,t,i){return{code:e,mediaTypes:{video:{playerSize:[640,480],context:"instream",mimes:["video/mp4","video/x-flv","video/webm","video/ogg"],skip:1,minduration:1,maxduration:30,startdelay:0,playbackmethod:[2,3],linearity:1,placement:Dd.IN_ARTICLE,plcmt:xd.ACCOMPANYING_CONTENT}},bids:[{bidder:this.bidderName,params:{publisherId:t,adUnitId:i,placement:"inStream"}}]}}}Qd.bidderName="seedtag";class Jd extends Ld{constructor(e){super(e),this.aliases={},this.aliases[O.get("bidders.prebid.testBidder.name")]=[Jd.bidderName]}get bidderName(){return Jd.bidderName}prepareConfigForAdUnit(e,{sizes:t,parameters:i}){if(O.get(`slots.${e}.isVideo`))return this.getVideoConfig(e,i);const n=this.filterSizesForRefreshing(e,t);return this.getStandardConfig(e,{sizes:n,parameters:i})}getVideoConfig(e,t){return{code:e,mediaTypes:{video:{context:"instream",playerSize:[640,480]}},ortb2Imp:this.getOrtb2Imp(e),bids:[{bidder:this.bidderName,params:Object.assign({},t)}]}}getStandardConfig(e,{sizes:t,parameters:i}){return{code:e,mediaTypes:{banner:{sizes:t}},ortb2Imp:this.getOrtb2Imp(e),bids:[{bidder:this.bidderName,params:Object.assign({},i)}]}}}Jd.bidderName="testBidder";class Xd extends Ld{constructor(e){super(e),this.bidderSettings={storageAllowed:!0}}get bidderName(){return Xd.bidderName}setMaximumAdSlotHeight(e,t){super.setMaximumAdSlotHeight(e,t);const i=O.get(`bidders.prebid.${this.bidderName}.slots.${e}.inventoryCodes`);if(!i)return;const n=i.filter((e=>{const i=this.extractSizeFromString(e,this.bidderName);return!(i&&i[1]>t)}));O.set(`bidders.prebid.${this.bidderName}.slots.${e}.inventoryCodes`,n)}prepareConfigForAdUnit(e,{sizes:t,inventoryCodes:i}){if(i)return{code:e,mediaTypes:{banner:{sizes:this.filterSizesForRefreshing(e,t)}},ortb2Imp:this.getOrtb2Imp(e),bids:i.map((e=>({bidder:this.bidderName,params:{inventoryCode:e}})))}}}Xd.bidderName="triplelift";class Zd extends Ld{constructor(e){super(e),this.dcn=e.dcn}get bidderName(){return Zd.bidderName}prepareConfigForAdUnit(e,{sizes:t,pos:i}){return{code:e,mediaTypes:{banner:{sizes:this.filterSizesForRefreshing(e,t)}},bids:[{bidder:this.bidderName,params:{pos:i,dcn:this.dcn}}]}}}Zd.bidderName="verizon";class el extends Ld{constructor(e){super(e),this.accountId="647765b7705d4fca3b3e1d58",this.bidderSettings={storageAllowed:!0}}get bidderName(){return el.bidderName}prepareConfigForAdUnit(e,{sizes:t,placementId:i}){return{code:e,mediaTypes:{banner:{sizes:this.filterSizesForRefreshing(e,t)}},ortb2Imp:this.getOrtb2Imp(e),bids:[{bidder:this.bidderName,params:{placementId:i,accountId:this.accountId,pbsHost:"webads-pbs.relevant-digital.com"}}]}}}function tl(e){return e&&O.get("options.geoRequiresConsent")}function il(e="Acme Corporation",t="Fandom Inc.",i=0){return{dsa:{behalf:e,paid:t,transparency:[{domain:"fandom.com",dsaparams:[1,2,3]}],adrender:i}}}el.bidderName="relevantdigital";const nl=y.get("wikia_adapter"),sl=parseInt(y.get("wikia_adapter_limit"),10)||99,rl=parseInt(y.get("wikia_adapter_timeout"),10)||100,ol="1"===y.get("wikia_adapter_random"),al="1"===y.get("wikia_adapter_dsa");class dl extends Ld{constructor(e){super(e),this.enabled=!!nl,this.limit=sl,this.timeout=rl,this.useRandomPrice=ol,this.isCustomBidAdapter=!0}static getCreative(e,t){const i=document.createElement("div");i.style.background="#00b7e0",i.style.color="#fff",i.style.fontFamily="sans-serif",i.style.width=`${e[0]}px`,i.style.height=`${e[1]}px`,i.style.textAlign="center";const n=document.createElement("p");n.innerText="Wikia Creative",n.style.fontWeight="bold",n.style.margin="0",n.style.paddingTop="10px";const s=document.createElement("small");return s.innerText=`cpm: ${t}, size: ${e.join("x")}`,i.appendChild(n),i.appendChild(s),i.outerHTML}get bidderName(){return dl.bidderName}prepareConfigForAdUnit(e,{sizes:t}){if(O.get(`slots.${e}.isNative`))return this.prepareNativeConfig(Nd.getPrebidNativeTemplate(),e);{const i=this.filterSizesForRefreshing(e,t);return this.prepareStandardConfig(e,{sizes:i})}}prepareNativeConfig(e,t){return{code:t,mediaTypes:{native:{sendTargetingKeys:!1,adTemplate:e,title:{required:!0},body:{required:!0},clickUrl:{required:!0},displayUrl:{required:!1},image:{required:!1,aspect_ratios:[{min_width:100,min_height:100,ratio_width:1,ratio_height:1}]}}},ortb2Imp:this.getOrtb2Imp(t),bids:[{bidder:this.bidderName,params:{}}]}}prepareStandardConfig(e,{sizes:t}){return{code:e,mediaTypes:{banner:{sizes:t}},ortb2Imp:this.getOrtb2Imp(e),bids:[{bidder:this.bidderName,params:{}}]}}getSpec(){return{code:this.bidderName,supportedMediaTypes:["banner","native"]}}getPrice(){return this.useRandomPrice?Math.floor(2e3*Math.random())/100:parseInt(nl,10)/100}callBids(e,t,i){this.addBids(e,t,i)}addBids(e,t,i){setTimeout((()=>c(this,void 0,void 0,(function*(){const n=yield Mr.init();e.bids.map((i=>{var s;0!==this.limit&&(t(i.adUnitCode,(null===(s=i.mediaTypes)||void 0===s?void 0:s.native)?this.createNativeBidResponse(n,i,e):this.createStandardBidResponse(n,i,e)),this.limit-=1)})),i()}))),this.timeout)}createNativeBidResponse(e,t,i){const n=e.createBid(1),s=this.getPrice();return n.auctionId=i.auctionId,n.adUnitCode=t.adUnitCode,n.adUnitId=t.adUnitId,n.bidderCode=i.bidderCode,n.bidderRequestId=i.bidderRequestId,n.transactionId=t.transactionId,n.cpm=s,n.ttl=300,n.mediaType="native",n.native={body:"Wikia is an old name of Fandom. Haven't heard of Fandom?",clickTrackers:["https://track-click.url"],clickUrl:"https://fandom.com",url:"https://fandom.com",image:{url:"https://placekitten.com/100/100",height:100,width:100},impressionTrackers:["https://track-impression.url"],title:"Wikia Native Creative"},tl(al)&&(n.meta=il()),n}createStandardBidResponse(e,t,i){const n=e.createBid(1),[s,r]=t.sizes[0],o=this.getPrice();return n.ad=dl.getCreative(t.sizes[0],o),n.adUnitCode=t.adUnitCode,n.adUnitId=t.adUnitId,n.auctionId=i.auctionId,n.bidderCode=i.bidderCode,n.bidderRequestId=i.bidderRequestId,n.transactionId=t.transactionId,n.cpm=o,n.ttl=300,n.mediaType="banner",n.width=s,n.height=r,tl(al)&&(n.meta=il()),n}}dl.bidderName="wikia";const ll=y.get("wikia_video_adapter"),cl=parseInt(y.get("wikia_adapter_limit"),10)||99,ul=parseInt(y.get("wikia_adapter_timeout"),10)||100,pl="1"===y.get("wikia_adapter_random"),hl="1"===y.get("wikia_adapter_dsa");class gl extends Ld{constructor(e){super(e),this.enabled=!!ll,this.limit=cl,this.timeout=ul,this.useRandomPrice=pl,this.isCustomBidAdapter=!0}static getVastUrl(e,t,i){return eo(0,i,{videoAdUnitId:O.get(`bidders.prebid.wikiaVideo.slots.${i}.videoAdUnitId`),customParams:O.get(`bidders.prebid.wikiaVideo.slots.${i}.customParams`)})}get bidderName(){return gl.bidderName}prepareConfigForAdUnit(e){return{code:e,mediaTypes:{video:{context:"outstream",playerSize:[640,480]}},ortb2Imp:this.getOrtb2Imp(e),bids:[{bidder:this.bidderName,params:{}}]}}getSpec(){return{code:this.bidderName,supportedMediaTypes:["video"]}}getPrice(){return this.useRandomPrice?Math.floor(20*Math.random()):parseInt(ll,10)/100}callBids(e,t,i){this.addBids(e,t,i)}addBids(e,t,i){setTimeout((()=>c(this,void 0,void 0,(function*(){const n=yield Mr.init();e.bids.forEach((i=>{if(0===this.limit)return;const s=n.createBid(1),[r,o]=i.sizes[0],a=i.adUnitCode;s.auctionId=e.auctionId,s.adUnitCode=i.adUnitCode,s.adUnitId=i.adUnitId,s.bidderCode=e.bidderCode,s.bidderRequestId=e.bidderRequestId,s.cpm=this.getPrice(),s.creativeId="foo123_wikiaVideoCreativeId",s.ttl=300,s.mediaType="video",s.width=r,s.height=o,s.transactionId=i.transactionId,s.vastUrl=gl.getVastUrl(r,o,a),s.videoCacheKey="123foo_wikiaVideoCacheKey",tl(hl)&&(s.meta=il()),t(i.adUnitCode,s),this.limit-=1})),i()}))),this.timeout)}}gl.bidderName="wikiaVideo";class ml extends Ld{constructor(e){super(e)}get bidderName(){return ml.bidderName}prepareConfigForAdUnit(e,{sizes:t,pubId:i}){const n=this.filterSizesForRefreshing(e,t);return this.getStandardConfig(e,n,i)}getStandardConfig(e,t,i){return{code:e,mediaTypes:{banner:{sizes:t}},ortb2Imp:this.getOrtb2Imp(e),bids:this.getBids(i)}}getBids(e){return e.map((e=>({bidder:this.bidderName,params:{pubId:e}})))}}ml.bidderName="yahoossp";const fl="video";function vl(e){return c(this,arguments,void 0,(function*(e,t=null){let i={};const n=O.get("bidders.prebid.priceFloor"),s=yield function(e){return c(this,void 0,void 0,(function*(){return((yield Mr.init()).getBidResponsesForAdUnitCode(e).bids||[]).filter((e=>function(e){return e.getStatusCode&&1===e.getStatusCode()}(e)&&"rendered"!==e.status))}))}(e);if(s.length){let e=null;s.forEach((i=>{t&&t!==i.bidderCode||n&&"object"==typeof n&&n[`${i.width}x${i.height}`]&&i.cpm<parseFloat(n[`${i.width}x${i.height}`])||(e=e?e.cpm===i.cpm?e.timeToRespond>i.timeToRespond?i:e:e.cpm<i.cpm?i:e:i)})),e&&(i=e.adserverTargeting)}const{hb_adid:r}=i;if(r){const t=yield function(e,t){return c(this,void 0,void 0,(function*(){const i=yield function(e,t){return c(this,void 0,void 0,(function*(){const i=yield Mr.init(),{bids:n}=i.getBidResponsesForAdUnitCode(e),s=n.filter((e=>t===e.adId));return s.length?s[0]:null}))}(e,t);return i&&i.mediaType===fl?i.videoCacheKey:"disabled"}))}(e,r);t&&(i.hb_uuid=t)}return i||{}}))}function bl(e,t,i){return c(this,void 0,void 0,(function*(){const n=yield Mr.init();yield bo.initialize(n),n.requestBids({adUnits:e,bidsBackHandler:t,timeout:i})}))}const yl=new class{constructor(){this.adapters=new Map,this.availableAdapters=[Rd,zd,Vd,Md,Ud,jd,Bd,$d,Fd,Hd,Gd,qd,Wd,Kd,Yd,Qd,Jd,Xd,Zd,el,dl,gl,ml]}getAdapter(e){return this.getAdapters().get(e)}getAdapters(){if(!this.adapters.size){const e=O.get("bidders.prebid");this.availableAdapters.forEach((t=>{const i=e[t.bidderName];(function(e){if("object"!=typeof e)return!1;const t="boolean"==typeof e.enabled,i="object"==typeof e.slots;return t&&i})(i)&&this.adapters.set(t.bidderName,new t(i))}))}return this.adapters}configureAdapters(){this.getAdapters().forEach((e=>{const t=e.aliases;t&&this.configureAliases(t),e.isCustomBidAdapter&&this.configureCustomAdapter(e.bidderName,e)}))}setupAdUnits(e){const t=[];return yl.getAdapters().forEach((i=>{i&&i.enabled&&i.prepareAdUnits().forEach((i=>{var n;i&&(n=i.bids)&&Array.isArray(n)&&n.length>0&&function(e){const t=O.get(`slots.${e}`)?Qr.getState(e):function(e,t){return Object.keys(O.get("slots")).some((t=>So(t,void 0)===e&&Qr.getState(t)))}(e);return("static"!==O.get("bidders.prebid.filter")||e.includes("video")||null!==document.querySelector(`div[id="${e}"]`))&&t}(i.code)&&Eo(i.code,e)&&t.push(i)}))})),t.filter((e=>{var t,i;return!(null===(i=null===(t=null==e?void 0:e.mediaTypes)||void 0===t?void 0:t.banner)||void 0===i?void 0:i.sizes)||e.mediaTypes.banner.sizes.length>0}))}configureAliases(e){return c(this,void 0,void 0,(function*(){const t=yield Mr.init();Object.keys(e).forEach((i=>e[i].forEach((e=>t.aliasBidder(i,e)))))}))}configureCustomAdapter(e,t){return c(this,void 0,void 0,(function*(){return(yield Mr.init()).registerBidAdapter((()=>t),e)}))}},Sl="Id5",wl=new class{constructor(){this.partnerId=1139}isEnabled(){return O.get("bidders.prebid.id5")&&O.get("options.trackingOptIn")&&!O.get("options.optOutSale")&&!is()}getConfig(){if(!this.isEnabled())return void Wn(Sl,"disabled");Wn(Sl,"enabled");const e={name:"id5Id",params:{partner:this.partnerId},storage:{type:"html5",name:"id5id",expires:90,refreshInSeconds:28800}};return Wn(Sl,"config",e),e}},_l="LiveIntentConnectedId",El=new class{constructor(){this.publisherIds={gamefaqs:"79973",gamespot:"79973",comicvine:"79973",f2:"79968","ucp-desktop":"79968","ucp-mobile":"79968",tvguide:"79974",giantbomb:"85122",metacritic:"85123","metacritic-neutron":"85123",fanatical:"85124",sports:"85125"}}getPublisherId(){const e=window.ads.context.app;return this.publisherIds[e]}getConfig(){if(!this.isEnabled())return window.liModuleEnabled=!1,void Wn(_l,"disabled");const e=this.getPublisherId();if(e)return window.liModuleEnabled=!0,Wn(_l,"enabled"),{name:"liveIntentId",params:{publisherId:e,requestedAttributesOverrides:{uid2:!0,bidswitch:!0,medianet:!0,magnite:!0,pubmatic:!0,index:!0,openx:!0,thetradedesk:!0,sovrn:!0},ajaxTimeout:1e3,liCollectConfig:{fpiStorageStrategy:"ls",fpiExpirationDays:730}},storage:{name:"__tamLIResolveResult",type:"html5",expires:1}};Wn(_l,"Invalid app id")}isEnabled(){return O.get("bidders.liveIntentConnectedId.enabled")&&!O.get("options.optOutSale")&&!is()}},Tl="LiveRamp";class Il{}Il.PLACEMENT_ID="2161",Il.ENVELOPE_STORAGE_NAME="idl_env";const Al=new class{getConfig(){if(this.isEnabled())return Wn(Tl,"enabled"),{name:"identityLink",params:{pid:Il.PLACEMENT_ID},storage:{type:"html5",name:Il.ENVELOPE_STORAGE_NAME,expires:1,refreshInSeconds:1800}};Wn(Tl,"disabled")}isEnabled(){return O.get("bidders.liveRampId.enabled")&&!O.get("options.optOutSale")&&!is()}},Cl="prebid-data-tracking",Ol=new class{constructor(){this.bidsRefreshing={slots:[],bidsBackHandler:()=>{}},this.isConfigured=!1,this.adUnits=[]}configure(e){e&&e.length>0&&(this.adUnits=[...this.adUnits,...e]),this.isConfigured||(this.isConfigured=!0,this.registerBidsRefreshing(),this.registerBidsTracking(),this.enableATSAnalytics())}registerBidsRefreshing(){return c(this,void 0,void 0,(function*(){var e;const t=yield Mr.init();this.bidsRefreshing=null!==(e=O.get("bidders.prebid.bidsRefreshing"))&&void 0!==e?e:this.bidsRefreshing,t.onEvent("bidWon",(e=>{-1!==this.bidsRefreshing.slots.indexOf(e.adUnitCode)&&(_i.emit(fr,{refreshedSlotNames:[e.adUnitCode]}),bl(this.adUnits.filter((t=>t.code===e.adUnitCode&&t.bids&&t.bids[0]&&(t.bids[0].bidder===e.bidderCode||(t=>"mgnipbs"===t.bids[0].bidder&&"s2s"===(null==e?void 0:e.source))(t)))),this.bidsRefreshing.bidsBackHandler,2e3))})),Wn(Cl,"Bids refreshing configured")}))}registerBidsTracking(){return c(this,void 0,void 0,(function*(){const e=yield Mr.init(),t=(e,t)=>{if(Wn(Cl,"Checking DSA data in slot "+this.getRealSlotName(e,t)+" for bid",e),function(e){var t,i,n,s;return"string"==typeof(null===(i=null===(t=e.meta)||void 0===t?void 0:t.dsa)||void 0===i?void 0:i.behalf)&&"number"==typeof(null===(s=null===(n=e.meta)||void 0===n?void 0:n.dsa)||void 0===s?void 0:s.adrender)}(e)){const i=this.getRealSlotName(e,t),n=function(e,t){var i,n,s,r,o;const a=null===(n=null===(i=e.meta)||void 0===i?void 0:i.dsa)||void 0===n?void 0:n.behalf;return{behalf:a,paid:null!==(o=null===(r=null===(s=e.meta)||void 0===s?void 0:s.dsa)||void 0===r?void 0:r.paid)&&void 0!==o?o:a,slot:t}}(e,Qr.get(i));_i.emit(wr,n)}};e.onEvent("bidResponse",(e=>{_i.emit(vr,{bidResponse:this.mapResponseToTrackingBidDefinition(e)})})),e.onEvent("adRenderSucceeded",(e=>{bo.reportPrebidWin(e.bid),t(e.bid,e.doc)})),Wn(Cl,"Bids tracking configured")}))}enableATSAnalytics(){this.isLiveRampEnabled()&&(Wn(Cl,"prebid enabling ATS Analytics"),window.pbjs.que.push((()=>{window.pbjs.enableAnalytics([{provider:"atsAnalytics",options:{pid:Il.PLACEMENT_ID}}])})))}isLiveRampEnabled(){return O.get("bidders.liveRampATSAnalytics.enabled")&&O.get("bidders.liveRampId.enabled")}mapResponseToTrackingBidDefinition(e){var t;return Wn(Cl,"Response: ",e),{bidderName:e.bidderCode,price:e.cpm.toString(),responseTimestamp:e.responseTimestamp,slotName:_o(e.adUnitCode),size:e.size,timeToRespond:e.timeToRespond,additionalInfo:(null===(t=null==e?void 0:e.meta)||void 0===t?void 0:t.dsa)?{dsa:e.meta.dsa}:void 0}}getRealSlotName(e,t){var i,n,s,r,o;const a=_o(e.adUnitCode);return["incontent_leaderboard","incontent_boxad","top_boxad"].includes(a)&&null!==(o=null===(r=null===(s=null===(n=null===(i=null==t?void 0:t.defaultView)||void 0===i?void 0:i.frameElement)||void 0===n?void 0:n.parentElement)||void 0===s?void 0:s.parentElement)||void 0===r?void 0:r.id)&&void 0!==o?o:a}};const Pl="prebid-price-floors-mechanism",kl=new class{getPriceFloors(){if(!this.isEnabled())return void Wn(Pl,"disabled");let e;if(Wn(Pl,"enabled"),O.get("bidders.prebid.priceFloors.identityBasedConfig")?e=this.getConfigBasedOnIdentityPartners():O.get("bidders.prebid.priceFloors.config")&&(e=this.getSimpleConfig()),!e||0===Object.keys(e).length)return void Wn(Pl,"something went wrong when parsing config");Wn(Pl,"config before mapping",e);const t=this.mapConfigKeysToBannerMediaType(e);return Wn(Pl,"config after mapping",t),{floors:{enforcement:{floorDeals:!0},data:{skipRate:0,currency:"USD",schema:{fields:["mediaType","bidderType"]},values:t},additionalSchemaFields:{bidderType:this.bidderType}}}}isEnabled(){return O.get("bidders.prebid.priceFloors.enabled")}bidderType(e){return null==e?void 0:e.bidder}mapConfigKeysToBannerMediaType(e){const t={};for(const[i,n]of Object.entries(e))t["banner|"+i]=n;return t}getSimpleConfig(){Wn(Pl,"old config strategy");const e=O.get("bidders.prebid.priceFloors.config");if(Wn(Pl,"config provided from ICBM variable",e),this.isConfigCorrect(e))return e}getConfigBasedOnIdentityPartners(){Wn(Pl,"identity partners based config strategy");const e=O.get("bidders.prebid.priceFloors.identityBasedConfig");if(Wn(Pl,"config provided from ICBM variable",e),!this.isConfigCorrect(e))return;const t=this.getEnabledIdentityPartners(),i=t.join("-");Wn(Pl,"enabled partners",t);const n={};for(const[t,s]of Object.entries(e)){const e=s[i];e&&"number"==typeof parseFloat(e)&&(n[t]=parseFloat(e))}return n}isConfigCorrect(e){return e&&0!==Object.keys(e).length?"object"==typeof e||(Wn(Pl,"invalid config provided"),!1):(Wn(Pl,"no config provided"),!1)}getEnabledIdentityPartners(){const e=[];return O.get("bidders.prebid.id5")&&e.push("id5"),O.get("bidders.liveIntentConnectedId.enabled")&&e.push("liveintent"),O.get("bidders.prebid.yahooConnectId.enabled")&&e.push("yahoo"),e.sort(),e}};function Nl(e){return 0===e?0:e<1?1:Math.floor(e)}function Ll(e){return e?parseFloat(e).toFixed(2):""}class Rl{constructor(){this.ID_STRING_LENGTH=16,this.logGroup="bidder-id-retriever",this.ID_MAP={[Rl.YAHOO_BIT.toString()]:e=>this.getDefaultBitStatus(e,"yahoo.com"),[Rl.ID5_BIT.toString()]:e=>this.getDefaultBitStatus(e,"id5-sync.com"),[Rl.HEM_BIT.toString()]:()=>this.getHEMBitStatus(),[Rl.LIVEINTENT_BIT.toString()]:e=>this.getDefaultBitStatus(e,"liveintent.com"),[Rl.PUBCID_BIT.toString()]:e=>this.getDefaultBitStatus(e,"pubcid.org")}}static get(){var e;return null!==(e=this._instance)&&void 0!==e?e:this._instance=new Rl}generateBoiString(){return c(this,void 0,void 0,(function*(){const e=yield this.getIds();let t="";for(let i=0;i<this.ID_STRING_LENGTH;i++){const n=this.ID_MAP[i.toString()];t+=n?n(e):this.getBitPlaceholder()}return Wn(this.logGroup,"Generated BOI string ",t),t}))}getIds(){return c(this,void 0,void 0,(function*(){var e;return Wn(this.logGroup,"Retrieving tracking ids"),null!==(e=(yield Mr.init()).getUserIdsAsEids())&&void 0!==e?e:[]}))}saveCurrentPrebidIds(){return c(this,void 0,void 0,(function*(){const e=yield this.getIds();Wn(this.logGroup,"Saving tracking ids",e),e.forEach((e=>{var t,i,n;Wn(this.logGroup,"Saving tracking id provided by ",e.source,null===(t=e.uids[0])||void 0===t?void 0:t.id),(null===(i=e.uids[0])||void 0===i?void 0:i.id)&&_i.emit(Ei.IDENTITY_PARTNER_DATA_OBTAINED,{partnerName:e.source,partnerIdentityId:null===(n=e.uids[0])||void 0===n?void 0:n.id})}));const t=yield this.generateBoiString();us.set("boi",t)}))}getDefaultBitStatus(e,t){return e.find((e=>e.source===t))?"P":"A"}getBitPlaceholder(){return"x"}getHEMBitStatus(){switch(!0){case!!(new Ro).getItem("liveConnect"):return"L";case!!O.get("wiki.opts.userEmailHashes"):return"M";default:return"A"}}}Rl.YAHOO_BIT=0,Rl.ID5_BIT=1,Rl.HEM_BIT=2,Rl.LIVEINTENT_BIT=3,Rl.PUBCID_BIT=4;const Dl=new Rl,xl="YahooConnectId",zl=new class{constructor(){this.pixelId="58833"}getConfig(){if(!O.get("bidders.prebid.yahooConnectId.enabled"))return void Wn(xl,"disabled");Wn(xl,"enabled");const e={name:"connectId",params:{pixelId:this.pixelId,puid:us.get("ppid")||"0"},storage:{type:"html5",name:"connectId",expires:15}};return Wn(xl,"config",e),e}},Vl="prebid",Ml={buckets:[{max:5,increment:.01},{max:10,increment:.1},{max:20,increment:.5},{max:50,increment:1}]},Ul={buckets:[{max:10,increment:.01},{max:20,increment:.5},{max:50,increment:1}]};function jl(e){return c(this,void 0,void 0,(function*(){const t=us.get("hb_adid",e.getSlotName());if(t){const i=yield Mr.init();Wn(Vl,"marking video bid as used",e.getSlotName(),t),i.markWinningBidAsUsed({adId:t}),e.emit(bs.VIDEO_AD_USED)}}))}_i.onSlotEvent(bs.VIDEO_AD_IMPRESSION,(({slot:e})=>jl(e))),_i.onSlotEvent(bs.VIDEO_AD_ERROR,(({slot:e})=>jl(e)));class Bl extends Ao{constructor(e,t=2e3,i=yo){var n;super("prebid",e,t),this.bidderConfig=e,this.timeout=t,this.bidGroup=i,this.tcf=Oo,yl.configureAdapters(),_i.on(Ei.MOBILE_MORE_ICB_EXPERIMENT,(()=>{yl.getAdapters().forEach((e=>{O.remove(`bidders.prebid.${e.bidderName}.slots.mobile_top_leaderboard`)}))}),!1),this.adUnits=yl.setupAdUnits(this.bidGroup),this.bidsRefreshing=O.get("bidders.prebid.bidsRefreshing")||{},this.prebidConfig={enableTIDs:!0,bidderSequence:"random",bidderTimeout:this.timeout,cache:{url:"https://prebid.adnxs.com/pbc/v1/cache"},debug:["1","true"].includes(y.get("pbjs_debug")),cpmRoundingFunction:Nl,mediaTypePriceGranularity:{banner:Ml,video:Ul,"video-outstream":Ul},ozone:{enhancedAdserverTargeting:!1,oz_whitelist_adserver_keys:[]},rubicon:{singleRequest:!0},userSync:{filterSettings:{iframe:{bidders:"*",filter:"include"},image:{bidders:"*",filter:"include"}},userIds:[],auctionDelay:null!==(n=O.get("bidders.prebid.auctionDelay"))&&void 0!==n?n:50,syncsPerBidder:3,syncDelay:6e3}},is()&&(this.prebidConfig.coppa=!0),this.prebidConfig=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},this.prebidConfig),this.configureTargeting()),this.configureTCF()),this.configureS2sBidding()),this.configureJwpRtd()),this.configureFledge()),this.configureOrtb2()),O.get("bidders.prebid.config")),kl.getPriceFloors()),this.configureUserSync(),this.configureSChain(),this.applyConfig(this.prebidConfig),this.configureAdUnits(),Ol.configure(this.adUnits),_i.on(Sr,(({adSlot:e})=>{const t=e.getSlotName();this.setMaximumAdSlotHeight(t)}),!1),xr.register(),Wn(Vl,"prebid created",this.prebidConfig)}configureTargeting(){return O.get("bidders.prebid.disableSendAllBids")?{enableSendAllBids:!1,targetingControls:{alwaysIncludeDeals:!0,allowTargetingKeys:["AD_ID","BIDDER","DEAL","PRICE_BUCKET","SIZE","UUID","CACHE_HOST"]}}:{enableSendAllBids:!0,sendBidsControl:{bidLimit:2,dealPrioritization:!0},targetingControls:{alwaysIncludeDeals:!0,allowTargetingKeys:["AD_ID","BIDDER","PRICE_BUCKET","UUID","SIZE","DEAL","CACHE_HOST"],allowSendAllBidsTargetingKeys:["AD_ID","PRICE_BUCKET","UUID","SIZE","DEAL"]}}}configureUserSync(){this.configureTestWikiaUserId(),this.configureOzone(),this.configureId5(),this.configureLiveRamp(),this.configureYahooConnectId(),this.configureLiveIntentConnectedId()}configureTestWikiaUserId(){y.get("wikia_adapter")&&(this.prebidConfig.userSync.userIds.push({name:"pubCommonId",value:{pubcid:"wikiaUserTestId"}}),Wn(Vl,"Wikia user ID enabled"))}configureLiveIntentConnectedId(){const e=El.getConfig();e?(this.prebidConfig.userSync.userIds.push(e),us.set("li-module-enabled",["t1"]),_i.emit(Ei.PARTNER_LOAD_STATUS,{status:"liveintent_connectid_started"}),this.updateConnectedIdTargeting()):(this.prebidConfig.userSync.userIds.push([]),us.set("li-module-enabled",["t0"]))}updateConnectedIdTargeting(){return c(this,void 0,void 0,(function*(){if(El.getConfig()){const e=(yield Dl.getIds()).find((e=>"liveintent.com"===e.source));us.set("li-module-enabled",["t1-"+(e?"e1":"e0")])}}))}configureLiveRamp(){const e=Al.getConfig();void 0!==e&&(this.prebidConfig.userSync.userIds.push(e),this.prebidConfig.userSync.syncDelay=3e3)}configureOzone(){O.get("bidders.prebid.ozone")&&this.prebidConfig.userSync.userIds.push({name:"pubCommonId",storage:{type:"cookie",name:"_pubcid",expires:365}})}configureId5(){const e=wl.getConfig();e&&(this.prebidConfig.userSync.userIds.push(e),_i.emit(Ei.PARTNER_LOAD_STATUS,{status:"id5_started"}))}configureYahooConnectId(){const e=zl.getConfig();e&&(_i.emit(Ei.YAHOO_STARTED),this.prebidConfig.userSync.userIds.push(e))}configureSChain(){this.configureWebAdsSChain()}configureWebAdsSChain(){return c(this,void 0,void 0,(function*(){(yield Mr.init()).setBidderConfig({bidders:["relevantdigital"],config:{schain:{validation:"strict",config:{ver:"1.0",complete:1,nodes:[{asi:"http://webads.eu",sid:"310035",hp:1}]}}}})}))}configureTCF(){return this.tcf.exists?{consentManagement:{gdpr:{cmpApi:"iab",timeout:this.timeout,allowAuctionWithoutConsent:!1,defaultGdprScope:!1},usp:{cmpApi:"iab",timeout:100}}}:{}}configureS2sBidding(){if(!O.get("bidders.s2s.enabled"))return{};const e=O.get("bidders.s2s.bidders")||[];return Wn(Vl,"Prebid s2s enabled",e),{cache:{url:"https://prebid-server.rubiconproject.com/cache",ignoreBidderCacheKey:!0},s2sConfig:[{accountId:7450,bidders:e,defaultVendor:"rubicon",coopSync:!0,userSyncLimit:8,defaultTTL:300,allowUnknownBidderCodes:!0,extPrebid:{cache:{vastxml:{returnCreative:!1}},bidders:this.prepareExtPrebidBiders(e)}}]}}configureJwpRtd(){if(O.get("custom.hasFeaturedVideo")&&O.get("options.video.enableStrategyRules")){const e=O.get("options.video.jwplayer.initialMediaId");return{realTimeData:{auctionDelay:100,dataProviders:[{name:"jwplayer",waitForIt:!0,params:{mediaIDs:e?[e]:[]}}]}}}return{}}configureOrtb2(){return{ortb2:Object.assign(Object.assign({},this.getOrtb2Site()),this.getOrtb2Regs())}}getOrtb2Site(){const e=(new kd).getOrtb2IabCategorySiteFields();return Wn(Vl,"IAB categories",e),(null==e?void 0:e.cat)||(null==e?void 0:e.pagecat)?{site:Object.assign({},e)}:{}}getOrtb2Regs(){return O.get("options.dsa.enabled")?{regs:{ext:{dsa:{dsarequired:1,pubrender:2,datatopub:2}}}}:{}}configureFledge(){return O.get("bidders.fledge.enabled")?{fledgeForGpt:{enabled:!0,bidders:O.get("bidders.fledge.partners")||[],defaultForSlots:1}}:{}}prepareExtPrebidBiders(e){const t={};return e.forEach((e=>{t[e]={wrappername:"7450_Web_Server"}})),t}configureAdUnits(){return c(this,arguments,void 0,(function*(e=[]){yield Mr.init(),e.length?this.adUnits=e:this.adUnits||(this.adUnits=yl.setupAdUnits(this.bidGroup))}))}applyConfig(e){return c(this,void 0,void 0,(function*(){return(yield Mr.init()).setConfig(e)}))}applySettings(){return c(this,void 0,void 0,(function*(){(yield Mr.init()).bidderSettings=Object.assign({standard:{suppressEmptyKeys:!0,allowZeroCpmBids:!0}},function(e){const t={};return e.forEach((({bidderName:e,bidderSettings:i,aliases:n})=>{if(!e)return;let s={adserverTargeting:[{key:`hb_deal_${e}`,val:({dealId:e})=>e}],suppressEmptyKeys:!0,allowZeroCpmBids:!0};i&&(s=Object.assign(Object.assign({},s),i)),t[e]=s,"object"==typeof n&&Object.keys(n).filter((e=>!t[e])).forEach((e=>t[e]=s))})),t}(yl.getAdapters()))}))}callBids(e){if(this.adUnits||(this.adUnits=yl.setupAdUnits(this.bidGroup)),0===this.adUnits.length)return Wn(Vl,"there is no slots to fetch bids"),void this.onNoSlotsError();this.applySettings(),this.removeAdUnits(),this.saveBidIds(),bl(this.adUnits,(()=>{e(),_i.emit(br)}),this.timeout),_i.emit(mr)}saveBidIds(){Wn(this.logGroup,"Saving bid ids"),Dl.saveCurrentPrebidIds()}removeAdUnits(){return c(this,void 0,void 0,(function*(){const e=yield Mr.init();(e.adUnits||[]).forEach((t=>e.removeAdUnit(t.code)))}))}getBestPrice(e){return function(e){return c(this,void 0,void 0,(function*(){const t={},i=yl.getAdapters();for(const n of Array.from(i.entries())){const i=yield vl(e,n[1].bidderName),{hb_pb:s}=i;t[n[1].bidderName]=Ll(s)}return t}))}(wo(e))}getTargetingKeys(e){return Object.keys(us.dump(e)||{}).filter((e=>0===e.indexOf("hb_")))}getTargetingParams(e){return c(this,void 0,void 0,(function*(){const t=yield Mr.init();let i;try{i=t.getAdserverTargeting()}catch(t){console.warn("Error while getting prebid targeting",e),i={}}return i[wo(e)]}))}isSupported(e){const t=wo(e);return this.adUnits&&this.adUnits.some((e=>e.code===t))}calculatePrices(){}setMaximumAdSlotHeight(e){const t=O.get("slotConfig.slotRefresher.sizes");if(!t)return;const i=t[e][1];i&&yl.getAdapters().forEach((t=>{t.setMaximumAdSlotHeight(e,i)}))}}const $l="bidders";class Fl extends jo{constructor(e,t=null){super(e,t),this.instantConfig=e,this.globalTimeout=t,this.biddersProviders={},this.realSlotPrices={},_i.onSlotEvent(bs.VIDEO_AD_REQUESTED,(({slot:e})=>{e.updateWinningPbBidderDetails()})),_i.onSlotEvent(bs.VIDEO_AD_USED,(({slot:e})=>{this.updateSlotTargeting(e.getSlotName())})),_i.on(fr,(({refreshedSlotNames:e})=>{e.forEach((e=>this.updateSlotTargeting(e)))}),!1),_i.on(yr,(({group:e,callback:t,shouldUpdateTargetingBeforeCallback:i})=>{this.callByBidGroup(e).then((()=>{i?this.updateSlotTargetingForBidGroup(e,t):t&&(t(),Wn($l,`${e} - callback`))}))}),!1)}getName(){return"bidders"}isEnabled(){return O.get("bidders.prebid.enabled")||O.get("bidders.a9.enabled")}applyTargetingParams(e,t){Object.keys(t).forEach((i=>us.set(i,t[i],e)))}getBidParameters(e){return c(this,void 0,void 0,(function*(){const t={},i=To(e);return yield Promise.all(this.getBiddersProviders(i).map((i=>c(this,void 0,void 0,(function*(){if(i&&i.wasCalled()){const n=yield i.getSlotTargetingParams(e);Object.assign(t,n)}}))))),t}))}getCurrentSlotPrices(e){return c(this,void 0,void 0,(function*(){const t={},i=To(e);return yield Promise.all(this.getBiddersProviders(i).map((i=>c(this,void 0,void 0,(function*(){if(i&&i.isSlotSupported(e)){const n=yield i.getSlotBestPrice(e);Object.keys(n).forEach((e=>{t[e]=n[e]}))}}))))),t}))}getDfpSlotPrices(e){return this.realSlotPrices[e]||{}}resetTargetingKeys(e){const t=To(e);this.getBiddersProviders(t).forEach((t=>{t.getTargetingKeys(e).forEach((t=>{us.remove(t,e)}))})),Wn($l,"resetTargetingKeys",e)}call(){return this.callByBidGroup(yo)}callByBidGroup(e){const t=O.get("bidders")||{},i=vn(),n=this.getBidderTimeout(t,e);return this.biddersProviders[e]=this.biddersProviders[e]||{},t.prebid&&t.prebid.enabled&&(this.biddersProviders[e].prebid=new Bl(t.prebid,n,e)),Vo.isEnabled()?this.biddersProviders[e].a9=new Vo(t.a9,n,e):Wn($l,`Group: ${e} - A9 has been disabled`),this.getBiddersProviders(e).length?(this.getBiddersProviders(e).forEach((t=>{t.addResponseListener((()=>{this.hasAllResponses(e)&&(Wn($l,`Group: ${e} - ${t.name} - resolving call() promise because of having all responses`),i.resolve(null))})),t.call()})),Wn($l,`Group: ${e} - returning call() promise`),i):(Wn($l,`Group: ${e} - resolving call() promise because of no bidder providers`),Promise.resolve())}storeRealSlotPrices(e){return c(this,void 0,void 0,(function*(){this.realSlotPrices[e]=yield this.getCurrentSlotPrices(e)}))}updateSlotTargeting(e){return c(this,void 0,void 0,(function*(){const t=yield this.getBidParameters(e);return yield this.storeRealSlotPrices(e),this.resetTargetingKeys(e),this.applyTargetingParams(e,t),Wn($l,"updateSlotTargeting",e,t),_i.emit(gr,{slotName:e,provider:"prebid"}),t}))}hasAllResponses(e){return 0===Object.keys(this.getBidderProviders(e)).filter((t=>{const i=this.getBidderProviders(e)[t];return!!i&&!i.hasResponse()})).length}getBiddersProviders(e){return Object.values(this.biddersProviders[e]||{})}getBidderProviders(e){return this.biddersProviders[e]||{}}getBidderTimeout(e,t){var i;return(null===(i=null==e?void 0:e.timeoutByGroup)||void 0===i?void 0:i[t])||e.timeout}updateSlotTargetingForBidGroup(e,t){const i=function(e){return Object.entries(Qr.slotConfigsMap).filter((([,t])=>t.bidGroup===e)).map((([e])=>e))}(e),n=i.map((e=>this.updateSlotTargeting(e)));Promise.all(n).catch((e=>{Wn($l,"Error updating slot targeting:",e)})).finally((()=>{t&&(Wn($l,`${e} - callback`),t())}))}}var Hl;let Gl=class{constructor(e){this.dwTracker=e,this.logGroup="ad-size-tracker"}init(){_i.on(bi,(({slot:e})=>{this.track(e)}),!1)}getFirstChild(e){return e.firstChild}getAdSize(e){var t,i,n;let s,r;try{const o=null===(n=null===(i=null===(t=document.querySelector(`#${e} [id*='google_ads_iframe_\\/5441'] iframe`))||void 0===t?void 0:t.contentWindow)||void 0===i?void 0:i.document)||void 0===n?void 0:n.querySelector("html");if(s=null==o?void 0:o.offsetHeight,r=null==o?void 0:o.offsetWidth,!s||!r){let t=document.querySelector(`#${e} [id*='google_ads_iframe_\\/5441'] div`);for(;!s||!r;)t=this.getFirstChild(t),s=t.clientHeight,r=t.clientWidth}}catch(e){r=null,s=null}return{height:s,width:r}}getRealAdSize(e,t){var i,n;let s=e.getIframeSize();return Wn(this.logGroup,`iframe size: ${s.width}x${s.height}`),s.width&&s.height||(s=this.getAdSize(t),Wn(this.logGroup,`element size: ${s.width}x${s.height}`)),s.width&&s.height||(s={width:(null===(i=e.getElement())||void 0===i?void 0:i.offsetWidth)||0,height:(null===(n=e.getElement())||void 0===n?void 0:n.offsetHeight)||0}),s}track(e){setTimeout((()=>{Wn(this.logGroup,"Sending tracking event for ",e.getMainPositionName().trim());const t=e.getMainPositionName();try{const i=this.getRealAdSize(e,t),n={slot_size:e.getCreativeSize()||"",real_ad_size:`${i.width}x${i.height}`,requested_sizes:e.config.defaultSizes.map((e=>e.join("x"))).join(","),advertiser_id:e.advertiserId,order_id:e.orderId,line_item_id:e.lineItemId||"",creative_id:e.creativeId||"",slot_id:e.getUid()||"",position:t,country_code:O.get("geo.country"),region:O.get("geo.region"),rv:e.getTargetingProperty("rv")||""};this.dwTracker.track(n,Xo.AD_ENG_AD_SIZE_INFO)}catch(e){Wn(this.logGroup,"Error when reading a data from: "+t,e)}}),0)}};var ql,Wl,Kl,Yl,Ql;Gl=a([Rn(),l("design:paramtypes",["function"==typeof(Hl=void 0!==ha&&ha)?Hl:Object])],Gl);const Jl=R("[AdEngine] Ad clicked",{_as:"props",_p:void 0});let Xl=class extends qa{constructor(e,t,i,n,s){super(e,t,i),this.labradorTracker=e,this.dwTracker=t,this.instantConfig=i,this.bidders=n,this.adSizeTracker=s}execute(){this.porvataTracker(),this.slotTracker(),this.identityTracker(),this.viewabilityTracker(),this.bidderTracker(),this.postmessageTrackingTracker(),this.interventionTracker(),this.adClickTracker(),this.ctaTracker(),this.adSizeTracker.init(),this.dsaModalTracker(),super.execute()}identityTracker(){this.instantConfig.get("icIdentityPartners",!1)||_i.on(Ei.IDENTITY_PARTNER_DATA_OBTAINED,(e=>{const{partnerName:t,partnerIdentityId:i}=e.payload;if("Google"!==t&&this.dwTracker.track({partner_name:t,partner_identity_id:i},Xo.IDENTITY_INFO),["liveConnect","MediaWiki-sha256"].includes(t)){const e=xo.make();e.init().then((()=>e.sendHEM(i)))}}),!1)}porvataTracker(){_i.on(Ya,(({eventInfo:e})=>{this.dwTracker.track(e,Xo.AD_ENG_PLAYER_INFO)}),!1),Xa.register()}slotTracker(){let e=null;(O.get("bidders.prebid.enabled")||O.get("bidders.a9.enabled"))&&(e=this.bidders),ad.onChangeStatusToTrack.push("top-conflict"),ad.register((({data:e})=>{this.dwTracker.track(e,Xo.AD_ENG_AD_INFO)}),{bidders:e})}viewabilityTracker(){cd.register((({data:e})=>(this.dwTracker.track(e,Xo.AD_ENG_VIEWABILITY),e)))}ctaTracker(){ud.register((({data:e})=>{this.dwTracker.track(e,Xo.AD_ENG_AD_INFO)}))}adClickTracker(){md.register((({data:e})=>{_i.dispatch(Jl(e)),this.dwTracker.track(e,Xo.AD_ENG_AD_INFO)}))}bidderTracker(){(O.get("bidders.prebid.enabled")||O.get("bidders.a9.enabled"))&&bd.register((({data:e})=>{this.dwTracker.track(e,Xo.AD_ENG_BIDDERS)}))}postmessageTrackingTracker(){new Td(["payload","target"]).register((e=>c(this,void 0,void 0,(function*(){const{target:t,payload:i}=e;switch(t){case _d.GoogleAnalytics:window.ga("tracker1.send","event",i.category,i.action,i.label,"number"==typeof i.value?i.value.toString():i.value);break;case _d.DataWarehouse:this.dwTracker.track(i)}return e}))),[window.origin,...er])}interventionTracker(){Ad.register()}dsaModalTracker(){xr.isEnabled()&&(_i.on(_r,(({adSlotName:e})=>{this.dwTracker.track({category:"dsa-modal",action:"click",label:"open",value:`ad-slot-${e}`})}),!1),_i.on(Er,(({adSlotName:e})=>{this.dwTracker.track({category:"dsa-modal",action:"click",label:"close",value:`ad-slot-${e}`})}),!1))}};var Zl,ec;Xl=a([Rn(),l("design:paramtypes",["function"==typeof(ql=void 0!==$a&&$a)?ql:Object,"function"==typeof(Wl=void 0!==ha&&ha)?Wl:Object,"function"==typeof(Kl=void 0!==po&&po)?Kl:Object,"function"==typeof(Yl=void 0!==Fl&&Fl)?Yl:Object,"function"==typeof(Ql=void 0!==Gl&&Gl)?Ql:Object])],Xl);let tc=class{constructor(e){this.container=e}execute(e,t,i){return c(this,void 0,void 0,(function*(){if(this.isCompoundProcessStep(e)){const t=this.container.get(e.process);return yield t.execute(e.payload),i()}if(this.isDiProcess(e)){const t=this.container.get(e);return yield t.execute(),i()}return yield e(),i()}))}isCompoundProcessStep(e){return"object"==typeof e&&"process"in e&&"function"==typeof e.process.prototype.execute}isDiProcess(e){var t;return"function"==typeof(null===(t=e.prototype)||void 0===t?void 0:t.execute)}};tc=a([Rn({scope:"Transient"}),l("design:paramtypes",["function"==typeof(Zl=void 0!==jn&&jn)?Zl:Object])],tc);let ic=class extends yd{constructor(e){super(e.get(tc))}};var nc;ic=a([Rn({scope:"Transient"}),l("design:paramtypes",["function"==typeof(ec=void 0!==jn&&jn)?ec:Object])],ic);let sc=class{constructor(e){this.container=e}execute(e){return Promise.all(e.map((e=>this.container.get(ic).add(e).execute()))).then()}};var rc;sc=a([Rn({scope:"Transient"}),l("design:paramtypes",["function"==typeof(nc=void 0!==jn&&jn)?nc:Object])],sc);let oc=class{constructor(e){this.container=e}execute(e){return this.container.get(ic).add(...e).execute()}};var ac;oc=a([Rn({scope:"Transient"}),l("design:paramtypes",["function"==typeof(rc=void 0!==jn&&jn)?rc:Object])],oc);let dc=class{constructor(e){this.instantConfig=e}execute(){this.setBaseState(),this.setupIdentityOptions(),this.setupServicesOptions(),this.setupVideo(),this.setupStickySlotContext()}setBaseState(){O.set("custom.device",O.get("state.isMobile")?"m":""),O.set("custom.dfpId",this.shouldSwitchGamToRV()?22309610186:5441),O.set("custom.pagePath",this.getPagePath()),O.set("src",this.shouldSwitchSrcToTest()?["test"]:O.get("src"))}setupIdentityOptions(){O.set("services.liveConnect.enabled",this.instantConfig.get("icLiveConnect")),O.set("services.liveConnect.cachingStrategy",this.instantConfig.get("icLiveConnectCachingStrategy")),O.set("services.liveRampPixel.enabled",this.instantConfig.get("icLiveRampPixel")),O.set("services.ppid.enabled",this.instantConfig.get("icPpid")),O.set("services.ppidRepository",this.instantConfig.get("icPpidRepository")),O.set("services.identityTtl",this.instantConfig.get("icIdentityTtl"))}setupServicesOptions(){O.set("options.maxDelayTimeout",this.instantConfig.get("icAdEngineDelay",2e3)),O.set("bidders.prebid.disableSendAllBids",this.instantConfig.get("icPrebidDisableSendAllBids")),O.set("services.captify.propertyId",13061),O.set("services.confiant.propertyId","IOegabOoWb7FyEI1AmEa9Ki-5AY"),O.set("bidders.liveIntentConnectedId.enabled",this.instantConfig.get("icLiveIntentConnectedId"))}setupVideo(){var e,t,i;O.set("vast.adUnitId",this.buildVastAdUnit()),O.set("options.video.playAdsOnNextVideo",!!this.instantConfig.get("icFeaturedVideoAdsFrequency")),O.set("options.video.adsOnNextVideoFrequency",this.instantConfig.get("icFeaturedVideoAdsFrequency",3)),O.set("options.video.isMidrollEnabled",this.instantConfig.get("icFeaturedVideoMidroll")),O.set("options.video.isPostrollEnabled",this.instantConfig.get("icFeaturedVideoPostroll")),O.set("options.video.iasTracking.enabled",this.instantConfig.get("icIASVideoTracking")),O.set("options.video.comscoreJwpTracking",this.instantConfig.get("icComscoreJwpTracking")),O.set("services.anyclip.enabled",this.instantConfig.get("icAnyclipPlayer")),O.set("services.anyclip.anyclipTagExists",!!(null===(e=this.getDataSettingsFromMetaTag())||void 0===e?void 0:e.anyclip)||!!(null===(i=null===(t=this.getDataSettingsFromMetaTag())||void 0===t?void 0:t.target_params)||void 0===i?void 0:i.anyclip))}setupStickySlotContext(){O.set("templates.stickyTlb.forced",this.instantConfig.get("icForceStickyTlb"));const e=this.instantConfig.get("icStickySlotLineItemIds"),t=this.instantConfig.get("icStickySlotOrderIds");e&&e.length&&O.set("templates.stickyTlb.lineItemIds",e),t&&t.length&&O.set("templates.stickyTlb.ordersIds",t)}buildVastAdUnit(){return`${O.get("custom.dfpId")}/v${O.get("custom.region")}-${O.get("custom.property")}/${"m"===O.get("custom.device")?"mobile":"desktop"}${O.get("custom.pagePath")}`}shouldSwitchGamToRV(){return"1"===y.get("switch_to_rv_gam")}shouldSwitchSrcToTest(){return"1"===y.get("switch_src_to_test")}getPagePath(){const e=this.getDataSettingsFromMetaTag(),t=(null==e?void 0:e.unit_name)?this.getPagePathFromMetaTagData(e):this.getPagePathFromGtagData();return t?"/"===t[0]?t:"/"+t:""}getPagePathFromMetaTagData(e){var t,i;const n=O.get("custom.property"),s=null===(t=null==e?void 0:e.unit_name)||void 0===t?void 0:t.indexOf(n);return(null===(i=null==e?void 0:e.unit_name)||void 0===i?void 0:i.slice(s)).replace(n,"")}getPagePathFromGtagData(){var e;const t=this.getGtagData();return null===(e=null==t?void 0:t.data)||void 0===e?void 0:e.siteSection}getDataSettingsFromMetaTag(){var e;const t=null===(e=document.getElementById("ad-settings"))||void 0===e?void 0:e.getAttribute("data-settings");if(this.log("Ad settings: ",t),!t)return null;try{return JSON.parse(t)}catch(e){return this.log("Could not parse JSON"),null}}getGtagData(){const e=window.dataLayer.find((({event:e})=>"Pageview"===e));return this.log("tag data: ",e),e}log(...e){Wn("setup",...e)}};var lc;dc=a([Rn(),l("design:paramtypes",["function"==typeof(ac=void 0!==po&&po)?ac:Object])],dc);let cc=class{constructor(e){this.instantConfig=e}execute(){const e=this.instantConfig.get("icBabDetection");O.set("options.wad.enabled",e),e&&O.set("options.wad.btRec.enabled",this.instantConfig.get("icBTRec")),y.get("switch_bt_loader")&&O.set("options.wad.btRec.loaderUrl","//btloader.com/tag?o=6209001497821184&upapi=true")}};var uc;cc=a([Rn(),l("design:paramtypes",["function"==typeof(lc=void 0!==po&&po)?lc:Object])],cc);let pc=uc=class{execute(){const e=O.get("custom"),t=Object.assign(Object.assign(Object.assign({},this.getPageLevelTargeting()),this.getViewGuid()),this.getForcedCampaignsTargeting());this.setPageLevelTargeting(t),this.setSlotLevelTargeting(t,e),us.extend(Object.assign(Object.assign(Object.assign({},us.dump()),t),{is_mobile:O.get("state.isMobile")?"1":"0",uap:"none",uap_c:"none"})),this.setupPageType(),function(){const e=js.isOptedIn()?0:1;us.set("npa",e.toString())}(),function(){const e=js.isOptOutSale()?1:0;us.set("rdp",e.toString())}()}getPageLevelTargeting(){const e=this.getAdTags(),t=this.parseAdTags(e);return this.getMappedAdTags(t)}getAdTags(){var e;return null===(e=document.head.querySelector("[name=adtags]"))||void 0===e?void 0:e.getAttribute("content")}parseAdTags(e){if(e)return Object.fromEntries(new URLSearchParams(e))}getMappedAdTags(e){var t;if(!e)return;const i={};for(const[n,s]of Object.entries(e)){const e=uc.splitMultiValueTag(s);switch(n){case"cid":i.slug=null!==(t=s.split(",")[0])&&void 0!==t?t:"null";break;case"con":case"platforms":i.pform=e;break;case"franchise":i.franchise_nr=e;break;case"franchiseRoot":case"franchises":i.franchise=e;break;case"genre":case"genres":i.gnre=e;break;case"network":i.tv=e;break;case"publishers":i.pub=e;break;case"themes":i.theme=e;break;default:i[n]=e}}return i}static splitMultiValueTag(e){const t=null==e?void 0:e.split(",");return(null==t?void 0:t.length)>1?t:e}getViewGuid(){return{vguid:this.getViewGuidFromGtagData()||this.getViewGuidFromMetaTag()}}getViewGuidFromGtagData(){const e=window.dataLayer.find((({event:e})=>"Pageview"===e));return null==e?void 0:e.pageview_id}getViewGuidFromMetaTag(){const e=document.getElementById("view-guid-meta"),t="content";let i="";return e&&e.hasAttribute(t)&&(i=e.getAttribute(t)),i}getForcedCampaignsTargeting(){return y.get("cid")?{cid:y.get("cid")}:y.get("adTargeting_campaign")?{campaign:y.get("adTargeting_campaign")}:{}}setSlotLevelTargeting(e,t){_i.on(mi,(({slot:i})=>{var n;i.setTargetingConfigProperty("sl",this.getSlValue(i,t)),i.setTargetingConfigProperty("iid",this.getIidValue(i,e)),i.setTargetingConfigProperty("pageType",null!==(n=e.pname)&&void 0!==n?n:"-1")}),!1)}setPageLevelTargeting(e){var t,i,n,s,r,o,a;us.set("pageType",null!==(t=e.pageType)&&void 0!==t?t:"-1"),us.set("pname",null!==(i=e.pname)&&void 0!==i?i:"-1"),us.set("ptype",null!==(n=e.ptype)&&void 0!==n?n:"-1"),us.set("slug",null!==(s=e.slug)&&void 0!==s?s:"-1"),us.set("pid",null!==(r=e.pid)&&void 0!==r?r:"-1"),us.set("section",null!==(o=e.section)&&void 0!==o?o:"-1"),O.set("custom.pageType",null!==(a=e.pname)&&void 0!==a?a:"front-door")}getSlValue(e,t){const i=[];return t.timeouts.bidder&&i.push(`T-${t.timeouts.bidder}`),e.getSlotName()+(i.length>0?"?"+i.join("|"):"")}getIidValue(e,t){let i=`unit=${e.getSlotName()}|`;return t.vguid&&(i+=`vguid=${t.vguid}|`),t.pv&&(i+=`pv=${t.pv}`),i}isJsonString(e){try{JSON.parse(e)}catch(e){return!1}return!0}setupPageType(){var e,t;const i=!0===(null===(t=null===(e=window.fandomContext)||void 0===e?void 0:e.video)||void 0===t?void 0:t.playerLoaded)?"video":"article";us.set("s2",i)}};pc=uc=a([Rn()],pc);const hc="slot-repeater";class gc{repeatSlot(e,t){const i=e.getCopy(),n=ps.build(t.slotNamePattern,{slotConfig:Object.assign(Object.assign({},i),{repeat:t})});if(i.slotName=n,null!==t.limit&&t.index>t.limit)Wn(hc,`Limit reached for ${n}`);else{if(!O.get(`slots.${n}.uid`))return O.set(`slots.${n}`,i),O.set(`slots.${n}.uid`,bn()),this.updateProperties(t,i),n;Wn(hc,`Slot already repeated: ${n}`)}}updateProperties(e,t){e.updateProperties&&Object.keys(e.updateProperties).forEach((i=>{let n=e.updateProperties[i];"string"==typeof n&&(n=ps.build(n,{slotConfig:Object.assign(Object.assign({},t),{repeat:e})})),O.set(`slots.${t.slotName}.${i}`,n),i.startsWith("targeting.")&&us.set(i.replace("targeting.",""),n,t.slotName)}))}}const mc="slot-creator";let fc=class{constructor(e=new gc){this.slotRepeater=e}createSlot(e,t){var i;if(!e)return null;Wn(mc,`Creating: ${e.slotName}`,e,t);const n=this.fillSlotConfig(e),s=this.makeSlot(n,e.anchorElement);if(n.repeat&&this.setupSlotRepeat(n),"alter"===e.insertMethod)return s;const r=this.wrapSlot(s,t),o=this.getAnchorElement(n);return this.isCollapsedAdInPlaceholder(o)?void 0:(o[n.insertMethod](r),(null===(i=n.placeholderConfig)||void 0===i?void 0:i.createLabel)&&this.addAdLabel(s.parentElement,n.slotName),s)}fillSlotConfig(e){var t;return Object.assign(Object.assign({},e),{anchorElement:e.anchorElement||null,anchorPosition:null!==(t=e.anchorPosition)&&void 0!==t?t:"firstViable",avoidConflictWith:e.avoidConflictWith||[],classList:e.classList||[],repeat:e.repeat,placeholderConfig:e.placeholderConfig})}isCollapsedAdInPlaceholder(e){var t;return"collapse"===(null===(t=e.querySelector(".hidead"))||void 0===t?void 0:t.getAttribute("data-slot-result"))}getAnchorElement(e){const t=this.getAnchorElements(e),i=this.getConflictElements(e);if("incontent_boxad_1"===e.slotName){const i=[...t].find((e=>on(e)));if(i)return Wn(mc,"getAnchorElement() called",e,i),i}const n=t.find((e=>!an(e,i)));return n||this.throwNoPlaceToInsertError(e.slotName),Wn(mc,"getAnchorElement() called",e,n),n}getAnchorElements(e){const t=Array.from(document.querySelectorAll(e.anchorSelector));switch(e.anchorPosition){case"belowFirstViewport":return t.filter((e=>tn(e)>sn()));case"belowScrollPosition":return t.filter((e=>tn(e)>window.scrollY));case"firstViable":return t;default:{const i=t[e.anchorPosition];return i||this.throwNoPlaceToInsertError(e.slotName),[i]}}}getConflictElements(e){const t=[];return e.avoidConflictWith.forEach((e=>{const i=Array.from(document.querySelectorAll(e));t.push(...i)})),t}makeSlot(e,t=null){const i=t||document.createElement("div");if(i)return i.id=e.slotName,i.classList.add("gpt-ad",...e.classList),i}wrapSlot(e,t){if(!t)return e;const i=document.createElement("div");return t.classList&&i.classList.add(...t.classList),t.id&&(i.id=t.id),i.append(e),i}addAdLabel(e,t){const i=new Dr({slot:t});e.appendChild(i.render())}setupSlotRepeat(e){_i.onSlotEvent(bs.SLOT_RENDERED_EVENT,(({slot:t})=>{if(!t.isEnabled())return;Wn(mc,`Repeating: ${e.slotName}`),e.repeat.index+=1;const i=this.slotRepeater.repeatSlot(t,e.repeat);if(!i)return;const n=Object.assign(Object.assign(Object.assign({},e),e.repeat.updateCreator||{}),{slotName:i});try{this.createSlot(n)}catch(e){return void Wn(mc,`There is not enough space for ${i}`)}Wn(mc,"Injecting slot:",i),!0!==e.repeat.disablePushOnScroll&&O.push("events.pushOnScroll.ids",i)}),e.slotName)}throwNoPlaceToInsertError(e){throw new Error(`No place to insert slot ${e}.`)}};fc=a([Rn(),l("design:paramtypes",[Object])],fc);const vc="cubic-bezier(0.55, 0.055, 0.675, 0.19)",bc=600,yc="none",Sc="none",wc=["uap","vuap"],_c="/5441/uap",Ec=3e3,Tc=2e3,Ic="force-unstick",Ac="unsticked",Cc="sticked",Oc="sticky-ready",Pc="sticky-skipped",kc="stickiness-disabled",Nc="video-done",Lc={bfaSize:{desktop:[3,3],mobile:[2,2],unified:[2,3]},companionSizes:{"4x4":{size:[4,4],originalSize:[300,250]},"5x5":{size:[5,5],originalSize:[300,600]}}};function Rc(e){return function(e){const t=O.get("slotGroups")||{},i=Object.keys(t).filter((i=>-1!==t[i].indexOf(e)));return 1===i.length?i[0]:null}(e.toUpperCase())||"OTHER"}function Dc(e,t){return ps.build(O.get(`slots.${e}.videoAdUnit`)||O.get("vast.adUnitId"),{slotConfig:t})}const xc=new class{addVariable(e,t){window.ads.runtime=window.ads.runtime||{},window.ads.runtime[e]=t}},zc=new class{addSlotSize(e,t){if(!O.get(`slots.${e}`))throw new Error(`Requested ad slot is not defined in the ad context (${e})`);O.push(`slots.${e}.defaultSizes`,t);const i=O.get(`slots.${e}.sizes`);i&&i.forEach((e=>{e.sizes.push(t)}))}removeSlotSize(e,t){if(!O.get(`slots.${e}`))throw new Error("Requested ad slot is not defined in the ad context");const i=O.get(`slots.${e}.defaultSizes`).filter((e=>e!=t)),n=O.get(`slots.${e}.sizes`).map((e=>e.sizes.filter((e=>e!=t))));O.set(`slots.${e}.defaultSizes`,i),O.set(`slots.${e}.sizes`,n)}setSlotSize(e,t){if(!O.get(`slots.${e}`))throw new Error("Requested ad slot is not defined in the ad context");O.set(`slots.${e}.sizes`,[]),O.set(`slots.${e}.defaultSizes`,[t])}setupSlotVideoContext(){_i.on(mi,(({slot:e})=>{O.onChange(`slots.${e.getSlotName()}.audio`,(()=>this.setupSlotParameters(e))),O.onChange(`slots.${e.getSlotName()}.videoDepth`,(()=>this.setupSlotParameters(e)))}),!1)}setupCustomPlayerAdUnit(e="incontent_player"){_i.on(As,(()=>{const t={group:"VIDEO",adProduct:"incontent_video",slotNameSuffix:""};O.get("custom.hasIncontentPlayer")&&O.get("services.connatix.enabled")&&(t.adProduct="cnx-incontent_video");const i=Dc(e,t);xc.addVariable("video",{adUnit:i})}))}setupSlotVideoAdUnit(e,t){const i=function(e,t,i){let n=e;return wc.includes(i)&&(n=`UAP_${t.toUpperCase()}`),{adGroup:Rc(n),adProduct:n.toLowerCase()}}(e.getSlotName(),t.type,t.adProduct),n={group:i.adGroup,adProduct:i.adProduct},s=Dc(e.getSlotName(),n);O.set(`slots.${e.getSlotName()}.videoAdUnit`,s)}setState(e,t,i){const n=document.getElementById(e);Qr.setState(e,!!n&&t,i)}setupSlotParameters(e){const t=!0===e.config.audio?"-audio":"",i=!0===e.config.autoplay||e.config.videoDepth>1?"":"-ctp";e.setConfigProperty("slotNameSuffix",i||t||""),e.setTargetingConfigProperty("audio",t?"yes":"no"),e.setTargetingConfigProperty("ctp",i?"yes":"no")}},Vc=new fc;function Mc(e){e.filter((e=>!!e)).forEach((({slotCreatorConfig:e,slotCreatorWrapperConfig:t,activator:i})=>{try{Vc.createSlot(e,t),i&&i()}catch(t){Wn("insert-slot",t.message),(null==e?void 0:e.slotName)&&zc.setState(e.slotName,!1)}}))}let Uc=yc,jc=yc,Bc=Sc;function $c(){return jc}function Fc(e,t){jc=e||yc,Uc=t||yc,qc(jc,Uc)}function Hc(){return Bc}function Gc(e){Bc=e}function qc(e,t){const i=O.get("slots")||{};Object.keys(i).forEach((i=>{us.set("uap",e,i),us.set("uap_c",t,i)}))}const Wc=Object.assign(Object.assign({},t),{init(e,t=[],i=[]){xc.addVariable("disableBtf",!0);let n="uap";this.isVideoEnabled(e)&&(n="vuap"),e.adProduct=e.adProduct||n,Fc(e.lineItemId||e.uap,e.creativeId),function(e){e.forEach((e=>{Qr.disable(e)}))}(i),function(e){e.forEach((e=>{Gs.unblock(e)}))}(t),Gc(e.adProduct),e.slotName&&function(e){const t=Qr.get(e.slotName);e.container=t.getElement(),e.isDarkTheme&&e.container.classList.add("is-dark"),e.isMobile&&e.container.classList.add("is-mobile-layout"),(Wi.isSmartphone()||Wi.isTablet())&&e.container.classList.add("is-mobile-device"),e.useVideoSpecialAdUnit&&t.setConfigProperty("videoAdUnit",_c)}(e)},isFanTakeoverLoaded:function(){return $c()!==yc&&-1!==wc.indexOf(Hc())},getType:Hc,getUapId:$c,isVideoEnabled:e=>e.thumbnail,reset:function(){Gc(Sc),Fc(yc,yc)},updateSlotsTargeting:qc});_i.action$.pipe(Si(_i.getGlobalAction(fi)),pi((e=>!!O.get(`slots.${e.adSlotName}.firstCall`)&&[bs.TEMPLATES_LOADED,zs.STATUS_COLLAPSE,zs.STATUS_FORCED_COLLAPSE].map((t=>e.event===t)).some((e=>!!e)))),hi(1)).subscribe((()=>{_i.emit($s,{isLoaded:Wc.isFanTakeoverLoaded(),adProduct:Wc.getType()})}));class Kc{trySubscribingBidRefreshing(e){e.subscribe((()=>this.onAdImpressionHandler()),"adImpression")}onAdImpressionHandler(){Wn("Anyclip","AnyclipBidsRefresher: ad impression in Anyclip detected - refreshing");const e="incontent_player",t=Qr.get(e);this.sendSignalToRemoveBids(t),xs.setDataParam(t,"gptSlotParams",us.dump(e))}sendSignalToRemoveBids(e){e.emit(bs.VIDEO_AD_IMPRESSION)}}class Yc{constructor(){this.playerEvents={init:"init",WidgetLoad:"ready",adImpression:"impression",adSkipped:"skipped",adFirstQuartile:"first_quartile",adMidpoint:"midpoint",adThirdQuartile:"third_quartile",adComplete:"completed",adClick:"clicked"}}registerAnyclipEvents(e){Object.keys(this.playerEvents).map((t=>{e.subscribe((e=>this.track(t,e)),t)}))}trackInit(){const e="init";this.track(e,Ja.getEventData(this.getVideoData(e)))}trackEligible(){const e="eligible";this.track(e,Ja.getEventData(this.getVideoData(e)))}track(e,t){const i=Ja.getEventData(this.getVideoData(e));Wn("Anyclip",`Anyclip ${e} event data: `,t,this.getVideoData(e),i),Ja.emit(i),Ja.emitVideoEvent(i)}getVideoData(e){var t;return{ad_error_code:0,event_name:null!==(t=this.playerEvents[e])&&void 0!==t?t:e,player:"anyclip",ad_product:"outstream",position:"incontent_player",line_item_id:"unknown",creative_id:"unknown"}}}const Qc="Anyclip",Jc="001w000001Y8ud2_19593",Xc=(e="incontent_player")=>{const t=Qr.get(e),i=!!document.getElementById(e);return Wn(Qc,`Waiting for player ad slot (${e}) ready`,i,t),i&&null!==t};class Zc extends jo{get pubname(){return O.get("services.anyclip.pubname")||"fandomcom"}get widgetname(){const e=O.get("services.anyclip.widgetname");return["string","undefined"].includes(typeof e)?e||Jc:"object"==typeof e&&(e[us.get("s0v")]||e.default)||Jc}get libraryUrl(){return O.get("services.anyclip.libraryUrl")||"//player.anyclip.com/anyclip-widget/lre-widget/prod/v1/src/lre.js"}static isApplicable(){const e=O.get("services.anyclip.isApplicable");return"function"!=typeof e||e()}constructor(){super(),this.tracker=new Yc,this.bidRefresher=new Kc}call(){(function(){const e=O.get("services.jwp.config");return!!e&&Object.keys(e).length>0&&!Wi.isSafari()})()||(this.isEnabled("services.anyclip.enabled",!1)?(Wn(Qc,"initialized",this.pubname,this.widgetname,this.libraryUrl),_i.emit(Ei.ANYCLIP_START),O.get("services.anyclip.loadWithoutAnchor")?_i.on($s,(e=>{e.isLoaded||this.loadPlayerAsset()})):O.get("custom.hasIncontentPlayer")&&_i.on($s,this.loadOnUapStatus.bind(this))):Wn(Qc,"disabled"))}reset(){var e,t;Wn(Qc,"Destroying Anyclip widgets"),null===(t=null===(e=null===window||void 0===window?void 0:window.anyclip)||void 0===e?void 0:e.widgets)||void 0===t||t.forEach((e=>null==e?void 0:e.destroy()))}enableFloating(){var e,t;Wn(Qc,"enabling Anyclip floating feature "),null===(t=null===(e=null===window||void 0===window?void 0:window.anyclip)||void 0===e?void 0:e.getWidget())||void 0===t||t.floatingModeToggle(!0)}disableFloating(){var e,t;Wn(Qc,"disabling Anyclip floating feature "),null===(t=null===(e=null===window||void 0===window?void 0:window.anyclip)||void 0===e?void 0:e.getWidget())||void 0===t||t.floatingModeToggle(!1)}get params(){return{pubname:this.pubname,widgetname:this.widgetname}}loadPlayerAsset(e=null){if(Zc.isApplicable())return Wn(Qc,"loading Anyclip asset",this.libraryUrl),ls.loadScript(this.libraryUrl,!0,e,this.params).then((()=>{null==e||e.classList.remove(Ji.HIDDEN_AD_CLASS),Wn(Qc,"ready"),this.waitForAnyclipReady().then((()=>{var e;_i.emit(Ei.ANYCLIP_READY);const t=null===(e=null===window||void 0===window?void 0:window.anyclip)||void 0===e?void 0:e.getWidget();t?(this.waitForPlayerAdSlot().then((()=>{this.tracker.trackInit(),this.bidRefresher.trySubscribingBidRefreshing(t)})),this.tracker.registerAnyclipEvents(t)):Wn(Qc,"No Anyclip widget found")}))}));Wn(Qc,"not applicable - aborting")}loadOnUapStatus({isLoaded:e,adProduct:t}){if(this.tracker.trackEligible(),e||"ruap"===t)Wn(Qc,"Anyclip blocked because of Fan Takeover");else{if(!O.get("services.anyclip.latePageInject"))return Wn(Qc,"No need to wait for ANYCLIP_LATE_INJECT"),void this.initIncontentPlayer();_i.on(Ei.ANYCLIP_LATE_INJECT,(()=>{Wn(Qc,"ANYCLIP_LATE_INJECT emitted"),this.initIncontentPlayer()}))}}initIncontentPlayer(){const e=Qr.get("incontent_player"),t=O.get("services.anyclip.playerElementId");e||t?t?this.waitForPlayerAdSlot(t).then((()=>{if(!Xc())return void Wn(Qc,"No incontent player - aborting");const e=document.getElementById(t);e&&(this.loadPlayerAsset(e),e.dataset.slotLoaded="true")})):(qs.updateOnCreate(e),this.loadPlayerAsset(e.getElement())):Wn(Qc,"No incontent player - aborting")}waitForAnyclipReady(){return new Promise((e=>{window.addEventListener("message",(t=>{var i,n;(null===(i=t.data)||void 0===i?void 0:i.indexOf)&&0===(null===(n=t.data)||void 0===n?void 0:n.indexOf("lre:playerReady://"))&&e()}))}))}waitForPlayerAdSlot(e="incontent_player"){return new uo((()=>Xc(e)),4,250).until()}}var eu;let tu=class{constructor(e){this.instantConfig=e}getInterstitialConfig(){if(!this.isInterstitialApplicable())return;const e="interstitial";return{slotCreatorConfig:{slotName:e,anchorSelector:"body",insertMethod:"prepend",classList:[Ji.HIDDEN_AD_CLASS,"ad-slot"]},activator:()=>{O.push("state.adStack",{id:e})}}}getFloorAdhesionConfig(){const e="floor_adhesion",t=()=>{const t=this.instantConfig.get("icFloorAdhesionViewportsToStart")||0;-1===t?O.push("state.adStack",{id:e}):_i.on(As,(()=>{const i=t*sn();ks.addSlot(e,{distanceFromTop:i})}))};return{slotCreatorConfig:{slotName:e,anchorSelector:"body",insertMethod:"append",classList:[Ji.HIDDEN_AD_CLASS,"ad-slot"]},activator:()=>function(e,t=!0){const i="top_leaderboard",n=O.get("experiments.persistentAdhesionExperiment");_i.on($s,(s=>{if(s.isLoaded&&!n)_i.onSlotEvent(bs.CUSTOM_EVENT,(({payload:t})=>{[Wc.SLOT_UNSTICKED_STATE,Wc.SLOT_FORCE_UNSTICK,Wc.SLOT_STICKY_STATE_SKIPPED,Wc.SLOT_VIDEO_DONE].includes(t.status)&&setTimeout((()=>e()),Wc.SLIDE_OUT_TIME)}),i);else if(!t){if(!O.get("state.topLeaderboardExists")||!O.get(`slots.${i}.defaultTemplates`).includes("stickyTlb"))return void e();_i.onSlotEvent(bs.CUSTOM_EVENT,(({payload:t})=>{t.status!==Wc.SLOT_STICKINESS_DISABLED?[Wc.SLOT_UNSTICKED_STATE,Wc.SLOT_FORCE_UNSTICK].includes(t.status)&&setTimeout((()=>e()),Wc.SLIDE_OUT_TIME):e()}),i)}}))}(t,!this.isFloorAdhesionNonUapApplicable())}}isInterstitialApplicable(){return this.instantConfig.get("icInterstitial")&&O.get("state.isMobile")}isFloorAdhesionNonUapApplicable(){return O.get("state.isMobile")&&!Zc.isApplicable()&&this.instantConfig.get("icFloorAdhesion")}getIncontentPlayerConfig(){if(!Zc.isApplicable())return void Wn("dynamic-slots","Aborting insertion of incontent_player");const e="incontent_player";return{slotCreatorConfig:{slotName:e,anchorSelector:"body",insertMethod:"append",classList:[Ji.HIDDEN_AD_CLASS,"ad-slot"]},activator:()=>{const{dataset:t}=document.getElementById(e);t.slotLoaded="true",t.ad=e,O.push("state.adStack",{id:e})}}}};var iu;tu=a([Rn(),l("design:paramtypes",["function"==typeof(eu=void 0!==po&&po)?eu:Object])],tu);let nu=class{constructor(e){this.slotsDefinitionRepository=e}execute(){this.injectSlots(),Mc([this.slotsDefinitionRepository.getInterstitialConfig(),this.slotsDefinitionRepository.getFloorAdhesionConfig()])}injectSlots(e=".mapped-ad,.ad",t=["skybox"]){const i=document.querySelectorAll(e);let n=!1;i&&0!==i.length?(i.forEach((e=>{let i=e.id,s=e;i||(i=e.getAttribute("data-ad-type"),s=cn.getFirstElementChild(e)),i&&s&&"interstitial"!==i&&(t.some((e=>i.includes(e)))&&(O.set("slots.top_leaderboard.bidderAlias",i),O.set("slots.top_leaderboard.targeting.pos",["top_leaderboard",i]),i="top_leaderboard",n=!0),s.id=i,O.push("state.adStack",{id:i}))})),O.set("state.topLeaderboardExists",n),n||_i.on(Cs,(()=>{Gs.finishFirstCall(),_i.emit($s,{isLoaded:Wc.isFanTakeoverLoaded(),adProduct:Wc.getType()})}))):console.warn("AdEngine did not find any ad placeholders")}};var su;nu=a([Rn(),l("design:paramtypes",["function"==typeof(iu=void 0!==tu&&tu)?iu:Object])],nu);let ru,ou=class{constructor(e){this.instantConfig=e}execute(){this.instantConfig.get("icA9Bidder")&&this.instantConfig.get("icA9VideoBidder")&&O.set("bidders.a9.videoEnabled",!0),O.set("bidders.s2s.bidders",this.instantConfig.get("icPrebidS2sBidders",[])),O.set("bidders.s2s.enabled",this.instantConfig.get("icPrebidS2sBidders",[]).length>0)}};ou=a([Rn(),l("design:paramtypes",["function"==typeof(su=void 0!==po&&po)?su:Object])],ou);class au extends jo{call(){return _i.onSlotEvent(bs.SLOT_RENDERED_EVENT,(({slot:e})=>{e.removeClass("default-height"),this.setUpAdChoicesDisplayPriority(e)})),ru=new Kr,ru.init()}setUpAdChoicesDisplayPriority(e){var t;const i=e.getIframe();if(!(null===(t=null==i?void 0:i.contentDocument)||void 0===t?void 0:t.body))return;const n=i.parentElement,s=new MutationObserver((e=>{e.forEach((()=>{var e,t,s,r,o;(null===(s=null===(t=null===(e=null==i?void 0:i.contentDocument)||void 0===e?void 0:e.body)||void 0===t?void 0:t.classList)||void 0===s?void 0:s.contains("goog_menu_opened"))?null===(r=null==n?void 0:n.classList)||void 0===r||r.add("ad-choices"):null===(o=null==n?void 0:n.classList)||void 0===o||o.remove("ad-choices")}))}));s.observe(i.contentDocument.body,{attributeFilter:["class"]})}}function du(e,t,i){return n=>ai(n.pipe(hi(1),cr(e,t,i),pi((()=>!1))),n)}const lu=new class{isEnabled(e){return e.isIasTrackingEnabled()}load(){return this.scriptPromise||(this.scriptPromise=ls.loadScript("//static.adsafeprotected.com/vans-adapter-google-ima.js",!0,"first")),this.scriptPromise}init(e,t){return _i.emit(Ei.PARTNER_LOAD_STATUS,{status:"ias_start"}),this.load().then((()=>{const i=O.get("options.video.iasTracking.config"),n=t.getSlotName(),{src:s,pos:r,loc:o}=Qr.get(n).getTargeting();i.custom=s,i.custom2=r,i.custom3=o,Wn("ias-video-tracking","ready"),window.googleImaVansAdapter.init(window.google,e.getAdsManager(),e.dom.getVideoContainer(),i),_i.emit(Ei.PARTNER_LOAD_STATUS,{status:"ias_done"})}))}};function cu(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=ti(e);return Ot((function(t,n){for(var s=e.length,r=new Array(s),o=e.map((function(){return!1})),a=!1,d=function(t){Wt(e[t]).subscribe(Pt(n,(function(e){r[t]=e,a||o[t]||(o[t]=!0,(a=o.every(Tt))&&(o=null))}),ct))},l=0;l<s;l++)d(l);t.subscribe(Pt(n,(function(e){if(a){var t=g([e],h(r));n.next(i?i.apply(void 0,g([],h(t))):t)}})))}))}const uu={pre:"preroll",mid:"midroll",post:"postroll"},pu=new class{getLastNumber(e){let t="";return e.forEach((e=>{isNaN(parseInt(e,10))||(t=e)})),t}getAdInfo(e){const t={lineItemId:void 0,creativeId:void 0,contentType:void 0};if(!e)return t;t.lineItemId=e.getAdId(),t.creativeId=e.getCreativeId(),t.contentType=e.getContentType();const i=e.getWrapperAdIds()||[];i&&i.length&&(t.lineItemId=this.getLastNumber(i));const n=e.getWrapperCreativeIds()||[];n&&n.length&&(t.creativeId=this.getLastNumber(n));const s=e.getWrapperAdSystems()||[];return s&&-1!==s.indexOf("AdSense/AdX")&&(t.lineItemId=Zs,t.creativeId=Zs),t}parse(e,t={}){let i,n,s,r;const o=y.getValues(e?e.substr(1+e.indexOf("?")):"?"),a=y.getValues(o.cust_params);if(t.imaAd){const e=this.getAdInfo(t.imaAd);i=e.contentType,n=e.creativeId,s=e.lineItemId}return r=t.eventAdPosition&&!o.vpos?uu[t.eventAdPosition]:o.vpos,{contentType:i,creativeId:n,customParams:a,lineItemId:s,position:r,size:o.sz}}};var hu=Array.isArray,gu=Object.getPrototypeOf,mu=Object.prototype,fu=Object.keys;function vu(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=ii(e),n=ti(e),s=function(e){if(1===e.length){var t=e[0];if(hu(t))return{args:t,keys:null};if((n=t)&&"object"==typeof n&&gu(n)===mu){var i=fu(t);return{args:i.map((function(e){return t[e]})),keys:i}}}var n;return{args:e,keys:null}}(e),r=s.args,o=s.keys;if(0===r.length)return oi([],i);var a=new It(function(e,t,i){return void 0===i&&(i=Tt),function(n){bu(t,(function(){for(var s=e.length,r=new Array(s),o=s,a=s,d=function(s){bu(t,(function(){var d=oi(e[s],t),l=!1;d.subscribe(Pt(n,(function(e){r[s]=e,l||(l=!0,a--),a||n.next(i(r.slice()))}),(function(){--o||n.complete()})))}),n)},l=0;l<s;l++)d(l)}),n)}}(r,i,o?function(e){return function(e,t){return e.reduce((function(e,i,n){return e[i]=t[n],e}),{})}(o,e)}:Tt));return n?a.pipe(Rt(n)):a}function bu(e,t,i){e?Yt(i,e,t):t()}function yu(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Jt(1)(oi(e,ii(e)))}function Su(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=ii(e);return Ot((function(t,n){(i?yu(e,t,i):yu(e,t)).subscribe(n)}))}function wu(e,t){return Ot(function(e,t,i,n,s){return function(n,s){var r=i,o=t,a=0;n.subscribe(Pt(s,(function(t){var i=a++;o=r?e(o,t,i):(r=!0,t),s.next(o)}),undefined))}}(e,t,arguments.length>=2))}function _u(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return oi(e,ii(e))}function Eu(){return Ot((function(e,t){var i=null;e._refCount++;var n=Pt(t,void 0,void 0,void 0,(function(){if(!e||e._refCount<=0||0<--e._refCount)i=null;else{var n=e._connection,s=i;i=null,!n||s&&n!==s||n.unsubscribe(),t.unsubscribe()}}));e.subscribe(n),n.closed||(i=e.connect())}))}var Tu=function(e){function t(t,i){var n=e.call(this)||this;return n.source=t,n.subjectFactory=i,n._subject=null,n._refCount=0,n._connection=null,Ct(t)&&(n.lift=t.lift),n}return o(t,e),t.prototype._subscribe=function(e){return this.getSubject().subscribe(e)},t.prototype.getSubject=function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject},t.prototype._teardown=function(){this._refCount=0;var e=this._connection;this._subject=this._connection=null,null==e||e.unsubscribe()},t.prototype.connect=function(){var e=this,t=this._connection;if(!t){t=this._connection=new nt;var i=this.getSubject();t.add(this.source.subscribe(Pt(i,void 0,(function(){e._teardown(),i.complete()}),(function(t){e._teardown(),i.error(t)}),(function(){return e._teardown()})))),t.closed&&(this._connection=null,t=nt.EMPTY)}return t},t.prototype.refCount=function(){return Eu()(this)},t}(It),Iu={connector:function(){return new zt}};function Au(e,t){void 0===t&&(t=Iu);var i=t.connector;return Ot((function(t,n){var s,r=i();Wt(e((s=r,new It((function(e){return s.subscribe(e)}))))).subscribe(n),n.add(t.subscribe(r))}))}function Cu(e){return e?function(t){return Au(e)(t)}:function(e){return function(e,t){var i=Ze(e)?e:function(){return e};return Ze(t)?Au(t,{connector:i}):function(e){return new Tu(e,i)}}(new zt)(e)}}function Ou(e,t){return e===t}function Pu(...e){return t=>t.pipe(pi((({name:t})=>e.includes(t))))}function ku(e,t){return new It((i=>{e.on(t,(e=>{i.next({name:t,payload:e})}))})).pipe(Cu(),Eu())}function Nu(e){return t=>{return t.pipe(Nt((t=>({event:t,playlistItem:e.getPlaylistItem()||{}}))),(void 0===n&&(n=Tt),i=null!=(i=(e,t)=>e.playlistItem.mediaid===t.playlistItem.mediaid)?i:Ou,Ot((function(e,t){var s,r=!0;e.subscribe(Pt(t,(function(e){var o=n(e);!r&&i(s,o)||(r=!1,s=o,t.next(e))})))}))),Nt((({event:e})=>e)));var i,n}}function Lu(...e){return t=>t.pipe(pi((({name:t})=>e.includes(t))))}let Ru=class{handle({stream$:e}){return this.isEnabled()?e.pipe(Lu("adStarted"),pi((({state:e})=>"preroll"===e.adInVideo)),cr((()=>{this.track({c1:"1",c2:6177433,c5:"09"})}))):Xt}isEnabled(){return!!O.get("options.video.comscoreJwpTracking")&&(O.get("options.geoRequiresConsent")?O.get("options.trackingOptIn"):!O.get("options.geoRequiresSignal")||O.get("options.optOutSale"))}track(e){var t;null===(t=window.COMSCORE)||void 0===t||t.beacon(e)}};Ru=a([Rn({scope:"Transient"})],Ru);const Du=new class{getVastAttributesFromVastParams(e,t){const i=t.customParams,n={};return Object.keys(i).forEach((e=>{let t=i[e];if("string"==typeof t){const e=t.split(",");e.length>1&&(t=e)}n[e]=t})),{"data-vast-content-type":t.contentType,"data-vast-creative-id":t.creativeId,"data-vast-line-item-id":t.lineItemId,"data-vast-position":t.position,"data-vast-size":t.size,"data-vast-status":e,"data-vast-params":JSON.stringify(n)}}getVastAttributes(e,t,i){const n=pu.parse(e,{imaAd:i});return this.getVastAttributesFromVastParams(t,n)}};class xu{constructor(){this.vastRequestedBeforePlayer=!1}hasFeaturedVideo(){return!!O.get("custom.hasFeaturedVideo")}getVideoSyncedWithDisplayLines(){return O.get("options.video.uapJWPLineItemIds")||[]}getSyncTimeout(){return O.get("options.jwpMaxDelayTimeout")}isTaglessRequestEnabled(){return O.get("options.video.displayAndVideoAdsSyncEnabled")}wasVastRequestedBeforePlayer(){return this.vastRequestedBeforePlayer}clearVideoSyncStatus(){this.vastRequestedBeforePlayer=!1}setVastRequestedBeforePlayer(){this.vastRequestedBeforePlayer=!0}isSyncEnabled(){return this.hasFeaturedVideo()&&this.getSyncTimeout()&&this.getVideoSyncedWithDisplayLines().length>0&&this.isEnabledByConfig()}isEnabledByConfig(){const e=O.get("options.video.syncWithDisplay");return"string"==typeof e?xu.hasBundleOrTag(e):Array.isArray(e)?e.some((e=>xu.hasBundleOrTag(e))):!!e}static hasBundleOrTag(e){const t=e.split("=");if(2==t.length){const e=us.get(t[0]);return Array.isArray(e)?e.includes(t[1]):e===t[1]}return ts.hasBundle(e)}}const zu=new xu;class Vu{constructor(e,t,i){this.adSlot=e,this.jwplayer=t,this.targeting=i,this.calledOnce=!1}awaitIasTracking(e){return c(this,void 0,void 0,(function*(){if(!this.isIasTrackingEnabled())return e;try{yield lu.load()}catch(e){console.error(e)}return e}))}isIasTrackingEnabled(){return O.get("options.video.iasTracking.enabled")}initIasVideoTracking({adsManager:e,videoElement:t}){const i=O.get("options.video.iasTracking.config");window.googleImaVansAdapter.init(google,e,t,i)}setSlotParams(e){this.adSlot.lineItemId=e.lineItemId,this.adSlot.creativeId=e.creativeId,this.adSlot.creativeSize=e.size}setSlotElementAttributes(e,t){const i=Du.getVastAttributesFromVastParams(e,t),n=this.adSlot.element;Object.keys(i).forEach((e=>n.setAttribute(e,i[e])))}emitVideoAdError(e){21009===e?this.adSlot.setStatus(zs.STATUS_COLLAPSE):this.adSlot.setStatus(zs.STATUS_ERROR),this.adSlot.emit(bs.VIDEO_AD_ERROR)}emitVideoAdRequest(){this.adSlot.emit(bs.VIDEO_AD_REQUESTED)}emitVideoAdImpression(){this.adSlot.setStatus(zs.STATUS_SUCCESS),this.adSlot.emit(bs.VIDEO_AD_IMPRESSION)}updateVideoProperties(e){this.adSlot.setConfigProperty("videoDepth",e.depth),this.adSlot.setTargetingConfigProperty("rv",e.rv)}shouldPlayPreroll(e,t=null){return this.canAdBePlayed(e,t)}shouldPlayMidroll(e,t=null){return O.get("options.video.isMidrollEnabled")&&this.canAdBePlayed(e,t)}shouldPlayPostroll(e,t=null){return O.get("options.video.isPostrollEnabled")&&this.canAdBePlayed(e,t)}canAdBePlayed(e,t=null){const i=e>1;return this.adSlot.isEnabled()&&(!i||i&&this.shouldPlayAdOnNextVideo(e,t))}shouldPlayAdOnNextVideo(e,t=null){const i=O.get("options.video.adsOnNextVideoFrequency");return Wn(Vu.LOG_GROUP_NAME,e,t),O.get("options.video.playAdsOnNextVideo")&&i>0&&(e-1)%i==0}playVideoAd(e,t){if(zu.wasVastRequestedBeforePlayer())zu.clearVideoSyncStatus();else{this.adSlot.setConfigProperty("audio",!t.mute);const i=this.getVastUrl(e,t);this.jwplayer.playAd(i)}}getVastUrl(e,t){return this.calledOnce?(t.rv++,this.updateVideoProperties(t)):this.calledOnce=!0,eo(0,this.adSlot.getSlotName(),{correlator:t.correlator,vpos:e,targeting:Object.assign({rv:this.getRvKeyVal(t.rv),v1:t.playlistItem.mediaid||""},this.targeting)})}getRvKeyVal(e){return 1===e?"1":[e.toString(),"2+"]}}Vu.LOG_GROUP_NAME="jwplayer-helper";class Mu extends Vu{constructor(e,t,i,n=window.sponsoredVideos){super(e,t,i),this.adSlot=e,this.jwplayer=t,this.targeting=i,this.sponsoredVideos=n}shouldPlayPreroll(e,t){return this.canAdBePlayed(e,t)}shouldPlayMidroll(e,t){return O.get("options.video.isMidrollEnabled")&&this.canAdBePlayed(e,t)}shouldPlayPostroll(e,t){return O.get("options.video.isPostrollEnabled")&&this.canAdBePlayed(e,t)}canAdBePlayed(e,t){return this.adSlot.isEnabled()&&this.shouldPlayAdOnNextVideo(e,t)}shouldPlayAdOnNextVideo(e,t){Wn(Vu.LOG_GROUP_NAME,e,t,this.sponsoredVideos);const i=y.get("force_sponsored_video");if(i&&(this.sponsoredVideos=[i],this.log("Overwritting window.sponsoredVideo!",this.sponsoredVideos)),!Array.isArray(this.sponsoredVideos)){this.log("Incorrect window.sponsoredVideos, using fallback to Pandora!",this.sponsoredVideos);const e=cs()+"article-video/jw-platform-api/get-sponsored-videos";this.sponsoredVideos=JSON.parse(ls.loadSync(e))}return this.sponsoredVideos?O.get("options.video.playAdsOnNextVideo")&&-1===this.sponsoredVideos.indexOf(t):(fo.log("JWPlayer - no sponsored videos",{currentMediaId:t,videoPlaysCounter:e}),!1)}log(e,t){Wn(Vu.LOG_GROUP_NAME,e,t)}}const Uu=new class{constructor(){this.logGroup="video-display-takeover-sync",this.initialized=vn()}isEnabled(){return zu.isSyncEnabled()}get(){return this.isEnabled()||this.initialized.resolve(null),this.initialized}isRequiredToRun(){return this.isEnabled()}getDelayTimeoutInMs(){return this.isEnabled()?zu.getSyncTimeout():0}resolve(e=null,t=null){this.isEnabled()?(e&&t&&zu.getVideoSyncedWithDisplayLines().includes(e)?(Wc.updateSlotsTargeting(e,t),Wn(this.logGroup,"video ad is from UAP:JWP campaign - updating key-vals")):Wn(this.logGroup,"video ad is not from UAP:JWP campaign"),this.initialized.resolve(null)):Wn(this.logGroup,"is disabled")}};let ju=class{handle({jwplayer:e,adSlot:t,targeting:i,stream$:n}){return this.stream$=n,this.helper=new Mu(t,e,i),ai(this.adError(),this.adRequest(),this.adImpression(),this.adsManager(),this.beforePlay(),this.videoMidPoint(),this.beforeComplete())}adRequest(){return this.stream$.pipe(Lu("adRequest"),cr((({state:e})=>{this.helper.emitVideoAdRequest(),this.helper.updateVideoProperties(e)})))}adImpression(){return this.stream$.pipe(Lu("adImpression"),cr((({state:e})=>{this.helper.setSlotParams(e.vastParams),this.helper.setSlotElementAttributes("success",e.vastParams),this.helper.emitVideoAdImpression(),Uu.resolve(e.vastParams.lineItemId,e.vastParams.creativeId)})))}adError(){return this.stream$.pipe(Lu("adError"),cr((({payload:e,state:t})=>{((...e)=>{Wn("jwplayer-ads-factory",...e)})(`ad error message: ${e.message}`),this.helper.setSlotParams(t.vastParams),this.helper.setSlotElementAttributes("error",t.vastParams),this.helper.emitVideoAdError(e.adErrorCode),Uu.resolve()})))}adsManager(){return this.stream$.pipe(Lu("adsManager"),pi((()=>this.helper.isIasTrackingEnabled())),cr((({payload:e})=>this.helper.initIasVideoTracking(e))))}beforePlay(){return this.stream$.pipe(Lu("beforePlay"),cr((({state:e})=>this.helper.updateVideoProperties(e))),pi((({state:e})=>{var t;const i=this.helper.shouldPlayPreroll(e.depth,null===(t=null==e?void 0:e.playlistItem)||void 0===t?void 0:t.mediaid);return i||Uu.resolve(),i})),Qt((e=>this.helper.awaitIasTracking(e))),cr((({state:e})=>this.helper.playVideoAd("preroll",e))))}videoMidPoint(){return this.stream$.pipe(Lu("videoMidPoint"),pi((({state:e})=>{var t;return this.helper.shouldPlayMidroll(e.depth,null===(t=null==e?void 0:e.playlistItem)||void 0===t?void 0:t.mediaid)})),cr((({state:e})=>this.helper.playVideoAd("midroll",e))))}beforeComplete(){return this.stream$.pipe(Lu("beforeComplete"),pi((({state:e})=>{var t;return this.helper.shouldPlayPostroll(e.depth,null===(t=null==e?void 0:e.playlistItem)||void 0===t?void 0:t.mediaid)})),cr((({state:e})=>this.helper.playVideoAd("postroll",e))))}};ju=a([Rn({scope:"Transient"})],ju);const Bu={init:"init",lateReady:"late_ready",ready:"ready",adBlock:"blocked",adClick:"clicked",adRequest:"loaded",adError:"error",adImpression:"impression",adStarted:"started",adViewableImpression:"viewable_impression",adFirstQuartile:"first_quartile",adMidPoint:"midpoint",adThirdQuartile:"third_quartile",adComplete:"completed",adSkipped:"skipped",videoStart:"content_started",complete:"content_completed",error:"content_error"};let $u=class{constructor(){this.lastKnownAdData={contentType:"",creativeId:"",lineItemId:""}}handle({adSlot:e,stream$:t}){return this.adSlot=e,t.pipe(pi((e=>this.isTrackingEvent(e))),cr((e=>this.track(e))))}track(e){const t=this.getVideoData(e),i=Ja.getEventData(t);Ja.emit(i),Ja.emitVideoEvent(e)}isTrackingEvent(e){return Object.keys(Bu).includes(e.name)}getVideoData(e){return this.lastKnownAdData.contentType=e.state.vastParams.contentType||this.lastKnownAdData.contentType,this.lastKnownAdData.creativeId=e.state.vastParams.creativeId||this.lastKnownAdData.creativeId,this.lastKnownAdData.lineItemId=e.state.vastParams.lineItemId||this.lastKnownAdData.lineItemId,{ad_error_code:this.getErrorCode(e),ad_product:this.getAdProduct(e),audio:e.state.mute?0:1,ctp:this.getCtp(e),content_type:this.lastKnownAdData.contentType,creative_id:this.lastKnownAdData.creativeId,line_item_id:this.lastKnownAdData.lineItemId,event_name:Bu[e.name],player:"jwplayer",position:this.adSlot.config.slotName,user_block_autoplay:this.getUserBlockAutoplay(),video_id:e.state.playlistItem.mediaid||"",video_number:e.state.depth||""}}getErrorCode(e){return["adError","error"].includes(e.name)?e.payload&&e.payload.code:0}getAdProduct(e){switch(e.state.adInVideo){case"none":return this.adSlot.config.slotName;case"midroll":case"postroll":case"preroll":return`${this.adSlot.config.trackingKey}-${e.state.adInVideo}`;default:return this.adSlot.config.trackingKey}}getCtp(e){return e.state.depth>1||e.state.config.autostart?0:1}getUserBlockAutoplay(){switch(v.get("featuredVideoAutoplay")||"-1"){case"1":return 1;case"0":return 0;default:return-1}}};$u=a([Rn({scope:"Transient"})],$u);const Fu=R("[JWPlayer] Player Ready",{_as:"props",_p:void 0}),Hu=R("[Ad Engine] Setup JWPlayer",{_as:"props",_p:void 0});let Gu=class{manage(){this.onPlayerReady().pipe(Qt((e=>ai((new ju).handle(e),(new $u).handle(e),(new Ru).handle(e))))).subscribe()}onPlayerReady(){return _i.action$.pipe(Si(Fu),du((()=>{this.loadIasTrackerIfEnabled()})),Nt((({options:e,targeting:t,playerKey:i})=>{const n=window[i],s=this.createAdSlot(e,n),r=function(e){const t=function(e){const t=_u({name:"init",payload:void 0}),i=function(e){return e.getConfig().itemReady?_u({name:"lateReady",payload:void 0}):_u()}(e),n=ku(e,"adRequest"),s=ku(e,"adError").pipe(Nu(e),function(e){const t=ai(_u({payload:{tag:null}}),e.pipe(Nt((e=>e.payload))));return e=>e.pipe(cu(t),Nt((([e,t])=>Object.assign({},t,(e=>{for(const t in e)void 0===e[t]&&delete e[t];return e})(e)))))}(n));return ai(t,i,s,n,ku(e,"adImpression"),ku(e,"adBlock"),ku(e,"adsManager"),ku(e,"beforePlay").pipe(Nu(e)),ku(e,"videoMidPoint"),ku(e,"beforeComplete"),ku(e,"complete"),ku(e,"ready"),ku(e,"adClick"),ku(e,"adStarted"),ku(e,"adViewableImpression"),ku(e,"adFirstQuartile"),ku(e,"adMidPoint"),ku(e,"adThirdQuartile"),ku(e,"adComplete"),ku(e,"adSkipped"),ku(e,"videoStart"),ku(e,"error"))}(e),i=function(e,t){const i=e.pipe(Pu("beforePlay"),(e=>e.pipe(wu((e=>({correlator:Math.round(1e10*Math.random()),depth:e.depth+1})),{correlator:0,depth:0}))),Su({depth:0,correlator:0})),n=ai(e.pipe(Pu("adRequest"),(e=>e.pipe(wu((e=>e+1),0))),Su(1))),s=e.pipe(Pu("adRequest","adError","adImpression"),(e=>e.pipe(Nt((e=>pu.parse(e.payload.tag,{imaAd:e.payload.ima&&e.payload.ima.ad,eventAdPosition:e.payload.adposition}))))),Su(pu.parse(null))),r=ai(e.pipe(Pu("beforePlay"),Nt((()=>"preroll"))),e.pipe(Pu("videoMidPoint"),Nt((()=>"midroll"))),e.pipe(Pu("beforeComplete"),Nt((()=>"postroll"))));return vu([i,n,s,ai(e.pipe(Pu("adStarted"),cu(r),Nt((([,e])=>e))),e.pipe(Pu("complete"),Nt((()=>"none")),Su("bootstrap"))),e.pipe(Nt((()=>({playlistItem:t.getPlaylistItem()||{sources:[],tracks:[],variations:[],images:[],allSources:[]},config:t.getConfig(),mute:t.getMute()}))))]).pipe(Nt((([e,t,i,n,s])=>Object.assign(Object.assign(Object.assign({},s),e),{vastParams:i,adInVideo:n,rv:t}))),ui(1))}(t,e);return t.pipe(cu(i),Nt((([e,t])=>Object.assign(Object.assign({},e),{state:t}))))}(n);return{jwplayer:n,adSlot:s,targeting:t,stream$:r}})))}createAdSlot(e,t){const i=e.slotName||(e.featured?"featured":"video"),n=Qr.get(i)||new zr({id:i}),s=t&&t.getContainer&&t.getContainer();return n.element=s&&s.parentNode,n.setConfigProperty("audio",!t.getMute()),n.setConfigProperty("autoplay",t.getConfig().autostart),Qr.get(i)||Qr.add(n),n}loadIasTrackerIfEnabled(){O.get("options.video.iasTracking.enabled")&&lu.load()}};var qu,Wu,Ku,Yu,Qu;Gu=a([Rn()],Gu);let Ju=class{constructor(e,t,i,n,s){this.fetchTimeout=e,this.bidders=i,this.tcf=n,this.usp=s,this.timeout=t.get("icVastRequestTimeout",500)}buildTaglessVideoRequest(){return c(this,arguments,void 0,(function*(e=!0){const t="featured",i={vpos:"preroll",targeting:yield this.bidders.getBidParameters(t),isTagless:e};return eo(0,t,yield this.extendOptionsBasedOnPrivacyData(i))}))}extendOptionsBasedOnPrivacyData(e){return c(this,void 0,void 0,(function*(){if(this.tcf.exists){const t=yield this.tcf.getTCData();e=Object.assign(Object.assign({},e),{gdpr_consent:t.tcString})}if(this.usp.exists){const t=yield this.usp.getSignalData();e=Object.assign(Object.assign({},e),{us_privacy:t.uspString})}return e}))}getVast(){return c(this,void 0,void 0,(function*(){try{const e=yield this.buildTaglessVideoRequest(),t=yield this.fetchTimeout.fetch(e,this.timeout),i=yield t.text(),n=this.getFirstAdFromTaglessResponse(i);return Uu.resolve(n.lineItemId,n.creativeId),n}catch(e){Uu.resolve()}}))}getFirstAdFromTaglessResponse(e){var t,i;const n=(new DOMParser).parseFromString(e,"text/xml"),s=n.getElementsByTagName("Ad"),r=n.getElementsByTagName("Creative");return{xml:s.length>0?e:void 0,lineItemId:null===(t=s[0])||void 0===t?void 0:t.getAttribute("id"),creativeId:null===(i=r[0])||void 0===i?void 0:i.getAttribute("id")}}};var Xu,Zu,ep,tp,ip;Ju=a([Rn(),l("design:paramtypes",["function"==typeof(qu=void 0!==e&&un)?qu:Object,"function"==typeof(Wu=void 0!==po&&po)?Wu:Object,"function"==typeof(Ku=void 0!==Fl&&Fl)?Ku:Object,"function"==typeof(Yu=void 0!==Co&&Co)?Yu:Object,"function"==typeof(Qu=void 0!==Po&&Po)?Qu:Object])],Ju);const np="player-setup",sp="featured";let rp=!1,op=Xu=class extends jo{constructor(e,t,i,n){var s;super(e,t),this.instantConfig=e,this.globalTimeout=t,this.jwpManager=i,this.vastTaglessRequest=n,this.jwpManager=i||new Gu;const r=null===("wgArticleFeaturedVideo",s=window.mw&&window.mw.config?window.mw.config.get("wgArticleFeaturedVideo"):null)||void 0===s?void 0:s.mapping;const o=!(!(null==r?void 0:r.connatixMediaId)&&!(null==r?void 0:r.connatixPlaylistId));this.connatixFeaturedVideoEnabled="connatix"===this.instantConfig.get("icFeaturedVideoPlayer")&&o}call(){return c(this,void 0,void 0,(function*(){_i.on(Qa,(()=>{this.loadIasTrackerIfEnabled()}));const e=!O.get("options.wad.blocking")&&!y.get("novideoads"),t=this.getPrimaryVideoAdSlot();us.set("player",this.connatixFeaturedVideoEnabled?"cnx":"jwp",sp);const i=e&&zu.isSyncEnabled()&&zu.isTaglessRequestEnabled()?yield this.vastTaglessRequest.getVast():void 0;this.connatixFeaturedVideoEnabled?Xu.initConnatixPlayer(e,t,i):yield this.initJWPlayer(e,i)}))}initJWPlayer(e,t){return c(this,void 0,void 0,(function*(){Wn(np,"JWP with ads controlled by AdEngine enabled");const i=O.get("options.video.enableStrategyRules");(null==t?void 0:t.xml)&&(zu.setVastRequestedBeforePlayer(),Wn(np,"display and video sync response available")),e&&!i?(_i.dispatch(Hu({showAds:e,autoplayDisabled:!1,vastXml:null==t?void 0:t.xml})),this.jwpManager.manage()):i?(Wn(np,"JWP Strategy Rules enabled - AdEngine does not control ads in JWP anymore"),_i.dispatch(Hu({showAds:e,autoplayDisabled:!1,vastUrl:yield this.vastTaglessRequest.buildTaglessVideoRequest(!1),vastXml:null==t?void 0:t.xml,strategyRulesEnabled:i}))):(Wn(np,"ad block detected, without ads"),_i.dispatch(Hu({showAds:e,autoplayDisabled:!1})))}))}getPrimaryVideoAdSlot(){const e=Qr.get(sp)||new zr({id:sp});return this.connatixFeaturedVideoEnabled&&(e.config.adProduct="cnx-featured"),Qr.get(sp)||Qr.add(e),e}loadIasTrackerIfEnabled(){O.get("options.video.iasTracking.enabled")&&(Wn(np,"Loading IAS tracker for video player"),lu.load())}static initConnatixPlayer(e,t,i){Wn(np,"Connatix with ads not controlled by AdEngine enabled"),(null==i?void 0:i.xml)&&(zu.setVastRequestedBeforePlayer(),Wn(np,"display and video sync response available")),_i.on(Ka,(e=>{const{name:i,state:n}=e.videoEvent;Xu.resolveVideoDisplaySyncBasedOnPlayerEvent(i,n,t)}),!1),_i.on(gr,(({slotName:n})=>{n===sp&&Xu.emitVideoSetupEvent(e,t,i)}),!1)}static resolveVideoDisplaySyncBasedOnPlayerEvent(e,t,i){"adImpression"===e?(rp=!0,Uu.resolve(t.vastParams.lineItemId,t.vastParams.creativeId),i.setStatus(zs.STATUS_SUCCESS),i.emit(bs.VIDEO_AD_IMPRESSION)):(e=>"play"===e&&!rp)(e)?Xu.registerTimeoutForVideoDisplayTakeoverSync((()=>!0===rp)):["adError","playError"].includes(e)?Uu.resolve():console.warn("resolveVideoDisplaySyncBasedOnPlayerEvent() called with not handled event: ",e)}static registerTimeoutForVideoDisplayTakeoverSync(e){new uo(e,1,zu.getSyncTimeout()).until().then((()=>{Uu.resolve()}))}static emitVideoSetupEvent(e,t,i){_i.emit(Wa,{showAds:e,autoplayDisabled:!1,videoAdUnitPath:t.getVideoAdUnit(),targetingParams:Zr(t,{player:"cnx"},!1),vastXml:null==i?void 0:i.xml})}};function ap(e){(new ha).track({category:"ads-babdetector-detection",action:"impression",label:e?"Yes":"No",value:0})}op=Xu=a([Rn(),l("design:paramtypes",["function"==typeof(Zu=void 0!==po&&po)?Zu:Object,"function"==typeof(ep=void 0!==e&&Yn)?ep:Object,"function"==typeof(tp=void 0!==Gu&&Gu)?tp:Object,"function"==typeof(ip=void 0!==Ju&&Ju)?ip:Object])],op);const dp="bt-loader",lp=new class{run(){return c(this,void 0,void 0,(function*(){if(!this.isEnabled())return Wn(dp,"disabled"),Promise.resolve();this.btDetectionEvents(),this.insertSideUnits(),Wn(dp,"loading"),yield this.loadScript()}))}isEnabled(){return O.get("options.wad.btRec.enabled")&&O.get("options.wad.blocking")}btDetectionEvents(){const e=t=>{t.detail.ab?(Wn(dp,"BTAADetection - AdBlock detected"),ap(!0)):ap(!1),window.removeEventListener("BTAADetection",e)};window.addEventListener("BTAADetection",e);const t=e=>{e.detail&&Wn(dp,"AcceptableAdsInit"),window.removeEventListener("AcceptableAdsInit",t)};window.addEventListener("AcceptableAdsInit",t)}loadScript(){const e=O.get("options.wad.btRec.loaderUrl")||"https://btloader.com/tag?o=5199505043488768&upapi=true";return ms.loadScriptWithStatus(e,dp,!0,"first")}insertSideUnits(){if(O.get("state.isMobile")||!O.get("options.wad.btRec.sideUnits")||document.body.classList.contains("is-content-expanded")||document.documentElement.classList.contains("is-content-expanded"))return;const e=document.querySelector(".page.has-right-rail, .mainpage .page");if(!e||(window.document.body.scrollWidth||0)<1542)return;const t=document.createElement("div"),i=document.createElement("div");t.className="side-bt-container left",i.className="side-bt-container right",e.prepend(t,i);const n=document.createElement("div"),s=document.createElement("div");n.id="btbgleft",s.id="btbgright",t.append(n),i.append(s)}},cp="bab-detection";let up,pp=!1;const hp=new class{getName(){return cp}isEnabled(){return O.get("options.wad.enabled")}isBlocking(){return O.get("options.wad.blocking")}run(){return c(this,void 0,void 0,(function*(){let e=yield this.checkBlocking();return Wn(cp,"BAB detection, AB detected:",e),e||(e=yield this.checkDomainBlocking(),Wn(cp,"GAM domain blocking detection - detected:",e)),this.setBodyClass(e),this.setRuntimeParams(e),this.updateSrcParameter(e),this.dispatchDetectionEvents(e),e}))}checkBlocking(e=(()=>{}),t=(()=>{})){return new Promise((e=>{if(!pp){if(!this.blockAdBlockExists())return void e(!0);this.setupBab()}up.onDetected((()=>e(!0))),up.onNotDetected((()=>e(!1))),up.check(!0)})).then((i=>(i?e():t(),i)))}blockAdBlockExists(){return"undefined"!=typeof BlockAdBlock}checkDomainBlocking(){return c(this,void 0,void 0,(function*(){let e=!1;try{yield fetch("https://www.doubleclick.net",{method:"HEAD",mode:"no-cors",cache:"no-store"})}catch(t){e=!0}return e}))}setupBab(){up=this.createBlockAdBlock(),pp=!0}createBlockAdBlock(){return new BlockAdBlock({checkOnLoad:!1,resetOnEnd:!0,loopCheckTime:50,loopMaxNumber:5,debug:!!y.get("bt_rec_debug")||!1})}setRuntimeParams(e){window.ads.runtime=window.ads.runtime||{},window.ads.runtime.bab=window.ads.runtime.bab||{},window.ads.runtime.bab.blocking=e,O.set("options.wad.blocking",e)}updateSrcParameter(e){const t=O.get("options.wad.blockingSrc");e&&t&&O.set("src",t)}dispatchDetectionEvents(e){const t=document.createEvent("Event"),i=e?"bab.blocking":"bab.not_blocking";t.initEvent(i,!0,!1),document.dispatchEvent(t),_i.emit(ys,{detected:e})}setBodyClass(e){e&&document.body.classList.add("bab-detected")}},gp=()=>{Gs.finishFirstCall(),lp.run()};class mp extends jo{constructor(){super(...arguments),this.detector=hp,this.onDetected=gp}call(){return c(this,void 0,void 0,(function*(){if(!this.detector.isEnabled())return Promise.resolve();const e=yield this.detector.run();O.set("options.wad.blocking",e),e&&this.onDetected()}))}}var fp;let vp=class{constructor(e){this.globalTimeout=e,this.steps=[],this.globalTimeout.set("partner-pipeline",O.get("options.maxDelayTimeout"))}add(...e){return this.steps=e,this}execute(e=[]){return this.steps.forEach((t=>{if("function"==typeof t){const i=t({});i.execute(),e.push(i.initialized)}else t.execute(),e.push(t.initialized)})),Promise.all(e)}};vp=a([Rn({scope:"Transient"}),l("design:paramtypes",["function"==typeof(fp=void 0!==Yn&&Yn)?fp:Object])],vp);const bp="captify";class yp extends jo{constructor(){super(...arguments),this.propertyId=12974}call(){return c(this,void 0,void 0,(function*(){return this.isEnabled("icCaptify")?(this.overwritePropertyIdIfPresent(),this.createCaptifyWindowObject(),this.createAndInsertScript(),Promise.resolve()):(Wn(bp,"disabled"),Promise.resolve())}))}overwritePropertyIdIfPresent(){const e=O.get("services.captify.propertyId");this.propertyId=e||this.propertyId}createCaptifyWindowObject(){window[`captify_kw_query_${this.propertyId}`]=""}createAndInsertScript(){const e=`https://p.cpx.to/p/${this.propertyId}/px.js`,t=document.getElementsByTagName("script")[0],i=ls.createScript(e,!1,t);_i.emit(Ei.PARTNER_LOAD_STATUS,{status:"captify_started"}),i.onload=()=>{_i.emit(Ei.PARTNER_LOAD_STATUS,{status:"captify_loaded"}),Wn(bp,"loaded")}}}const Sp="confiant";function wp(e,t,i,n,s,r){if(r&&r.dfp){const t=r.dfp.s,i=Qr.get(t);i&&i.emitEvent(`confiant-${e}`)}}class _p extends jo{constructor(){super(...arguments),this.scriptDomain="cdn.confiant-integrations.net",this.propertyId="d-aIf3ibf0cYxCLB1HTWfBQOFEA"}call(){return this.isEnabled("icConfiant",!1)?(this.overwritePropertyIdIfPresent(),Wn(Sp,"loading"),window.confiant=window.confiant||{},window.confiant.callback=wp,this.loadScript().then((()=>{Wn(Sp,"ready")}))):(Wn(Sp,"disabled"),Promise.resolve())}overwritePropertyIdIfPresent(){const e=O.get("services.confiant.propertyId");this.propertyId=e||this.propertyId}loadScript(){const e=`//${this.scriptDomain}/${this.propertyId}/gpt_and_prebid/config.js`;return ms.loadScriptWithStatus(e,Sp,!0,"first")}}const Ep="double-verify",Tp=window.location.href;class Ip extends jo{constructor(){super(...arguments),this.isLoaded=!1,this.slots=[],this.adUnits=[]}call(){return c(this,void 0,void 0,(function*(){if(!this.isLoaded)if(this.isEnabled("icDoubleVerify"))if(this.slots=O.get("services.doubleVerify.slots"),this.slots){this.setInitialTargeting();try{const e=this.prepareRequestURL(),t=this.getRequestHeaders(),i=yield fetch(e.href,{headers:t});if(!i.ok)throw new Error("Error fetching signals");const n=yield i.json();this.isLoaded=!0,this.setTargeting(n)}catch(e){Wn(Ep,"Error fetching signals",e)}}else Wn(Ep,"Empty slots configuration");else Wn(Ep,"disabled")}))}setInitialTargeting(){us.set("ids","-1"),us.set("bsc","-1"),us.set("abs","-1"),this.slots.forEach((e=>{us.set("tvp","-1",e),us.set("vlp","-1",e)}))}setTargeting(e){var t,i;Wn(Ep,"Setting targeting",e),us.set("ids",null===(t=e.IDS)||void 0===t?void 0:t.toString()),us.set("bsc",e.BSC),us.set("abs",null===(i=e.ABS)||void 0===i?void 0:i.toString()),this.addToSlotsTargeting(e.TVP,"tvp"),this.addToSlotsTargeting(e.VLP,"vlp")}addToSlotsTargeting(e,t){"object"==typeof e&&Object.entries(e).forEach((([e,i])=>{var n;const s=this.adUnits.find((t=>t.path===e)),r=null!==(n=null==s?void 0:s.slotName)&&void 0!==n?n:"";us.set(t,i[""],r)}))}getRequestHeaders(){return{referer:Tp,"user-agent":window.navigator.userAgent}}prepareRequestURL(){const e=new URLSearchParams({ctx:"28150781",cmp:"DV1001654",url:encodeURIComponent(Tp)});this.adUnits=this.getAdUnitsForRequest(),Object.values(this.adUnits).forEach((({path:t})=>{e.append(`adunits[${t}][]`,"")}));const t=new URL("https://pub.doubleverify.com/signals/pub.json");return t.search=e.toString(),t}getAdUnitsForRequest(){return this.slots.map((e=>{const t=Object.assign({},O.get(`slots.${e}`));return t.slotNameSuffix=t.slotNameSuffix||"",{slotName:e,path:ps.build(t.adUnit||O.get("adUnitId"),{slotConfig:t})}}))}}const Ap="experian";class Cp extends jo{constructor(){super(...arguments),this.PARTNER_ID=3442,this.PARTNER_URL_CORE="https://services.fandom.com/identity-storage/external/experian/receiveid",this.EXPERIAN_URL="https://pixel.tapad.com/idsync/ex/receive"}call(){this.isEnabled("icExperian")?this.insertExperianPixel():Wn(Ap,"disabled")}getExperianPixelUrl(){const e=us.get("ppid"),t=O.get("wiki.pvUID"),i=`${this.PARTNER_URL_CORE}/${t}?id=\${TA_DEVICE_ID}\n\t\t\t&partner=TAPAD`;return`${this.EXPERIAN_URL}?partner_id=${this.PARTNER_ID}\n\t\t&partner_device_id=${e}&partner_url=${i}`}insertExperianPixel(){_i.emit(Ei.PARTNER_LOAD_STATUS,{status:"experian_started"}),Ti.loadPixel(this.getExperianPixelUrl(),Ap)}}const Op="ias-publisher-optimization",Pp=["adt","alc","dlm","drg","hat","off","vio"],kp={veryLow:1,low:2,medium:3,high:4};class Np extends jo{constructor(){super(...arguments),this.isLoaded=!1,this.slotList=[]}call(){return this.isEnabled("icIASPublisherOptimization")?this.isLoaded?void 0:(Wn(Op,"loading..."),this.isLoaded=!0,ms.loadScriptWithStatus("//cdn.adsafeprotected.com/iasPET.1.js",Op,!0,"first").then((()=>{Wn(Op,"asset loaded"),this.setup()}))):(Wn(Op,"disabled"),Promise.resolve())}setup(){const e=[];this.slotList=O.get("services.iasPublisherOptimization.slots"),this.setInitialTargeting(),this.slotList.forEach((t=>{const i=O.get(`slots.${t}`),n={adUnitPath:ps.build(i.adUnit||O.get("adUnitId"),{slotConfig:i}),adSlotId:t,size:this.getSlotSize(i)};i.isVideo&&(n.type="video"),e.push(n)})),window.__iasPET=window.__iasPET||{},window.__iasPET.queue=window.__iasPET.queue||[],window.__iasPET.pubId="930616",window.__iasPET.queue.push({adSlots:e,dataHandler:this.iasDataHandler.bind(this)})}getSlotSize(e){return e.isVideo?[1,1]:e.sizes&&e.sizes.length?e.sizes[0].sizes:e.defaultSizes}setInitialTargeting(){Wn(Op,"setting initial targeting..."),us.set("fr","-1"),us.set("b_ias","-1"),us.set("ias-kw","-1"),Pp.forEach((e=>{us.set(e,"-1")})),this.slotList.forEach((e=>{us.set("vw","-1",e)}))}iasDataHandler(e){Wn(Op,"handling IAS response...");const t=JSON.parse(e);us.set("fr",t.fr),Np.setBrandSafetyKeyValuesInTargeting(t.brandSafety),Np.setCustomKeyValuesInTargeting(t.custom);for(const[e,i]of Object.entries(t.slots))us.set("vw",i.vw||i.vw_vv,e);Wn(Op,"Done.",this)}static setBrandSafetyKeyValuesInTargeting(e){if(!e)return void Wn(Op,"no brand safety data");let t="-1";Pp.forEach((i=>{e[i]&&(us.set(i,e[i]),("-1"===t||kp[t]<kp[e[i]])&&(t=e[i]))})),us.set("b_ias",t)}static setCustomKeyValuesInTargeting(e){e["ias-kw"]?us.set("ias-kw",e["ias-kw"]):Wn(Op,"no custom data")}}const Lp=new class{constructor(){this.storage=new Ro}isAvailable(){return this.storage.isAvailable()}getItem(e){const t=this.storage.getItem(e);return!(!t||"string"==typeof t)&&(this.isExpired(t)?(this.delete(e),!1):t.data)}setItem(e,t,i){if(!this.isStorable(t))return!1;const n={data:t,expires:i?1e3*i+Date.now():void 0};return this.storage.setItem(e,n),!0}delete(e){this.storage.removeItem(e)}isStorable(e){const t=!["function","number","undefined"].some((t=>typeof e===t)),i=!("number"==typeof e&&isNaN(e));return t&&i}isExpired(e){return!!e.expires&&e.expires&&Date.now()>=e.expires}},Rp="liveConnect",Dp=Rp,xp=[{id:"unifiedId",name:`${Rp}-unifiedId`},{id:"sha2",name:Rp},{id:"md5",name:`${Rp}-md5`},{id:"sha1",name:`${Rp}-sha1`}];class zp extends jo{constructor(){super(...arguments),this.fallbackQf="0.3"}call(){this.isEnabled("icLiveConnect")&&this.isEnabled("icLiveConnectCachingStrategy")&&!this.isEnabled("icIdentityPartners",!1)?(this.setupStorage(),this.shouldLoadScript()?(Wn(Dp,"loading"),_i.emit(Ei.LIVE_CONNECT_STARTED),ls.loadScript("https://b-code.liadm.com/a-07ev.min.js",!0,"first").then((()=>{Wn(Dp,"loaded"),this.resolveAndTrackIds(),_i.emit(Ei.LIVE_CONNECT_LOADED)}))):(_i.emit(Ei.LIVE_CONNECT_CACHED),Wn(Dp,`already loaded and available in ${this.storageConfig.type}Storage`))):Wn(Dp,"disabled")}resolveAndTrackIds(){var e;if(!window.liQ)return void Kn(Dp,"window.liQ not available for tracking");const t=null===(e=this.instantConfig.get("icLiveConnectQf"))||void 0===e?void 0:e.toString();window.liQ.resolve((e=>{this.trackIds(e)}),(e=>{console.error(e)}),{qf:t||this.fallbackQf,resolve:xp.map((e=>e.id))})}trackIds(e){Wn(Dp,"resolve response:",e),Object.keys(e).forEach((t=>{const i=this.getTrackingKeyName(t);if(this.isAvailableInStorage(i))return;"unifiedId"===t&&_i.emit(Ei.LIVE_CONNECT_RESPONDED_UUID);const n=e[t];Wn(Dp,`${t}: ${n}`),n&&(this.storage.setItem(i,n,this.storageConfig.ttl),_i.emit(Ei.IDENTITY_PARTNER_DATA_OBTAINED,{partnerName:i,partnerIdentityId:n}))}))}getTrackingKeyName(e){var t;return null===(t=xp.find((t=>t.id===e)))||void 0===t?void 0:t.name}setupStorage(){this.storageConfig=this.instantConfig.get("icLiveConnectCachingStrategy"),"local"===this.storageConfig.type?this.storage=Lp:this.storage=new Ro((()=>window.sessionStorage))}shouldLoadScript(){var e;if(!this.storageConfig)return!0;let t=!1;for(const i of this.storageConfig.mandatoryParams){const n=null===(e=xp.find((e=>e.id===i)))||void 0===e?void 0:e.name;if(!this.isAvailableInStorage(n)){t=!0;break}}return t}isAvailableInStorage(e){return!!this.storage.getItem(e)}}class Vp extends jo{constructor(){super(...arguments),this.PIXEL_ID=712315,this.logGroup="liveramp_pixel",this.PIXEL_URL=`https://idsync.rlcdn.com/${this.PIXEL_ID}.gif?partner_uid=`}insertLiveRampPixel(e){_i.emit(Ei.PARTNER_LOAD_STATUS,{status:this.logGroup+"_started"});const t=this.PIXEL_URL+e;Ti.loadPixel(t,this.logGroup)}call(){return c(this,void 0,void 0,(function*(){this.isEnabled("icLiveRampPixel")?_i.on(Ei.IDENTITY_PARTNER_DATA_OBTAINED,(e=>{"Google"===e.payload.partnerName&&this.insertLiveRampPixel(e.payload.partnerIdentityId)})):Wn(this.logGroup,"pixel disabled")}))}}const Mp=["gnre","media","pform","pub","theme","tv"];class Up extends jo{constructor(){super(...arguments),this.CLIENT_ID=17364,this.logGroup="Lotame",this.PIXEL_URL=`https://tags.crwdcntrl.net/lt/c/${this.CLIENT_ID}/lt.min.js`}call(){return c(this,void 0,void 0,(function*(){var e,t;if(!this.isEnabled("icLotame"))return void Wn(this.logGroup,"pixel disabled");const i={data:{behaviors:{med:function(e={}){return Object.entries(e).filter((([e])=>Mp.includes(e))).flatMap((([e,t])=>t.map((t=>`${e}: ${t}`))))}(null===(t=null===(e=window.fandomContext)||void 0===e?void 0:e.site)||void 0===t?void 0:t.tags)}},config:{clientId:this.CLIENT_ID,onTagReady:()=>_i.emit(Ei.PARTNER_LOAD_STATUS,{status:"lotame_ready"})}},n=i.config||{},s=window["lotame_"+this.CLIENT_ID]={};s.config=n,s.data=i.data||{},s.cmd=s.cmd||[],Wn(this.logGroup,"pixel enabled"),_i.emit(Ei.PARTNER_LOAD_STATUS,{status:"lotame_started"}),yield ls.loadScript(this.PIXEL_URL),_i.emit(Ei.PARTNER_LOAD_STATUS,{status:"lotame_loaded"})}))}}var jp,Bp,$p,Fp,Hp,Gp,qp,Wp,Kp,Yp,Qp,Jp,Xp,Zp,eh,th;let ih=class{constructor(e,t,i,n,s,r,o,a,d,l,c,u,p,h,g,m){this.pipeline=e,this.adEngineStackSetup=t,this.anyclip=i,this.audigent=n,this.bidders=s,this.captify=r,this.confiant=o,this.doubleVerify=a,this.experian=d,this.gptSetup=l,this.iasPublisherOptimization=c,this.liveConnect=u,this.liveRampPixel=p,this.playerSetup=h,this.wadRunner=g,this.lotame=m}execute(){this.pipeline.add(this.lotame,this.anyclip,this.bidders,this.wadRunner,this.liveRampPixel,this.liveConnect,this.experian,this.audigent,this.confiant,this.iasPublisherOptimization,this.captify,this.playerSetup.setOptions({dependencies:[this.bidders.initialized,this.wadRunner.initialized]}),this.gptSetup,this.doubleVerify,this.adEngineStackSetup.setOptions({dependencies:[this.bidders.initialized,this.wadRunner.initialized,this.gptSetup.initialized]})).execute().then((()=>{var e,t;(null===(t=null===(e=null===window||void 0===window?void 0:window.Phoenix)||void 0===e?void 0:e.Events)||void 0===t?void 0:t.trigger)&&window.Phoenix.Events.trigger("ads_initialized"),_i.emit(Is)}))}};ih=a([Rn(),l("design:paramtypes",["function"==typeof(jp=void 0!==vp&&vp)?jp:Object,"function"==typeof(Bp=void 0!==au&&au)?Bp:Object,"function"==typeof($p=void 0!==Zc&&Zc)?$p:Object,"function"==typeof(Fp=void 0!==Fo&&Fo)?Fp:Object,"function"==typeof(Hp=void 0!==Fl&&Fl)?Hp:Object,"function"==typeof(Gp=void 0!==yp&&yp)?Gp:Object,"function"==typeof(qp=void 0!==_p&&_p)?qp:Object,"function"==typeof(Wp=void 0!==Ip&&Ip)?Wp:Object,"function"==typeof(Kp=void 0!==Cp&&Cp)?Kp:Object,"function"==typeof(Yp=void 0!==Ho&&Ho)?Yp:Object,"function"==typeof(Qp=void 0!==Np&&Np)?Qp:Object,"function"==typeof(Jp=void 0!==zp&&zp)?Jp:Object,"function"==typeof(Xp=void 0!==Vp&&Vp)?Xp:Object,"function"==typeof(Zp=void 0!==op&&op)?Zp:Object,"function"==typeof(eh=void 0!==mp&&mp)?eh:Object,"function"==typeof(th=void 0!==Up&&Up)?th:Object])],ih);const nh={adUnitId:"/{custom.dfpId}/{custom.device}{custom.region}-{custom.property}{custom.pagePath}",custom:{dfpId:"5441",region:"aw",property:"gamefaqs",timeouts:{bidder:1e3}},events:{pushOnScroll:{ids:[],threshold:100}},services:{anyclip:{pubname:"1999",widgetname:"001w000001Y8ud2AAB_M7731",libraryUrl:"//player.anyclip.com/anyclip-widget/lre-widget/prod/v1/src/lre.js"},doubleVerify:{slots:["mpu_top","top_leaderboard"]},iasPublisherOptimization:{slots:["mpu_top"]}},slots:{},src:["gamefaqs"],options:{customAdLoader:{globalMethodName:"loadCustomAd"},preload:{gpt:!1,audigent:!0,prebid:!0,apstag:!1,intentIq:!0}}};let sh=class{execute(){O.set("bidders.a9.slots",this.getA9Context())}getA9Context(){return O.get("state.isMobile")?{"mobile-skybox-nav":{sizes:[[320,50]]},"mobile-native-top":{sizes:[[300,250],[320,50]]},"mobile-incontent-ad":{sizes:[[300,250],[320,50]]},"mobile-mpu-banner-bottom":{sizes:[[300,250],[320,50]]},"mobile-native-plus-top":{sizes:[[300,250],[320,50]]},"mobile-highimpact-plus":{sizes:[[300,250],[320,50]]},"incontent-mobile-flex":{sizes:[[300,250],[320,50]]},"mobile-banner":{sizes:[[320,50]]},"mobile-mpu":{sizes:[[300,250]]},"mobile-nav-ad-plus":{sizes:[[320,50]]},"mobile-banner-plus-inc":{sizes:[[300,250],[320,50]]},"mobile-incontent-ad-plus":{sizes:[[300,250],[320,50]]},"mobile-banner-mpu":{sizes:[[300,250],[320,50]]},"incontent-ad-plus":{sizes:[[728,90]]},floor_adhesion:{sizes:[[300,50],[320,50],[320,100]]},video:{type:"video"}}:{"skybox-nav":{sizes:[[728,90],[970,250]]},"incontent-ad":{sizes:[[728,90]]},leader_plus_top:{sizes:[[728,90],[970,250]]},leader_top:{sizes:[[728,90]]},mpu_top:{sizes:[[300,250]]},mpu_plus_top:{sizes:[[300,250],[300,600]]},mpu_bottom:{sizes:[[300,250]]},leader_bottom:{sizes:[[728,90]]},"nav-ad-plus":{sizes:[[728,90]]},video:{type:"video"}}}};var rh;sh=a([Rn()],sh);let oh=class{constructor(e){this.bidders=e}execute(){const e=!O.get("state.isMobile");O.set("bidders.prebid.appnexus",function(e){return{enabled:!1,slots:e?{"incontent-ad":{sizes:[[728,90]],placementId:["28574380"]},leader_plus_top:{sizes:[[728,90],[970,250]],placementId:["28574381","28574382"]},leader_top:{sizes:[[728,90]],placementId:["28574383"]},mpu_top:{sizes:[[300,250]],placementId:["28574384"]},mpu_plus_top:{sizes:[[300,250],[300,600]],placementId:["28574385","28574386"]},mpu_bottom:{sizes:[[300,250]],placementId:["28574387"]},leader_bottom:{sizes:[[728,90]],placementId:["28574388"]},"nav-ad-plus":{sizes:[[728,90]],placementId:["28574403"]},"skybox-nav":{sizes:[[728,90],[970,250]],placementId:["29779630"]}}:{"mobile-native-top":{sizes:[[300,250],[320,50]],placementId:["28574389","28574390"]},"mobile-incontent-ad":{sizes:[[300,250],[320,50]],placementId:["28574391","28574392"]},"mobile-mpu-banner-bottom":{sizes:[[300,250],[320,50]],placementId:["28574393","28574394"]},"mobile-native-plus-top":{sizes:[[300,250],[320,50]],placementId:["28574395","28574396"]},"mobile-highimpact-plus":{sizes:[[300,250],[320,50]],placementId:["28574397","28574398"]},"incontent-mobile-flex":{sizes:[[300,250],[320,50]],placementId:["28574399","28574400"]},"mobile-banner":{sizes:[[320,50]],placementId:["28574401"]},"mobile-mpu":{sizes:[[300,250]],placementId:["28574402"]},"mobile-nav-ad-plus":{sizes:[[320,50]],placementId:["28574404"]},"mobile-banner-plus-inc":{sizes:[[300,250],[320,50]],placementId:["28574405","28574406"]},"mobile-incontent-ad-plus":{sizes:[[300,250],[320,50]],placementId:["28574407","28574408"]},"mobile-banner-mpu":{sizes:[[300,250],[320,50]],placementId:["28574409","28574410"]},"incontent-ad-plus":{sizes:[[728,90]],placementId:["28574411"]},"mobile-skybox-nav":{sizes:[[320,50],[320,100]],placementId:["29779631"]}}}}(e)),O.set("bidders.prebid.appnexusAst",function(e){return{enabled:!1,slots:e?{video:{placementId:"29038681"}}:{video:{placementId:"29038704"}}}}(e)),O.set("bidders.prebid.indexExchange",function(e){return{enabled:!1,slots:e?{"incontent-ad":{sizes:[[728,90]],siteId:["936116"]},leader_plus_top:{sizes:[[728,90],[970,250]],siteId:["936117","936118"]},leader_top:{sizes:[[728,90]],siteId:["936119"]},mpu_top:{sizes:[[300,250]],siteId:["936120"]},mpu_plus_top:{sizes:[[300,250],[300,600]],siteId:["936121","936122"]},mpu_bottom:{sizes:[[300,250]],siteId:["936123"]},leader_bottom:{sizes:[[728,90]],siteId:["936124"]},"nav-ad-plus":{sizes:[[728,90]],siteId:["936139"]},video:{siteId:"936616"},"skybox-nav":{sizes:[[728,90],[970,250]],siteId:"971592"}}:{"mobile-native-top":{sizes:[[300,250],[320,50]],siteId:["936125","936126"]},"mobile-incontent-ad":{sizes:[[300,250],[320,50]],siteId:["936127","936128"]},"mobile-mpu-banner-bottom":{sizes:[[300,250],[320,50]],siteId:["936129","936130"]},"mobile-native-plus-top":{sizes:[[300,250],[320,50]],siteId:["936131","936132"]},"mobile-highimpact-plus":{sizes:[[300,250],[320,50]],siteId:["936133","936134"]},"incontent-mobile-flex":{sizes:[[300,250],[320,50]],siteId:["936135","936136"]},"mobile-banner":{sizes:[[320,50]],siteId:["936137"]},"mobile-mpu":{sizes:[[300,250]],siteId:["936138"]},"mobile-nav-ad-plus":{sizes:[[320,50]],siteId:["936140"]},"mobile-banner-plus-inc":{sizes:[[300,250],[320,50]],siteId:["936141","936142"]},"mobile-incontent-ad-plus":{sizes:[[300,250],[320,50]],siteId:["936143","936144"]},"mobile-banner-mpu":{sizes:[[300,250],[320,50]],siteId:["936145","936146"]},"incontent-ad-plus":{sizes:[[728,90]],siteId:["936147"]},video:{siteId:"936617"},"mobile-skybox-nav":{sizes:[[320,50],[320,100]],siteId:"971593"}}}}(e)),O.set("bidders.prebid.kargo",function(e){return{enabled:!1,slots:e?{"incontent-ad":{sizes:[[728,90]],placementId:"_r4Gu3JPVTP"},leader_plus_top:{sizes:[[728,90],[970,250]],placementId:"_r4Gu3JPVTP"},leader_top:{sizes:[[728,90]],placementId:"_r4Gu3JPVTP"},mpu_top:{sizes:[[300,250]],placementId:"_fgZaPpiKvX"},mpu_plus_top:{sizes:[[300,250],[300,600]],placementId:"_l7isSJtCQz"},mpu_bottom:{sizes:[[300,250]],placementId:"_fgZaPpiKvX"}}:{"mobile-native-top":{sizes:[[300,250]],placementId:"_tMVy7XFXcU"},"mobile-incontent-ad":{sizes:[[300,250]],placementId:"_tMVy7XFXcU"},"mobile-native-plus-top":{sizes:[[300,250]],placementId:"_tMVy7XFXcU"},"incontent-mobile-flex":{sizes:[[300,250]],placementId:"_tMVy7XFXcU"},"mobile-mpu":{sizes:[[300,250]],placementId:"_tMVy7XFXcU"},"mobile-nav-ad-plus":{sizes:[[320,50]],placementId:"_r4Gu3JPVTP"},"mobile-banner-plus-inc":{sizes:[[300,250]],placementId:"_tMVy7XFXcU"},"mobile-incontent-ad-plus":{sizes:[[300,250]],placementId:"_tMVy7XFXcU"}}}}(e)),O.set("bidders.prebid.medianet",function(e){return{enabled:!1,slots:e?{"incontent-ad":{sizes:[[728,90]],crid:["342310474"],cid:"8CU5JOKX4"},leader_plus_top:{sizes:[[728,90],[970,250]],crid:["342310474","327181244"],cid:"8CU5JOKX4"},leader_top:{sizes:[[728,90]],crid:["342310474"],cid:"8CU5JOKX4"},mpu_top:{sizes:[[300,250]],crid:["785582676"],cid:"8CU5JOKX4"},mpu_plus_top:{sizes:[[300,250],[300,600]],crid:["785582676","633655848"],cid:"8CU5JOKX4"},mpu_bottom:{sizes:[[300,250]],crid:["785582676"],cid:"8CU5JOKX4"},leader_bottom:{sizes:[[728,90]],crid:["342310474"],cid:"8CU5JOKX4"},"nav-ad-plus":{sizes:[[728,90]],crid:["342310474"],cid:"8CU5JOKX4"}}:{"mobile-native-top":{sizes:[[300,250],[320,50]],crid:["150218268","479508368"],cid:"8CU5JOKX4"},"mobile-incontent-ad":{sizes:[[300,250],[320,50]],crid:["150218268","479508368"],cid:"8CU5JOKX4"},"mobile-mpu-banner-bottom":{sizes:[[300,250],[320,50]],crid:["150218268","479508368"],cid:"8CU5JOKX4"},"mobile-native-plus-top":{sizes:[[300,250],[320,50]],crid:["150218268","479508368"],cid:"8CU5JOKX4"},"mobile-highimpact-plus":{sizes:[[300,250],[320,50]],crid:["150218268","479508368"],cid:"8CU5JOKX4"},"incontent-mobile-flex":{sizes:[[300,250],[320,50]],crid:["150218268","479508368"],cid:"8CU5JOKX4"},"mobile-banner":{sizes:[[320,50]],crid:["479508368"],cid:"8CU5JOKX4"},"mobile-mpu":{sizes:[[300,250]],crid:["150218268"],cid:"8CU5JOKX4"},"mobile-nav-ad-plus":{sizes:[[320,50]],crid:["479508368"],cid:"8CU5JOKX4"},"mobile-banner-plus-inc":{sizes:[[300,250],[320,50]],crid:["150218268","479508368"],cid:"8CU5JOKX4"},"mobile-incontent-ad-plus":{sizes:[[300,250],[320,50]],crid:["150218268","479508368"],cid:"8CU5JOKX4"},"mobile-banner-mpu":{sizes:[[300,250],[320,50]],crid:["150218268","479508368"],cid:"8CU5JOKX4"},"incontent-ad-plus":{sizes:[[728,90]],crid:["173604207"],cid:"8CU5JOKX4"}}}}(e)),O.set("bidders.prebid.mgnipbs",function(e){return{enabled:!1,accountId:7450,slots:e?{"gamefaqs_dt_ic-lb":{sizes:[[728,90],[970,250],[970,66]]},"gamefaqs_dt_bottom-lb":{sizes:[[728,90],[970,250],[970,66]]},"gamefaqs_dt_ic-boxad":{sizes:[[300,250],[300,600],[160,600]]},gamefaqs_dt_top_boxad:{sizes:[[300,250],[300,600]]}}:{gamefaqs_adhesion_mw:{sizes:[[320,50],[320,100]]},gamefaqs_mw_bottom_lb:{sizes:[[320,50],[320,100]]},"gamefaqs_mw_ic-boxad":{sizes:[[320,50],[320,100]]},"gamefaqs_mw_ic-lb":{sizes:[[320,50],[320,100]]},gamefaqs_mw_top_boxad:{sizes:[[320,50],[320,100]]}}}}(e)),O.set("bidders.prebid.openx",function(e){return{enabled:!1,delDomain:"wikia-d.openx.net",slots:e?{video:{unit:"559098621"}}:{video:{unit:"559098622"}}}}(e)),O.set("bidders.prebid.pubmatic",function(e){return{enabled:!1,publisherId:"156260",slots:e?{"incontent-ad":{sizes:[[728,90]],ids:["4856830"]},leader_plus_top:{sizes:[[728,90],[970,250]],ids:["4856831","4856832"]},leader_top:{sizes:[[728,90]],ids:["4856833"]},mpu_top:{sizes:[[300,250]],ids:["4856834"]},mpu_plus_top:{sizes:[[300,250],[300,600]],ids:["4856835","4856836"]},mpu_bottom:{sizes:[[300,250]],ids:["4856837"]},leader_bottom:{sizes:[[728,90]],ids:["4856838"]},"nav-ad-plus":{sizes:[[728,90]],ids:["4856853"]},"skybox-nav":{sizes:[[728,90],[970,250]],ids:["5099302"]}}:{"mobile-native-top":{sizes:[[300,250],[320,50]],ids:["4856839","4856840"]},"mobile-incontent-ad":{sizes:[[300,250],[320,50]],ids:["4856841","4856842"]},"mobile-mpu-banner-bottom":{sizes:[[300,250],[320,50]],ids:["4856843","4856844"]},"mobile-native-plus-top":{sizes:[[300,250],[320,50]],ids:["4856845","4856846"]},"mobile-highimpact-plus":{sizes:[[300,250],[320,50]],ids:["4856847","4856848"]},"incontent-mobile-flex":{sizes:[[300,250],[320,50]],ids:["4856849","4856850"]},"mobile-banner":{sizes:[[320,50]],ids:["4856851"]},"mobile-mpu":{sizes:[[300,250]],ids:["4856852"]},"mobile-nav-ad-plus":{sizes:[[320,50]],ids:["4856854"]},"mobile-banner-plus-inc":{sizes:[[300,250],[320,50]],ids:["4856855","4856856"]},"mobile-incontent-ad-plus":{sizes:[[300,250],[320,50]],ids:["4856857","4856858"]},"mobile-banner-mpu":{sizes:[[300,250],[320,50]],ids:["4856859","4856860"]},"incontent-ad-plus":{sizes:[[728,90]],ids:["4856861"]},"mobile-skybox-nav":{sizes:[[320,50],[320,100]],ids:["5099303"]}}}}(e)),O.set("bidders.prebid.rubicon",function(e){return{enabled:!1,accountId:7450,slots:e?{video:{siteId:"462802",zoneId:"2742534"}}:{video:{siteId:"462804",zoneId:"2742536"}}}}(e)),O.set("bidders.prebid.rubicon_display",function(e){return{enabled:!1,accountId:7450,slots:e?{"incontent-ad":{sizes:[[728,90]],siteId:"462802",zoneId:"2719686"},leader_plus_top:{sizes:[[728,90],[970,250]],siteId:"462802",zoneId:"2719688"},leader_top:{sizes:[[728,90]],siteId:"462802",zoneId:"2719690"},mpu_top:{sizes:[[300,250]],siteId:"462802",zoneId:"2719692"},mpu_plus_top:{sizes:[[300,250],[300,600]],siteId:"462802",zoneId:"2719694"},mpu_bottom:{sizes:[[300,250]],siteId:"462802",zoneId:"2719696"},leader_bottom:{sizes:[[728,90]],siteId:"462802",zoneId:"2719698"},"nav-ad-plus":{sizes:[[728,90]],siteId:"462802",zoneId:"2719822"},"skybox-nav":{sizes:[[728,90],[970,250]],siteId:"462802",zoneId:"2843720"}}:{"mobile-native-top":{sizes:[[300,250],[320,50]],siteId:"462804",zoneId:"2719700"},"mobile-incontent-ad":{sizes:[[300,250],[320,50]],siteId:"462804",zoneId:"2719702"},"mobile-mpu-banner-bottom":{sizes:[[300,250],[320,50]],siteId:"462804",zoneId:"2719704"},"mobile-native-plus-top":{sizes:[[300,250],[320,50]],siteId:"462804",zoneId:"2719706"},"mobile-highimpact-plus":{sizes:[[300,250],[320,50]],siteId:"462804",zoneId:"2719780"},"incontent-mobile-flex":{sizes:[[300,250],[320,50]],siteId:"462804",zoneId:"2719782"},"mobile-banner":{sizes:[[320,50]],siteId:"462804",zoneId:"2719784"},"mobile-mpu":{sizes:[[300,250]],siteId:"462804",zoneId:"2719786"},"mobile-nav-ad-plus":{sizes:[[320,50]],siteId:"462804",zoneId:"2719788"},"mobile-banner-plus-inc":{sizes:[[300,250],[320,50]],siteId:"462804",zoneId:"2719790"},"mobile-incontent-ad-plus":{sizes:[[300,250],[320,50]],siteId:"462804",zoneId:"2719792"},"mobile-banner-mpu":{sizes:[[300,250],[320,50]],siteId:"462804",zoneId:"2719794"},"incontent-ad-plus":{sizes:[[728,90]],siteId:"462804",zoneId:"2719796"},"mobile-skybox-nav":{sizes:[[320,50],[320,100]],siteId:"462804",zoneId:"2843722"}}}}(e)),O.set("bidders.prebid.seedtag",function(e){return{enabled:!1,slots:e?{"incontent-ad":{sizes:[[728,90]],publisherId:"6674-0014-01",adUnitId:"29833082",placement:"inArticle"},leader_plus_top:{sizes:[[728,90],[970,250]],publisherId:"6674-0014-01",adUnitId:"29833092",placement:"inBanner"},leader_top:{sizes:[[728,90]],publisherId:"6674-0014-01",adUnitId:"29833092",placement:"inBanner"},mpu_top:{sizes:[[300,250]],publisherId:"6674-0014-01",adUnitId:"29833149",placement:"inArticle"},mpu_plus_top:{sizes:[[300,250],[300,600]],publisherId:"6674-0014-01",adUnitId:"29833149",placement:"inArticle"},mpu_bottom:{sizes:[[300,250]],publisherId:"6674-0014-01",adUnitId:"29833163",placement:"inArticle"},leader_bottom:{sizes:[[728,90]],publisherId:"6674-0014-01",adUnitId:"29833176",placement:"inBanner"},"nav-ad-plus":{sizes:[[728,90]],publisherId:"6674-0014-01",adUnitId:"29833187",placement:"inBanner"}}:{"mobile-native-top":{sizes:[[300,250],[320,50]],publisherId:"6674-0014-01",adUnitId:"29833092",placement:"inBanner"},"mobile-incontent-ad":{sizes:[[300,250],[320,50]],publisherId:"6674-0014-01",adUnitId:"29833082",placement:"inArticle"},"mobile-mpu-banner-bottom":{sizes:[[300,250],[320,50]],publisherId:"6674-0014-01",adUnitId:"29833163",placement:"inArticle"},"mobile-native-plus-top":{sizes:[[300,250],[320,50]],publisherId:"6674-0014-01",adUnitId:"29833092",placement:"inBanner"},"mobile-highimpact-plus":{sizes:[[300,250],[320,50]],publisherId:"6674-0014-01",adUnitId:"29833149",placement:"inArticle"},"incontent-mobile-flex":{sizes:[[300,250],[320,50]],publisherId:"6674-0014-01",adUnitId:"29833198",placement:"inArticle"},"mobile-banner":{sizes:[[320,50]],publisherId:"6674-0014-01",adUnitId:"29833176",placement:"inBanner"},"mobile-mpu":{sizes:[[300,250]],publisherId:"6674-0014-01",adUnitId:"29833203",placement:"inArticle"},"mobile-nav-ad-plus":{sizes:[[320,50]],publisherId:"6674-0014-01",adUnitId:"29833187",placement:"inBanner"},"mobile-banner-plus-inc":{sizes:[[300,250],[320,50]],publisherId:"6674-0014-01",adUnitId:"29833209",placement:"inArticle"},"mobile-incontent-ad-plus":{sizes:[[300,250],[320,50]],publisherId:"6674-0014-01",adUnitId:"29833216",placement:"inArticle"},"mobile-banner-mpu":{sizes:[[300,250],[320,50]],publisherId:"6674-0014-01",adUnitId:"29833221",placement:"inArticle"},"incontent-ad-plus":{sizes:[[728,90]],publisherId:"6674-0014-01",adUnitId:"29833226",placement:"inArticle"}}}}(e)),O.set("bidders.prebid.wikia",{enabled:!1,slots:{leader_top:{sizes:[[728,90]]},leader_plus_top:{sizes:[[728,90]]},mpu_top:{sizes:[[300,250]]},mpu_bottom:{sizes:[[300,250]]},leader_bottom:{sizes:[[728,90]]},"mobile-banner":{sizes:[[320,50]]},"mobile-incontent-ad-plus":{sizes:[[300,250],[320,50]]},"mobile-mpu-banner-bottom":{sizes:[[300,250],[320,50]]}}}),O.set("bidders.prebid.yahoossp",function(e){return{enabled:!1,slots:e?{"incontent-ad":{sizes:[[728,90]],pubId:["8a9691e7018585a630eba7e4182100d2"]},leader_plus_top:{sizes:[[728,90],[970,250]],pubId:["8a969450018585a63429a7e4191f00df","8a969dc9018585a62bdba7e41a0b00d2"]},leader_top:{sizes:[[728,90]],pubId:["8a9691e7018585a630eba7e41b0a00d3"]},mpu_top:{sizes:[[300,250]],pubId:["8a969450018585a63429a7e41c0800e0"]},mpu_plus_top:{sizes:[[300,250],[300,600]],pubId:["8a9691e7018585a630eba7e41d1800d4","8a969dc9018585a62bdba7e41e0700d3"]},mpu_bottom:{sizes:[[300,250]],pubId:["8a969450018585a63429a7e41ef000e1"]},leader_bottom:{sizes:[[728,90]],pubId:["8a9691e7018585a630eba7e41ffb00d5"]},"nav-ad-plus":{sizes:[[728,90]],pubId:["8a969dc9018585a62bdba7e4210700d4"]}}:{"mobile-native-top":{sizes:[[300,250],[320,50]],pubId:["8a969450018585a63429a7e42fb300e4","8a969dc9018585a62bdba7e4309700dd"]},"mobile-incontent-ad":{sizes:[[300,250],[320,50]],pubId:["8a969dc9018585a62bdba7e4318c00de","8a969dc9018585a62bdba7e4327f00df"]},"mobile-mpu-banner-bottom":{sizes:[[300,250],[320,50]],pubId:["8a969450018585a63429a7e4337c00e5","8a969dc9018585a62bdba7e4347000e0"]},"mobile-native-plus-top":{sizes:[[300,250],[320,50]],pubId:["8a969450018585a63429a7e4356100e6","8a969dc9018585a62bdba7e4365a00e1"]},"mobile-highimpact-plus":{sizes:[[300,250],[320,50]],pubId:["8a969450018585a63429a7e4375900e7","8a969dc9018585a62bdba7e4386600e2"]},"incontent-mobile-flex":{sizes:[[300,250],[320,50]],pubId:["8a969450018585a63429a7e4398200e8","8a969dc9018585a62bdba7e43a9e00e3"]},"mobile-banner":{sizes:[[320,50]],pubId:["8a9691e7018585a630eba7e43bed00d8"]},"mobile-mpu":{sizes:[[300,250]],pubId:["8a969450018585a63429a7e43d2800e9"]},"mobile-nav-ad-plus":{sizes:[[320,50]],pubId:["8a969450018585a63429a7e43e3e00ea"]},"mobile-banner-plus-inc":{sizes:[[300,250],[320,50]],pubId:["8a969450018585a63429a7e43f5700eb","8a969450018585a63429a7e4406c00ec"]},"mobile-incontent-ad-plus":{sizes:[[300,250],[320,50]],pubId:["8a969dc9018585a62bdba7e4418400e4","8a9691e7018585a630eba7e442b500d9"]},"mobile-banner-mpu":{sizes:[[300,250],[320,50]],pubId:["8a969450018585a63429a7e443d000ed","8a969dc9018585a62bdba7e444ea00e5"]},"incontent-ad-plus":{sizes:[[728,90]],pubId:["8a9691e7018585a630eba7e4462900da"]}}}}(e)),O.set("bidders.prebid.filter","static"),this.registerListeners()}registerListeners(){_i.on(mi,(({slot:e})=>{this.bidders.updateSlotTargeting(e.getSlotName())}),!1)}};oh=a([Rn(),l("design:paramtypes",["function"==typeof(rh=void 0!==Fl&&Fl)?rh:Object])],oh);let ah=class{getIncontentPlayerConfig(){const e="incontent_player";return{slotCreatorConfig:{slotName:e,anchorSelector:".msg_list .msg_body",insertMethod:"prepend"},activator:()=>{O.push("state.adStack",{id:e})}}}};var dh;ah=a([Rn()],ah);let lh=class{constructor(e){this.slotsDefinitionRepository=e}execute(){const e=this.slotsDefinitionRepository.getIncontentPlayerConfig();O.set("custom.hasIncontentPlayer",!!document.querySelector(e.slotCreatorConfig.anchorSelector)&&!O.get("state.isMobile")),Mc([e])}};lh=a([Rn(),l("design:paramtypes",["function"==typeof(dh=void 0!==ah&&ah)?dh:Object])],lh);let ch=class{execute(){const e={interstitial:{adProduct:"interstitial",adUnit:"/{custom.dfpId}/{slotConfig.group}/{slotConfig.adProduct}/{custom.device}{custom.region}-{custom.property}{custom.pagePath}",group:"IU",outOfPage:!0,outOfPageFormat:"INTERSTITIAL",targeting:{loc:"hivi"}},top_leaderboard:{firstCall:!0,adProduct:"top_leaderboard",group:"LB",sizes:[{viewportSize:[970,200],sizes:[[728,90],[970,250],Wc.UAP_ADDITIONAL_SIZES.bfaSize.desktop]},{viewportSize:[840,200],sizes:[[728,90],Wc.UAP_ADDITIONAL_SIZES.bfaSize.desktop]},{viewportSize:[320,200],sizes:[[320,50],[320,100],Wc.UAP_ADDITIONAL_SIZES.bfaSize.mobile]},{viewportSize:[0,0],sizes:[[320,50]]}],defaultSizes:[[728,90],[970,250]],defaultTemplates:["stickyTlb"],targeting:{loc:"top",pos_nr:"nav"},slotRefreshing:!0},floor_adhesion:{adProduct:"floor_adhesion",group:"PF",targeting:{loc:"footer"},defaultTemplates:["floorAdhesion"],defaultSizes:[[728,90]],sizes:[{viewportSize:[0,0],sizes:[[300,50],[320,50],[320,100]]},{viewportSize:[768,0],sizes:[[728,90]]}],slotRefreshing:!0},"native-top":{code:"native-top",defaultSizes:[[11,11]],targeting:{pos_nr:"top"},slotRefreshing:!0},"incontent-ad":{code:"incontent-ad",defaultSizes:[[728,90],[970,66],[5,5]],targeting:{pos_nr:"top"},slotRefreshing:!0},leader_plus_top:{code:"leader_plus_top",defaultSizes:[[728,90],[970,250],[970,66]],targeting:{pos_nr:"top"},slotRefreshing:!0},leader_top:{code:"leader_top",defaultSizes:[[728,90],[970,66]],targeting:{pos_nr:"top"},slotRefreshing:!0},mpu_top:{code:"mpu_top",defaultSizes:[[300,250]],targeting:{pos_nr:"top"},slotRefreshing:!0},mpu_plus_top:{code:"mpu_plus_top",defaultSizes:[[300,250],[300,600]],targeting:{pos_nr:"top"},slotRefreshing:!0},mpu_bottom:{code:"mpu_bottom",defaultSizes:[[300,250]],targeting:{pos_nr:"bottom"},slotRefreshing:!0},leader_bottom:{code:"leader_bottom",defaultSizes:[[728,90],[970,66]],targeting:{pos_nr:"bottom"},slotRefreshing:!0},"mobile-native-top":{code:"mobile-native-top",defaultSizes:[[300,250],[320,50],[11,11]],targeting:{pos_nr:"top"},slotRefreshing:!0},"mobile-incontent-ad":{code:"mobile-incontent-ad",defaultSizes:[[300,250],[320,50],[5,5]],targeting:{pos_nr:"incontent"},slotRefreshing:!0},"mobile-mpu-banner-bottom":{code:"mobile-mpu-banner-bottom",defaultSizes:[[300,250],[320,50]],targeting:{pos_nr:"bottom"},slotRefreshing:!0},"mobile-native-plus-top":{code:"mobile-native-plus-top",defaultSizes:[[300,250],[320,50],[11,11]],targeting:{pos_nr:"top"},slotRefreshing:!0},"mobile-highimpact-plus":{code:"mobile-highimpact-plus",defaultSizes:[[300,250],[320,50],[5,5]],targeting:{pos_nr:"plus"},slotRefreshing:!0},"incontent-mobile-flex":{code:"incontent-mobile-flex",defaultSizes:[[300,250],[320,50]],targeting:{pos_nr:"1"},slotRefreshing:!0},"mobile-banner":{code:"mobile-banner",defaultSizes:[[320,50]],targeting:{pos_nr:"1"},slotRefreshing:!0},"mobile-mpu":{code:"mobile-mpu",defaultSizes:[[300,250]],targeting:{pos_nr:"1"},slotRefreshing:!0},"nav-ad-plus":{code:"nav-ad-plus",defaultSizes:[[5,5],[970,66],[728,90]],targeting:{pos_nr:"nav"},slotRefreshing:!0},"mobile-nav-ad-plus":{code:"mobile-nav-ad-plus",defaultSizes:[[5,5],[320,50]],targeting:{pos_nr:"nav"},slotRefreshing:!0},"mobile-banner-plus-inc":{code:"mobile-banner-plus-inc",defaultSizes:[[300,250],[320,50]],targeting:{pos_nr:"inc"},slotRefreshing:!0},"mobile-incontent-ad-plus":{code:"mobile-incontent-ad-plus",defaultSizes:[[300,250],[320,50],[5,5]],targeting:{pos_nr:"inc"},slotRefreshing:!0},"mobile-banner-mpu":{code:"mobile-banner-mpu",defaultSizes:[[300,250],[320,50]],targeting:{pos_nr:"inc"},slotRefreshing:!0},"incontent-ad-plus":{code:"incontent-ad-plus",defaultSizes:[[970,66],[728,90],[5,5]],targeting:{pos_nr:"inc"},slotRefreshing:!0},"incontent-leader-middle":{code:"incontent-leader-middle",defaultSizes:[[970,66],[728,90]],targeting:{pos_nr:"inc"},slotRefreshing:!0},video:{isVideo:!0},incontent_player:{adProduct:"incontent_player",disabled:!0,isVideo:!0,group:"HiVi",defaultSizes:[[1,1]],targeting:{loc:"middle",pos:["outstream"]}}};O.set("slots",e)}};ch=a([Rn()],ch);class uh{execute(){const e={s0:"gaming",s1:"gamefaqs",skin:"gamefaqs_"+(O.get("state.isMobile")?"mobile":"desktop")};us.extend(e)}}const ph={SLOT:Symbol("template ad slot"),NAME:Symbol("template name"),PARAMS:Symbol("template params")};var hh;let gh=class{constructor(e){this.container=e}provideDependencies(e,t,i,n){this.container.bind(ph.NAME).value(e),this.container.bind(ph.SLOT).value(t),this.container.bind(ph.PARAMS).value(i),n.forEach((e=>this.container.bind(e)))}resetDependencies(e){this.container.unbind(ph.PARAMS),this.container.unbind(ph.SLOT),this.container.unbind(ph.NAME),e.forEach((e=>this.container.unbind(e)))}};gh=a([Rn(),l("design:paramtypes",["function"==typeof(hh=void 0!==jn&&jn)?hh:Object])],gh);class mh{get currentState(){if(!this.states.has(this.currentStateKey))throw new Error(`Template ${this.templateName} - state (${this.currentStateKey}) does not exist.`);return this.states.get(this.currentStateKey)}constructor(e,t,i,n){this.templateName=e,this.states=t,this.currentStateKey=i,this.emitter$=n,this.transition=e=>c(this,void 0,void 0,(function*(){if(this.currentStateKey===e)throw new Error(`Template ${this.templateName} - already is in ${this.currentStateKey} state`);this.emit("leaving"),yield this.currentState.leave(),this.emit("left"),this.currentStateKey=e,this.emit("entering"),yield this.currentState.enter(this.transition),this.emit("entered")}))}init(){return c(this,void 0,void 0,(function*(){this.emit("initialising"),yield this.currentState.enter(this.transition),this.emit("initialised")}))}destroy(){return c(this,void 0,void 0,(function*(){this.emit("destroying"),yield this.currentState.leave(),yield Promise.all(Array.from(this.states.values()).map((e=>e.destroy()))),this.emit("destroyed")}))}emit(e){this.emitter$.next({type:e,templateName:this.templateName,stateName:this.currentStateKey})}}class fh{constructor(e,t){this.name=e,this.handlers=t}enter(e){return c(this,void 0,void 0,(function*(){const t=vn(),i=this.useTransition(e,t);yield Promise.all(this.handlers.map((e=>c(this,void 0,void 0,(function*(){return e.onEnter(i)}))))),t.resolve(null)}))}leave(){return c(this,void 0,void 0,(function*(){yield Promise.all(this.handlers.filter((e=>"onLeave"in e)).map((e=>c(this,void 0,void 0,(function*(){return e.onLeave()})))))}))}destroy(){return c(this,void 0,void 0,(function*(){yield Promise.all(this.handlers.filter((e=>"onDestroy"in e)).map((e=>c(this,void 0,void 0,(function*(){return e.onDestroy()})))))}))}useTransition(e,t){let i=!1;return(n,...s)=>c(this,[n,...s],void 0,(function*(n,{allowMulticast:s=!1}={}){if(yield t,i&&!s)throw new Error(`Error thrown while attempting to transition to "${n}" state. Attempting to call transition from "${this.name}" state a second time.\nThis may be caused by:\n- not cleaning up in an "onLeave" method,\n- calling transition in a different handler at the same time.\nYou may suppress this error by setting allowMulticast to true.\n`);return i=!0,e(n,{allowMulticast:s})}))}}var vh,bh;let yh=class{constructor(e,t){this.container=e,this.dependenciesManager=t,this.settings=new Map,this.machines=new Map}has(e){return this.settings.has(e)}register(e,t,i,n=[]){const s=new zt;return this.settings.set(e,{StateHandlerTypesDict:t,initialStateKey:i,emitter$:s,templateDependencies:n.flat(1/0)}),s.asObservable()}destroy(e){return c(this,void 0,void 0,(function*(){const t=Array.from(this.machines.get(e)||[]);yield Promise.all(t.map((e=>e.destroy()))),this.machines.delete(e)}))}destroyAll(){return c(this,void 0,void 0,(function*(){yield Promise.all(Array.from(this.machines.values()).map((e=>Promise.all(Array.from(e.values()).map((e=>e.destroy())))))),this.machines.clear()}))}init(e,t,i={}){if(!this.settings.has(e))throw new Error(`Template ${e} was not registered`);_i.emit(Os,{name:e,state:t?t.getSlotName():""});const{StateHandlerTypesDict:n,initialStateKey:s,emitter$:r,templateDependencies:o}=this.settings.get(e);this.dependenciesManager.provideDependencies(e,t,i,o);const a=this.createTemplateStateMap(n);this.dependenciesManager.resetDependencies(o);const d=new mh(e,a,s,r);d.init(),this.saveMachine(t,d)}saveMachine(e,t){var i,n;const s=this.machines.get(null!==(i=null==e?void 0:e.getSlotName())&&void 0!==i?i:"__default__")||new Set;s.add(t),this.machines.set(null!==(n=null==e?void 0:e.getSlotName())&&void 0!==n?n:"__default__",s)}createTemplateStateMap(e){const t=Object.keys(e).map((t=>[t,this.createTemplateState(e,t)]));return new Map(t)}createTemplateState(e,t){const i=e[t].map((e=>this.createStateHandler(e)));return new fh(t,i)}createStateHandler(e){return this.container.bind(e).scope("Transient"),this.container.get(e)}};yh=a([Rn(),l("design:paramtypes",["function"==typeof(vh=void 0!==jn&&jn)?vh:Object,"function"==typeof(bh=void 0!==gh&&gh)?bh:Object])],yh);const Sh=new Date;function wh(){return`adEngine_resolvedStateCounter_${Wc.getUapId()}`}const _h=function(){Lp.setItem(wh(),{adId:Wc.getUapId(),lastSeenDate:Sh.getTime()},86400)},Eh=function(){const e=Lp.getItem(wh());return!!e&&Sh.getTime()!==e.lastSeenDate};let Th=!1;function Ih(){return y.get("resolved_state")}const Ah=function(e){let t=!1;if(function(e){return!(!e.image1||!e.image1.resolvedStateSrc)||"vuap"===e.adProduct}(e)){const e=!([!1,"blocked","false","0"].indexOf(Ih())>-1);let i=!0;e&&(i=Eh()||[!0,"true","1"].indexOf(Ih())>-1||Th),t=e&&i}return t},Ch=()=>{_h()};var Oh;let Ph=class{constructor(e,t){this.adSlot=e,this.params=t}onEnter(e){return c(this,void 0,void 0,(function*(){this.adSlot.setConfigProperty("showManually",!0),this.adSlot.addClass("expanded-slot"),this.adSlot.addClass("bfaa-template"),this.adSlot.addClass("slot-responsive"),this.adSlot.addClass("theme-hivi"),this.adSlot.getAdContainer().classList.add("iframe-container"),yield xs.onReady(this.adSlot),yield this.awaitVisibleDOM(),Ah(this.params)?e("sticky"):(Ch(),e("impact"))}))}awaitVisibleDOM(){return c(this,void 0,void 0,(function*(){document.hidden&&(yield gn(window,"visibilitychange"))}))}onLeave(){return c(this,void 0,void 0,(function*(){this.adSlot.show(),document.body.classList.add("has-uap")}))}onDestroy(){return c(this,void 0,void 0,(function*(){document.body.classList.remove("has-uap")}))}};Ph=a([Rn({autobind:!1}),d(0,Dn(ph.SLOT)),d(1,Dn(ph.PARAMS)),l("design:paramtypes",[Object,"function"==typeof(Oh=void 0!==i.UapParams&&i.UapParams)?Oh:Object])],Ph);class kh{static add(e,t){const i=document.createElement("div"),n=document.createElement("div");i.classList.add("progress-bar"),n.classList.add("current-time"),i.appendChild(n),i.pause=()=>{n.style.width=n.offsetWidth/i.offsetWidth*100+"%"},i.reset=()=>{n.style.transitionDuration="",n.style.width="0"},i.rewind=()=>{const e=n.style.transitionDuration;i.reset(),xs.forceRepaint(n),n.style.transitionDuration=e},i.start=()=>{const t=e.getRemainingTime();t?(t>0&&(n.style.transitionDuration=`${t}s`),xs.forceRepaint(n),n.style.width="100%"):n.style.width="0"},e.addEventListener("wikiaAdPlay",i.start),e.addEventListener("wikiaAdCompleted",i.reset),e.addEventListener("wikiaAdRestart",i.rewind),e.addEventListener("wikiaAdPause",i.pause),t.appendChild(i)}}class Nh{constructor(e,t){this.className=e,this.uiElements=t,this.panelContainer=null}add(e,t,i){this.panelContainer=document.createElement("div"),this.panelContainer.className=this.className,this.uiElements.forEach((t=>{t&&t.add(e,this.panelContainer,i)})),t.appendChild(this.panelContainer)}}class Lh{static add(e,t){const i=document.createElement("div"),n=Pr(kr.PAUSE,["play-off-icon","porvata-icon","porvata-off-icon"]),s=Pr(kr.PLAY,["play-on-icon","porvata-icon","porvata-on-icon"]);i.appendChild(s),i.appendChild(n),i.className="play-pause-button porvata-switchable-icon",i.addEventListener("click",(()=>{e.isPaused()?e.resume():e.pause()})),e.addEventListener("pause",(()=>{i.classList.remove("is-on")})),e.addEventListener("resume",(()=>{i.classList.add("is-on")})),e.addEventListener("start",(()=>{i.classList.add("is-on")})),t.appendChild(i)}}class Rh{static add(e,t){const i=document.createElement("div"),n=Pr(kr.FULLSCREEN_OFF,["fullscreen-off-icon","porvata-icon","porvata-off-icon"]),s=Pr(kr.FULLSCREEN_ON,["fullscreen-on-icon","porvata-icon","porvata-on-icon"]);i.appendChild(n),i.appendChild(s),i.className="toggle-fullscreen-button porvata-switchable-icon",i.addEventListener("click",(()=>{e.toggleFullscreen()})),e.addEventListener("wikiaFullscreenChange",(()=>{e.isFullscreen()?i.classList.add("is-on"):i.classList.remove("is-on")})),e.addEventListener("wikiaAdStop",(()=>{e.isFullscreen()&&e.toggleFullscreen()})),t.appendChild(i)}}function Dh(e,t){e.isMuted()?t.classList.add("is-on"):t.classList.remove("is-on")}class xh{static add(e,t){const i=function(){const e=document.createElement("div"),t=Pr(kr.HIVI_VOLUME_OFF,["volume-off-icon","porvata-icon","porvata-off-icon"]),i=Pr(kr.HIVI_VOLUME_ON,["volume-on-icon","porvata-icon","porvata-on-icon"]);return e.className="volume-button porvata-switchable-icon",e.appendChild(t),e.appendChild(i),e}();e.addEventListener("wikiaVolumeChange",(()=>{Dh(e,i)})),e.addEventListener("wikiaAdStarted",(()=>{Dh(e,i)})),i.addEventListener("click",(t=>{e.toggleVolume(),t.preventDefault()})),t.appendChild(i)}}class zh{static add(e,t,i){let n,s;const r=Wi.isSmartphone()||Wi.isTablet(),o=document.createElement("div"),a=t.querySelector(".dynamic-panel");function d(){s=window.setTimeout((()=>{o.classList.add("fading"),a.classList.add("fading")}),3e3),n=window.setTimeout((()=>{t.classList.remove("ui-visible")}),4e3)}function l(){clearTimeout(n),clearTimeout(s),o.classList.remove("fading"),a.classList.remove("fading")}o.classList.add("toggle-ui-overlay"),e.addEventListener("start",(()=>{t.classList.add("ui-visible"),l(),d()})),r?(o.addEventListener("click",(()=>{t.classList.toggle("ui-visible"),l(),e.isPlaying()&&d()})),e.addEventListener("resume",d),e.addEventListener("pause",l)):(t.addEventListener("mouseenter",(()=>{t.classList.add("ui-visible"),l()})),t.addEventListener("mouseleave",(()=>{d()})),o.addEventListener("click",(()=>{top.open(i.clickThroughURL,"_blank"),_i.emit(hd,{adSlotName:e.settings.getSlotName(),ad_status:"video-click"})}))),t.appendChild(o)}}class Vh{static add(e,t){e.addEventListener("wikiaAdStarted",(()=>{t.classList.remove(Ji.HIDDEN_AD_CLASS)})),e.addEventListener("wikiaAdCompleted",(()=>{t.classList.add(Ji.HIDDEN_AD_CLASS)}))}}class Mh{static add(e,t,i){e.addEventListener("wikiaAdStarted",(()=>{i.thumbnail.classList.add("hidden-state")})),e.addEventListener("wikiaAdCompleted",(()=>{i.thumbnail.classList.remove("hidden-state")}))}}function Uh(e){e.style.display="none";const t=e.offsetWidth;return e.style.display="",t}function jh(e,t){t.container.classList.contains("theme-hivi")||(e.style.width=e.style.width||function(e){const t=e.container.offsetWidth;return 100*e.hideWhenPlaying.offsetWidth/t+"%"}(t)),e.style.display="block"}class Bh{static add(e,t,i){const n=document.createElement("div");n.classList.add("player-overlay"),n.classList.add("replay-overlay"),n.addEventListener("click",(()=>{!function(e,t,i){e.play(),e.getPlayCounter()>1&&t.emit(i,{adSlotName:e.settings.getSlotName(),ad_status:"replay-click"})}(e,_i,pd)})),i.autoPlay||jh(n,i),e.addEventListener("wikiaAdCompleted",(()=>{jh(n,i),Uh(t)}));const s=function(e){const t=Pr(kr.REPLAY,["replay-icon","overlay-icon"]);return e.appendChild(t),t}(n);if(!i.autoPlay){const t=function(e){const t=Pr(kr.PLAY,["play-icon","overlay-icon"]);return e.appendChild(t),t}(n);s.style.display="none",e.addEventListener("start",(()=>{s.style.display="",t.style.display="none"}))}const r=e.params&&e.params.thumbnail?e.params.thumbnail:i.thumbnail;r.appendChild(n),Uh(r),Uh(t)}}class $h{static add(e,t,i){const n=document.createElement("div"),s=Pr(kr.LEARN_MORE,["learn-more-icon","porvata-icon"]),r=document.createElement("div");r.innerText=Xn("learn-more"),n.appendChild(r),n.appendChild(s),n.classList.add("learn-more"),n.addEventListener("click",(()=>{top.open(i.clickThroughURL,"_blank"),_i.emit(gd,{adSlotName:e.settings.getSlotName(),ad_status:"learn-more-click"})})),t.appendChild(n)}}var Fh=["addListener","removeListener"],Hh=["addEventListener","removeEventListener"],Gh=["on","off"];function qh(e,t,i,n){if(Ze(i)&&(n=i,i=void 0),n)return qh(e,t,i).pipe(Rt(n));var s=h(function(e){return Ze(e.addEventListener)&&Ze(e.removeEventListener)}(e)?Hh.map((function(n){return function(s){return e[n](t,s,i)}})):function(e){return Ze(e.addListener)&&Ze(e.removeListener)}(e)?Fh.map(Wh(e,t)):function(e){return Ze(e.on)&&Ze(e.off)}(e)?Gh.map(Wh(e,t)):[],2),r=s[0],o=s[1];if(!r&&Mt(e))return Qt((function(e){return qh(e,t,i)}))(Wt(e));if(!r)throw new TypeError("Invalid event target");return new It((function(e){var t=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return e.next(1<t.length?t:t[0])};return r(t),function(){return o(t)}}))}function Wh(e,t){return function(i){return function(n){return e[i](t,n)}}}function Kh(e){return Ot((function(t,i){Wt(e).subscribe(Pt(i,(function(){return i.complete()}),ct)),!i.closed&&t.subscribe(i)}))}var Yh=function(e){function t(t,i){return e.call(this)||this}return o(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(nt),Qh={setInterval:function(e,t){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];var s=Qh.delegate;return(null==s?void 0:s.setInterval)?s.setInterval.apply(s,g([e,t],h(i))):setInterval.apply(void 0,g([e,t],h(i)))},clearInterval:function(e){var t=Qh.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},Jh=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.scheduler=t,n.work=i,n.pending=!1,n}return o(t,e),t.prototype.schedule=function(e,t){var i;if(void 0===t&&(t=0),this.closed)return this;this.state=e;var n=this.id,s=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(s,n,t)),this.pending=!0,this.delay=t,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(s,this.id,t),this},t.prototype.requestAsyncId=function(e,t,i){return void 0===i&&(i=0),Qh.setInterval(e.flush.bind(e,this),i)},t.prototype.recycleAsyncId=function(e,t,i){if(void 0===i&&(i=0),null!=i&&this.delay===i&&!1===this.pending)return t;null!=t&&Qh.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var i,n=!1;try{this.work(e)}catch(e){n=!0,i=e||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),i},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,i=this.scheduler,n=i.actions;this.work=this.state=this.scheduler=null,this.pending=!1,it(n,this),null!=t&&(this.id=this.recycleAsyncId(i,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(Yh),Xh=function(){function e(t,i){void 0===i&&(i=e.now),this.schedulerActionCtor=t,this.now=i}return e.prototype.schedule=function(e,t,i){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(i,t)},e.now=di.now,e}(),Zh=function(e){function t(t,i){void 0===i&&(i=Xh.now);var n=e.call(this,t,i)||this;return n.actions=[],n._active=!1,n}return o(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}},t}(Xh),eg=new Zh(Jh),tg=eg;class ig{static createDisplayContainer(e,t=null){const i=new window.google.ima.AdDisplayContainer(e),n=e.querySelector("div > iframe");return t&&(_i.onSlotEvent(bs.DESTROY_EVENT,(()=>{ig.activeContainers.includes(t.getUid())&&(i.destroy(),ig.activeContainers=ig.activeContainers.filter((e=>e!==t.getUid())))}),t.getSlotName(),!0),ig.activeContainers.push(t.getUid())),ig.reloadIframeOnNavigation(n),i}static reloadIframeOnNavigation(e){window.performance&&window.performance.navigation&&window.performance.navigation.type===window.performance.navigation.TYPE_BACK_FORWARD&&(e.contentWindow.location.href=e.src)}static createAdsLoader(e,t){const i=new window.google.ima.AdsLoader(e);return i.getSettings().setVpaidMode(t.getVpaidMode()),i}static createAdsRequest(e){const t=new window.google.ima.AdsRequest,i=e.getWidth(),n=e.getHeight();return t.adTagUrl=e.getVastUrl()||eo(0,e.getSlotName(),{targeting:e.getVastTargeting()}),t.linearAdSlotWidth=i,t.linearAdSlotHeight=n,t.setAdWillAutoPlay(e.isAutoPlay()),t.setAdWillPlayMuted(e.isAutoPlay()),t}static getRenderingSettings(){const e=new window.google.ima.AdsRenderingSettings;return O.get("state.isMobile")||(e.bitrate=68e3),e.loadVideoTimeout=15e3,e.enablePreloading=!0,e.uiElements=[],e}}ig.activeContainers=[];class ng{constructor(e){this.fullscreen=!1,this.enter=vs(e,ng.enterEvents),this.exit=vs(e,ng.exitEvents)||vs(document,ng.exitEvents),this.fullscreenChangeEvent=(fs(e,ng.changeEvents)||"").replace(/^on/,"").replace("msfullscreenchange","MSFullscreenChange"),this.isSupported()&&this.addChangeListener((()=>{this.fullscreen=!this.fullscreen}))}addChangeListener(e){document.addEventListener(this.fullscreenChangeEvent,e)}removeChangeListener(e){document.removeEventListener(this.fullscreenChangeEvent,e)}toggle(){this.isSupported()&&(this.isFullscreen()?this.exit():this.enter())}isFullscreen(){return this.fullscreen}isSupported(){return Boolean(this.enter&&this.exit)}}ng.enterEvents=["webkitRequestFullscreen","webkitEnterFullscreen","mozRequestFullScreen","msRequestFullscreen","requestFullscreen"],ng.exitEvents=["webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen","exitFullscreen"],ng.changeEvents=["onwebkitfullscreenchange","onmozfullscreenchange","onmsfullscreenchange","onfullscreenchange"];class sg{constructor(e){var t;this.playerContainer=e,this.videoContainer=e.querySelector("div"),this.videoElement=this.videoContainer.querySelector("video"),this.interfaceContainer=document.createElement("div"),this.playerContainer.classList.add("porvata","porvata-container"),this.videoContainer.classList.add("video-player","porvata-player",Ji.HIDDEN_AD_CLASS),null===(t=this.videoElement)||void 0===t||t.classList.add("porvata-video"),this.interfaceContainer.classList.add("porvata-interface",Ji.HIDDEN_AD_CLASS),this.playerContainer.appendChild(this.interfaceContainer)}getInterfaceContainer(){return this.interfaceContainer}getPlayerContainer(){return this.playerContainer}getVideoContainer(){return this.videoContainer}getVideoElement(){return this.videoElement}setAttribute(e,t){this.playerContainer.setAttribute(e,t)}setVastAttributes(e,t,i){const n=Du.getVastAttributes(e,t,i);Object.keys(n).forEach((e=>this.setAttribute(e,n[e])))}setAutoPlayOnVideoElement(e){this.videoElement&&(this.videoElement.autoplay=e,this.videoElement.muted=e)}setAudioOnVideoElement(e){this.videoElement&&(this.videoElement.muted=0===e,this.videoElement.volume=e)}}const rg="video-player-fullscreen",og="stop-scrolling";class ag{constructor(e,t,i,n){this.adDisplayContainer=e,this.adsLoader=t,this.adsRequest=i,this.settings=n,this.state=null,this.adsManager=null,this.eventListeners={},this.destroyCallbacks=new ss;const s=n.getPlayerContainer();this.playCounter=0,this.dom=new sg(s),this.container=s;const r=s.querySelector("video");this.nativeFullscreen=new ng(r),this.registerStateListeners(),this.settings.isAutoPlay()&&(this.setAutoPlay(!0),this.updatePlayCounter()),this.destroyCallbacks.onItemFlush((e=>e())),this.nativeFullscreen.isSupported()&&this.nativeFullscreen.addChangeListener((()=>this.onFullscreenChange()))}registerStateListeners(){this.addEventListener(window.google.ima.AdEvent.Type.LOADED,(e=>this.setAdStatus(zs.STATUS_SUCCESS,e.getAd()))),this.addEventListener(window.google.ima.AdErrorEvent.Type.AD_ERROR,(()=>this.setAdStatus(zs.STATUS_ERROR))),this.addEventListener("resume",(()=>this.setState("playing"))),this.addEventListener("start",(()=>this.setState("playing"))),this.addEventListener("pause",(()=>this.setState("paused"))),this.addEventListener("wikiaAdStop",(()=>this.setState("stopped"))),this.addEventListener("allAdsCompleted",(()=>this.setState("stopped"))),this.addEventListener("adCanPlay",(()=>this.dom.getInterfaceContainer().classList.remove(Ji.HIDDEN_AD_CLASS))),this.addEventListener("wikiaAdCompleted",(()=>this.dom.getInterfaceContainer().classList.add(Ji.HIDDEN_AD_CLASS)))}getAdsManager(){return this.adsManager}setAdsManager(e){this.adsManager=e}addEventListener(e,t){if(-1!==e.indexOf("wikia"))return this.eventListeners[e]=this.eventListeners[e]||[],void this.eventListeners[e].push(t);null!==this.adsManager?this.adsManager.addEventListener(e,t):this.addEventListener("wikiaAdsManagerLoaded",(()=>this.adsManager.addEventListener(e,t)))}removeEventListener(e,t){}dispatchEvent(e){this.eventListeners[e]&&this.eventListeners[e].length>0&&this.eventListeners[e].forEach((e=>{e({})}))}setAutoPlay(e){this.dom.setAutoPlayOnVideoElement(e),this.settings.setAutoPlay(e)}setAdStatus(e,t){this.dom.setVastAttributes(this.adsRequest.adTagUrl,e,t)}requestAds(){this.adsLoader.requestAds(this.adsRequest)}play(e,t){void 0!==e&&void 0!==t&&(this.settings.setHeight(t),this.settings.setWidth(e)),this.settings.getWidth()&&this.settings.getHeight()&&!this.isFullscreen()||(this.settings.setHeight(this.dom.getPlayerContainer().offsetHeight),this.settings.setWidth(this.dom.getPlayerContainer().offsetWidth)),this.dispatchEvent("wikiaAdPlayTriggered"),this.adDisplayContainer.initialize(),this.adsManager.init(Math.round(this.settings.getWidth()),Math.round(this.settings.getHeight()),window.google.ima.ViewMode.NORMAL),this.adsManager.start(),this.updatePlayCounter()}reload(){const e=ig.createAdsRequest(this.settings);this.adsManager.destroy(),this.adsLoader.contentComplete(),this.adsLoader.requestAds(e)}resize(e,t){const i=window.google.ima.ViewMode;isFinite(e)&&isFinite(t)&&(this.settings.setHeight(t),this.settings.setWidth(e)),this.adsManager&&(this.isFullscreen()?this.adsManager.resize(window.innerWidth,window.innerHeight,i.FULLSCREEN):this.adsManager.resize(Math.round(this.settings.getWidth()),Math.round(this.settings.getHeight()),i.NORMAL))}getRemainingTime(){return this.adsManager.getRemainingTime()}setState(e){this.state=e}getState(){return this.state}getPlayCounter(){return this.playCounter}updatePlayCounter(){this.playCounter++}isPaused(){return"paused"===this.getState()}isPlaying(){return"playing"===this.getState()}resume(){this.adsManager.resume()}pause(){this.adsManager.pause()}stop(){this.adsManager.stop(),this.dispatchEvent("wikiaAdStop")}toggleVolume(){this.isMuted()?(this.unmute(),this.dispatchEvent("wikiaAdUnmute")):(this.mute(),this.dispatchEvent("wikiaAdMute"))}isMuted(){return 0===this.adsManager.getVolume()}mute(){this.setVolume(0)}unmute(){this.setVolume(.75)}setVolume(e){this.dom.setAudioOnVideoElement(e),this.adsManager.setVolume(e),this.dispatchEvent("wikiaVolumeChange")}toggleFullscreen(){this.fullscreenMuteProtect=!0,this.nativeFullscreen.isSupported()?this.nativeFullscreen.toggle():this.onFullscreenChange()}onFullscreenChange(){this.isFullscreen()?(this.dom.getPlayerContainer().classList.add(rg),document.documentElement.classList.add(og)):(this.dom.getPlayerContainer().classList.remove(rg),document.documentElement.classList.remove(og),this.fullscreenMuteProtect?this.fullscreenMuteProtect=!1:this.isPlaying()&&!this.isMuted()&&this.mute()),this.resize(),this.dispatchEvent("wikiaFullscreenChange")}isFullscreen(){return this.nativeFullscreen.isFullscreen()}addOnDestroyCallback(e){this.destroyCallbacks.push(e)}destroy(){this.destroyCallbacks.flush()}}class dg{static create(e){return c(this,void 0,void 0,(function*(){_i.emit(Ei.PARTNER_LOAD_STATUS,{status:"porvata_start"}),e.getPlayerContainer().style.opacity="0",yield dg.load();const t=e.getSlotName(),i=Qr.get(t);!function(e,t){e.setConfigProperty("autoplay",t.isAutoPlay()),e.setConfigProperty("audio",!t.isAutoPlay()),e.setTargetingConfigProperty("autoplay",t.isAutoPlay()?"yes":"no"),e.setTargetingConfigProperty("audio",t.isAutoPlay()?"no":"yes")}(i,e);const n=ig.createDisplayContainer(e.getPlayerContainer(),i),s=ig.createAdsLoader(n,e),r=ig.createAdsRequest(e),o=function(e){return[lu].filter((t=>t.isEnabled(e)))}(e),a=new ag(n,s,r,e);return o.forEach((e=>e.load())),this.registerAdsLoaderListeners(s,a,e,o),_i.emit(Ei.PARTNER_LOAD_STATUS,{status:"porvata_ready"}),yield a.requestAds(),_i.emit(Ei.PARTNER_LOAD_STATUS,{status:"porvata_done"}),a}))}static load(){return c(this,void 0,void 0,(function*(){return dg.loadSdkPromise||(dg.loadSdkPromise=window.google&&window.google.ima?new Promise((e=>e())):ls.loadScript("//imasdk.googleapis.com/js/sdkloader/ima3.js")),dg.loadSdkPromise}))}static registerAdsLoaderListeners(e,t,i,n){e.addEventListener(window.google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,(e=>{const s=ig.getRenderingSettings(),r=e.getAdsManager(function(){const e=document.createElement("video");return e.setAttribute("preload","none"),e}(),s);t.setAdsManager(r),Promise.all(n.map((e=>e.init(t,i)))).then((()=>{t.dispatchEvent("wikiaAdsManagerLoaded"),i.getPlayerContainer().style.opacity="1"}))}),!1),e.addEventListener(window.google.ima.AdErrorEvent.Type.AD_ERROR,(e=>{const i=window.google.ima.AdError.ErrorCode.VAST_EMPTY_RESPONSE;"function"==typeof e.getError&&e.getError().getErrorCode()===i&&t.dispatchEvent("wikiaEmptyAd"),t.setAdStatus(zs.STATUS_ERROR)}))}}class lg{constructor(e){this.params=e,this.lastKnownAdData={contentType:"",creativeId:"",lineItemId:""},this.logger=(...e)=>Wn(lg.LOG_GROUP,...e),this.listeners=(O.get("listeners.porvata")||[]).filter((e=>!e.isEnabled||e.isEnabled()))}init(){this.dispatch("init")}registerVideoEvents(e){this.video=e,this.dispatch("ready"),Object.keys(lg.EVENTS).forEach((t=>{e.addEventListener(t,(e=>{let i,n;e.getError&&(i=e.getError().getErrorCode()),e.getAd&&(n=e.getAd()),this.dispatch(lg.EVENTS[t],i,n)}))}))}dispatch(e,t=0,i){const n=this.getVideoData(e,t,i);this.logger(e,n),this.listeners.forEach((t=>{t.onEvent(e,this.params,n)})),this.params.position&&e===lg.EVENTS.viewable_impression?Qr.get(this.params.position).emit(bs.VIDEO_VIEWED_EVENT):this.params.position&&e===lg.EVENTS.wikiaXClick&&Qr.get(this.params.position).emit(lg.EVENTS.wikiaXClick)}getVideoData(e,t,i){let n,s,r;if(i){const e=pu.getAdInfo(i);n=e.contentType,s=e.creativeId,r=e.lineItemId}else this.video&&this.video.container&&(n=this.video.container.getAttribute("data-vast-content-type"),s=this.video.container.getAttribute("data-vast-creative-id"),r=this.video.container.getAttribute("data-vast-line-item-id"));return this.lastKnownAdData.contentType=n||this.lastKnownAdData.contentType,this.lastKnownAdData.creativeId=s||this.lastKnownAdData.creativeId,this.lastKnownAdData.lineItemId=r||this.lastKnownAdData.lineItemId,{ad_error_code:t,ad_product:this.params.adProduct,audio:this.params.withAudio?1:0,content_type:this.lastKnownAdData.contentType||"(none)",creative_id:this.lastKnownAdData.creativeId||"",ctp:this.params.withCtp?1:0,event_name:e,line_item_id:this.lastKnownAdData.lineItemId||"",player:lg.PLAYER_NAME,position:this.params.position?this.params.position.toLowerCase():"(none)"}}}var cg,ug;lg.EVENTS={adCanPlay:"ad_can_play",complete:"completed",click:"clicked",firstquartile:"first_quartile",impression:"impression",loaded:"loaded",midpoint:"midpoint",pause:"paused",resume:"resumed",start:"started",thirdquartile:"third_quartile",viewable_impression:"viewable_impression",adError:"error",wikiaAdPlayTriggered:"play_triggered",wikiaAdStop:"closed",wikiaAdMute:"mute",wikiaAdUnmute:"unmute",wikiaXClick:"force_close",wikiaInViewportWithOffer:"in_viewport_with_offer",wikiaInViewportWithoutOffer:"in_viewport_without_offer",wikiaFullscreenChange:"fullscreen_change"},lg.LOG_GROUP="porvata-listener",lg.PLAYER_NAME="porvata",function(e){e[e.DISABLED=0]="DISABLED",e[e.ENABLED=1]="ENABLED",e[e.INSECURE=2]="INSECURE"}(cg||(cg={}));class pg{constructor(e){this.params=e,this.adProduct=e.adProduct,this.autoPlay=!!e.autoPlay,this.height=e.height,this.iasTracking=function(e){return"boolean"==typeof e.iasTracking?e.iasTracking:!!O.get("options.video.iasTracking.enabled")}(e),this.playerContainer=e.container,this.slotName=e.slotName,this.src=e.src,this.width=e.width,this.vastUrl=e.vastUrl,this.vastTargeting=e.vastTargeting,this.vpaidMode=e.vpaidMode||cg.ENABLED}getAdProduct(){return this.adProduct}getParams(){return this.params}getPlayerContainer(){return this.playerContainer}getSlotName(){return this.slotName}getSrc(){return this.src}getVpaidMode(){return this.vpaidMode}getHeight(){return this.height}setHeight(e){this.height=e}getWidth(){return this.width}setWidth(e){this.width=e}isIasTrackingEnabled(){return this.iasTracking}isAutoPlay(){return this.autoPlay}setAutoPlay(e){this.autoPlay=e}getVastTargeting(){return this.vastTargeting}getVastUrl(){return this.vastUrl}}class hg{static addOnViewportChangeListener(e,t){return co.addListener(e.viewportHookElement||e.container,t,{offsetTop:e.viewportOffsetTop||0,offsetBottom:e.viewportOffsetBottom||0})}static createVideoContainer(e){const t=document.createElement("div"),i=document.createElement("div");return t.classList.add("video-overlay"),i.classList.add("video-display-wrapper"),t.appendChild(i),e.appendChild(t),i}static inject(e){const t=new lg({adProduct:e.adProduct,position:e.slotName,src:e.src,withAudio:!e.autoPlay,withCtp:!e.autoPlay});let i=!0,n=!1,s=null;e.vastTargeting=e.vastTargeting||{};const r=new pg(e);return t.init(),dg.create(r).then((r=>{function o(t){t&&!n&&e.autoPlay&&(r.dispatchEvent("wikiaFirstTimeInViewport"),r.play(),n=!0)}function a(){e.startInViewportOnly||!e.autoPlay||n?s=hg.addOnViewportChangeListener(e,o):(n=!0,r.play())}var d;return t.registerVideoEvents(r),r.addEventListener("adCanPlay",(()=>{var t;r.dispatchEvent("wikiaAdStarted"),null===(t=Qr.get(e.slotName))||void 0===t||t.emit(bs.VIDEO_AD_IMPRESSION)})),r.addEventListener("allAdsCompleted",(()=>{r.isFullscreen()&&r.toggleFullscreen(),r.setAutoPlay(!1),r.dispatchEvent("wikiaAdCompleted"),s&&(co.removeListener(s),s=null),i=!1,t.params.withAudio=!0,t.params.withCtp=!0})),r.addEventListener("wikiaAdRestart",(()=>{i=!1})),r.addEventListener("start",(()=>{r.dispatchEvent("wikiaAdPlay"),s||n||a()})),r.addEventListener("resume",(()=>{r.dispatchEvent("wikiaAdPlay")})),r.addEventListener("pause",(()=>{r.dispatchEvent("wikiaAdPause")})),r.addOnDestroyCallback((()=>{s&&(co.removeListener(s),s=null)})),e.autoPlay&&(d=r).addEventListener("wikiaAdsManagerLoaded",(()=>{i&&d.mute()})),e.onReady&&e.onReady(r),r.addEventListener("wikiaAdsManagerLoaded",(()=>{a()})),r.addEventListener("wikiaEmptyAd",(()=>{s=hg.addOnViewportChangeListener(e,(()=>{r.dispatchEvent("wikiaFirstTimeInViewport"),co.removeListener(s)}))})),r}))}}let gg=class{constructor(e,t){this.adSlot=e,this.params=t,this.state$=new li(1),this.video$=this.state$.asObservable()}register(){const e=this.getPlayerParams();this.setCtpTargeting(e.autoPlay),hg.inject(e).then((t=>this.state$.next({player:t,params:e})))}getPlayerParams(){return Object.assign(Object.assign({},this.params),{vastTargeting:{},autoPlay:this.isAutoPlayEnabled(),container:this.createPlayerContainer(),hideWhenPlaying:this.params.thumbnail})}createPlayerContainer(){const e=hg.createVideoContainer(this.adSlot.getElement());return e.parentElement.classList.add(Ji.HIDDEN_AD_CLASS),e}isAutoPlayEnabled(){const e=!Ah(this.params),t=this.params.autoPlay&&!e,i=this.params.autoPlay&&e;return Boolean(t||i)}setCtpTargeting(e){const t=e?"":"-audio",i=e?"":"-ctp";this.adSlot.setConfigProperty("slotNameSuffix",i||t||""),this.adSlot.setTargetingConfigProperty("audio",t?"yes":"no"),this.adSlot.setTargetingConfigProperty("ctp",i?"yes":"no")}discard(){this.state$.complete()}};var mg,fg,vg;gg=a([Rn({autobind:!1}),d(0,Dn(ph.SLOT)),d(1,Dn(ph.PARAMS)),l("design:paramtypes",[Object,"function"==typeof(ug=void 0!==i.UapParams&&i.UapParams)?ug:Object])],gg);let bg=mg=class{constructor(e,t,i){this.adSlot=e,this.params=t,this.playerRegistry=i,this.destroy$=new zt}onEnter(){return c(this,void 0,void 0,(function*(){if(!Wc.isVideoEnabled(this.params))return this.playerRegistry.discard();zc.setupSlotVideoAdUnit(this.adSlot,this.params),this.playerRegistry.register(),this.playerRegistry.video$.pipe(hi(1),cr((({player:e,params:t})=>this.adjustUI(e,t))),Qt((({player:e})=>this.handleEvents(e))),Kh(this.destroy$)).subscribe()}))}handleEvents(e){return ai(qh(e,"adCanPlay").pipe(cr((()=>e.dom.getVideoContainer().classList.remove(Ji.HIDDEN_AD_CLASS)))),qh(e,"wikiaAdStarted").pipe(Qt((()=>qh(e,"wikiaAdCompleted"))),(t=mg.DEBOUNCE_TIME,void 0===i&&(i=eg),Ot((function(e,n){var s=null,r=null,o=null,a=function(){if(s){s.unsubscribe(),s=null;var e=r;r=null,n.next(e)}};function d(){var e=o+t,r=i.now();if(r<e)return s=this.schedule(void 0,e-r),void n.add(s);a()}e.subscribe(Pt(n,(function(e){r=e,o=i.now(),s||(s=i.schedule(d,t),n.add(s))}),(function(){a(),n.complete()}),void 0,(function(){r=s=null})))}))),cr((()=>e.reload()))),_i.action$.pipe(Si(_i.getGlobalAction(fi)),pi((e=>{var t;return e.event===bs.CUSTOM_EVENT&&e.adSlotName===this.adSlot.getSlotName()&&(null===(t=e.payload)||void 0===t?void 0:t.status)===Wc.SLOT_FORCE_UNSTICK})),cr((()=>e.stop()))));var t,i}adjustUI(e,t){kh.add(e,e.dom.getInterfaceContainer()),new Nh("bottom-panel dynamic-panel",[Lh,xh,Rh]).add(e,e.dom.getInterfaceContainer(),t),zh.add(e,e.dom.getInterfaceContainer(),t),Vh.add(e,t.container.parentElement),Mh.add(e,void 0,t),Bh.add(e,e.dom.getPlayerContainer(),t),$h.add(e,e.dom.getPlayerContainer(),t)}onDestroy(){return c(this,void 0,void 0,(function*(){this.destroy$.next(),this.destroy$.complete(),this.playerRegistry.discard()}))}};function yg(e,t){return Ot((function(i,n){var s=null,r=0,o=!1,a=function(){return o&&!s&&n.complete()};i.subscribe(Pt(n,(function(i){null==s||s.unsubscribe();var o=0,d=r++;Wt(e(i,d)).subscribe(s=Pt(n,(function(e){return n.next(t?t(i,e,d,o++):e)}),(function(){s=null,a()})))}),(function(){o=!0,a()})))}))}var Sg;bg.DEBOUNCE_TIME=10,bg=mg=a([Rn({autobind:!1}),d(0,Dn(ph.SLOT)),d(1,Dn(ph.PARAMS)),l("design:paramtypes",[Object,"function"==typeof(fg=void 0!==i.UapParams&&i.UapParams)?fg:Object,"function"==typeof(vg=void 0!==gg&&gg)?vg:Object])],bg);let wg=class{constructor(e){this.playerRegistry=e,this.destroy$=new zt}onEnter(e){return c(this,void 0,void 0,(function*(){this.playerRegistry.video$.pipe(hi(1),pi((({params:e})=>!e.autoPlay)),yg((({player:e})=>qh(e,"wikiaAdStarted").pipe(hi(1)))),cr((()=>e("impact",{allowMulticast:!0}))),Kh(this.destroy$)).subscribe()}))}onDestroy(){return c(this,void 0,void 0,(function*(){this.destroy$.next(),this.destroy$.complete()}))}};var _g;wg=a([Rn({autobind:!1}),l("design:paramtypes",["function"==typeof(Sg=void 0!==gg&&gg)?Sg:Object])],wg);let Eg=class{constructor(e){this.playerRegistry=e,this.destroy$=new zt}onEnter(e){return c(this,void 0,void 0,(function*(){this.playerRegistry.video$.pipe(hi(1),yg((({player:e})=>qh(e,"wikiaAdStarted").pipe(gi(1)))),cr((()=>e("impact",{allowMulticast:!0}))),Kh(this.destroy$)).subscribe()}))}onDestroy(){return c(this,void 0,void 0,(function*(){this.destroy$.next(),this.destroy$.complete()}))}};Eg=a([Rn({autobind:!1}),l("design:paramtypes",["function"==typeof(_g=void 0!==gg&&gg)?_g:Object])],Eg);let Tg=class{constructor(e){this.adSlot=e}onEnter(){return c(this,void 0,void 0,(function*(){const e=this.adSlot.getElement();if(!e)return;const t=e.querySelector(".advertisement-label");if(!xr.isEnabled()&&t)return;Dr.clearPlaceholderLabels(this.adSlot);const i=new Dr({slot:this.adSlot.getSlotName()});e.appendChild(i.render())}))}};Tg=a([Rn({autobind:!1}),d(0,Dn(ph.SLOT)),l("design:paramtypes",[Object])],Tg);let Ig=class{constructor(e){this.name=e}onEnter(e){return c(this,void 0,void 0,(function*(){window.ads.transitions=window.ads.transitions||{},window.ads.transitions[this.name]=t=>e(t,{allowMulticast:!0})}))}onDestroy(){return c(this,void 0,void 0,(function*(){delete window.ads.transitions[this.name]}))}};Ig=a([Rn({autobind:!1}),d(0,Dn(ph.NAME)),l("design:paramtypes",[String])],Ig);var Ag={schedule:function(e){var t=requestAnimationFrame,i=cancelAnimationFrame,n=Ag.delegate;n&&(t=n.requestAnimationFrame,i=n.cancelAnimationFrame);var s=t((function(t){i=void 0,e(t)}));return new nt((function(){return null==i?void 0:i(s)}))},requestAnimationFrame:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=Ag.delegate;return((null==i?void 0:i.requestAnimationFrame)||requestAnimationFrame).apply(void 0,g([],h(e)))},cancelAnimationFrame:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=Ag.delegate;return((null==i?void 0:i.cancelAnimationFrame)||cancelAnimationFrame).apply(void 0,g([],h(e)))},delegate:void 0},Cg=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.scheduler=t,n.work=i,n}return o(t,e),t.prototype.requestAsyncId=function(t,i,n){return void 0===n&&(n=0),null!==n&&n>0?e.prototype.requestAsyncId.call(this,t,i,n):(t.actions.push(this),t._scheduled||(t._scheduled=Ag.requestAnimationFrame((function(){return t.flush(void 0)}))))},t.prototype.recycleAsyncId=function(t,i,n){var s;if(void 0===n&&(n=0),null!=n?n>0:this.delay>0)return e.prototype.recycleAsyncId.call(this,t,i,n);var r=t.actions;null!=i&&(null===(s=r[r.length-1])||void 0===s?void 0:s.id)!==i&&(Ag.cancelAnimationFrame(i),t._scheduled=void 0)},t}(Jh),Og=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.flush=function(e){this._active=!0;var t=this._scheduled;this._scheduled=void 0;var i,n=this.actions;e=e||n.shift();do{if(i=e.execute(e.state,e.delay))break}while((e=n[0])&&e.id===t&&n.shift());if(this._active=!1,i){for(;(e=n[0])&&e.id===t&&n.shift();)e.unsubscribe();throw i}},t}(Zh))(Cg);let Pg=class{constructor(){this.scroll$=this.createSource(document,"scroll"),this.resize$=this.createSource(window,"resize")}createSource(e,t){return qh(e,t).pipe(ni(Og),Cu(),Eu())}};Pg=a([Rn()],Pg);const kg=Symbol("navbar"),Ng=Symbol("page"),Lg=Symbol("footer");var Rg;let Dg=class{constructor(e){this.element=e,this.stylesBackup={}}setProperty(e,t){return this.saveProperty(e),this.element.style[e]=t,this}saveProperty(e){void 0===this.stylesBackup[e]&&(this.stylesBackup[e]=this.element.style[e])}addClass(...e){return this.saveClasses(),this.element.classList.add(...e),this}removeClass(...e){return this.saveClasses(),this.element.classList.remove(...e),this}saveClasses(){this.classesBackup||(this.classesBackup=this.element.classList.value)}restore(){for(const[e,t]of Object.entries(this.stylesBackup))this.element.style[e]=t;this.classesBackup&&(this.element.classList.value=this.classesBackup),this.stylesBackup={},this.classesBackup=void 0}};Dg=a([Rn({autobind:!1}),l("design:paramtypes",["function"==typeof(Rg="undefined"!=typeof HTMLElement&&HTMLElement)?Rg:Object])],Dg);let xg=class{constructor(){this.elements=new Map}element(e){return this.elements.has(e)||this.elements.set(e,new Dg(e)),this.elements.get(e)}restore(){this.elements.forEach((e=>e.restore())),this.elements.clear()}};var zg,Vg;xg=a([Rn({autobind:!1})],xg);let Mg=class{constructor(e,t,i){this.params=e,this.adSlot=t,this.navbar=i}getPageOffsetImpact(){return this.getSlotHeightImpact()+(O.get("templates.ignoreNavbarHeight")?0:this.navbar.offsetHeight)}getPageOffsetResolved(){return this.getSlotHeightResolved()+(O.get("templates.ignoreNavbarHeight")?0:this.navbar.offsetHeight)}getNavbarOffsetImpactToResolved(){return this.getSlotHeightImpactToResolved()}getNavbarOffsetResolvedToNone(){const e=this.getNavbarOffsetResolved()-window.scrollY;return e<=0?0:e}getNavbarOffsetResolved(){return this.getSlotHeightResolved()}getSlotOffsetResolvedToNone(){return this.getNavbarOffsetResolvedToNone()-this.getSlotHeightResolved()}getSlotHeightImpactToResolved(){const e=this.getSlotHeightResolved(),t=this.getSlotHeightImpact();return t-(t-e)*this.getProgressImpactToResolved()}getProgressImpactToResolved(){const e=this.getSlotHeightResolved(),t=this.getSlotHeightImpact(),i=window.scrollY/(t-e);return i>=1?1:i}getSlotHeightImpact(){var e,t,i;return void 0===(null===(i=null===(t=null===(e=this.params)||void 0===e?void 0:e.config)||void 0===t?void 0:t.aspectRatio)||void 0===i?void 0:i.default)?this.adSlot.getElement().offsetHeight:this.calculateSlotHeight(this.params.config.aspectRatio.default)}getSlotHeightResolved(){var e,t,i;return void 0===(null===(i=null===(t=null===(e=this.params)||void 0===e?void 0:e.config)||void 0===t?void 0:t.aspectRatio)||void 0===i?void 0:i.resolved)?this.adSlot.getElement().offsetHeight:this.calculateSlotHeight(this.params.config.aspectRatio.resolved)}calculateSlotHeight(e){return 1/e*this.adSlot.getElement().offsetWidth}getSlotHeightClipping(){const e=window.scrollY;return!e||e<=0?"unset":e>=this.adSlot.getElement().offsetHeight?"rect(0, 0, 0, 0)":`rect(0 ${this.adSlot.getElement().offsetWidth}px ${this.adSlot.getElement().offsetHeight-e}px 0)`}};var Ug,jg,Bg,$g,Fg;Mg=a([Rn({autobind:!1}),d(0,Dn(ph.PARAMS)),d(1,Dn(ph.SLOT)),d(2,Dn(kg)),l("design:paramtypes",["function"==typeof(zg=void 0!==i.UapParams&&i.UapParams)?zg:Object,Object,"function"==typeof(Vg="undefined"!=typeof HTMLElement&&HTMLElement)?Vg:Object])],Mg);let Hg=Ug=class{constructor(e,t,i,n,s){this.params=e,this.adSlot=t,this.page=i,this.manipulator=n,this.reader=s}addClassToPage(e){this.manipulator.element(this.page).addClass(e)}setPageOffsetImpact(){this.setPageOffset(this.reader.getPageOffsetImpact())}setPageOffset(e){this.manipulator.element(this.page).setProperty("marginTop",`${e}px`)}setSlotOffsetResolvedToNone(){this.setSlotOffset(this.reader.getSlotOffsetResolvedToNone())}setSlotOffset(e){this.manipulator.element(this.adSlot.getElement()).setProperty("top",`${e}px`)}setSlotHeightImpactToResolved(){this.setSlotHeight(`${this.reader.getSlotHeightImpactToResolved()}px`)}setSlotHeightResolved(){this.setSlotHeight(`${this.reader.getSlotHeightResolved()}px`)}setSlotHeightImpact(){this.setSlotHeight(`${this.reader.getSlotHeightImpact()}px`)}addTransitionProperty(){const e=document.querySelector(".top-ads-container");if(!e)return;const t=`height 300ms ${Wc.CSS_TIMING_EASE_IN_CUBIC}`;this.manipulator.element(this.adSlot.getElement()).setProperty("transition",t),this.manipulator.element(e).setProperty("transition",t)}setSlotHeight(e){this.addTransitionProperty(),this.manipulator.element(this.adSlot.getElement()).setProperty("height",e)}setSlotHeightClipping(){this.manipulator.element(this.adSlot.getElement()).setProperty("clip",this.reader.getSlotHeightClipping())}resizePlaceholderToIframe(e){const t=O.get("slotConfig.slotRefresher.sizes")||{};if(this.adSlot.getSlotName()in t){const e=this.adSlot.getIframe(),t=`${Number(e.height)+Ug.PLACEHOLDER_HEIGHT_OVERHEAD}px`;this.setSlotHeight(t),this.setPlaceholderHeight(t)}else this.setPlaceholderHeight(`${e}px`)}setPlaceholderHeightResolved(){this.resizePlaceholderToIframe(this.reader.getSlotHeightResolved())}setPlaceholderHeightImpact(){this.resizePlaceholderToIframe(this.reader.getSlotHeightImpact())}setPlaceholderHeight(e){let t=this.adSlot.getElement().parentElement;t.classList.contains("ad-slot-placeholder")&&(t=t.parentElement),this.manipulator.element(t).setProperty("height",e),_i.emit(Bs,{element:"placeholder",size:e})}setResolvedImage(){this.params.image2&&this.params.image2.background?(this.manipulator.element(this.params.image1.element).addClass("hidden-state"),this.manipulator.element(this.params.image2.element).removeClass("hidden-state")):this.params.image1&&this.manipulator.element(this.params.image1.element).removeClass("hidden-state")}setImpactImage(){this.params.image1&&this.manipulator.element(this.params.image1.element).removeClass("hidden-state")}};var Gg,qg;Hg.PLACEHOLDER_HEIGHT_OVERHEAD=39,Hg=Ug=a([Rn({autobind:!1}),d(0,Dn(ph.PARAMS)),d(1,Dn(ph.SLOT)),d(2,Dn(Ng)),l("design:paramtypes",["function"==typeof(jg=void 0!==i.UapParams&&i.UapParams)?jg:Object,Object,"function"==typeof(Bg="undefined"!=typeof HTMLElement&&HTMLElement)?Bg:Object,"function"==typeof($g=void 0!==xg&&xg)?$g:Object,"function"==typeof(Fg=void 0!==Mg&&Mg)?Fg:Object])],Hg);let Wg=class{constructor(e,t){this.domListener=e,this.manager=t,this.unsubscribe$=new zt}onEnter(){return c(this,void 0,void 0,(function*(){this.manager.setResolvedImage(),this.domListener.resize$.pipe(Su({}),cr((()=>{this.manager.setSlotHeightResolved(),this.manager.setPlaceholderHeightResolved()})),Kh(this.unsubscribe$)).subscribe()}))}onLeave(){return c(this,void 0,void 0,(function*(){this.unsubscribe$.next()}))}};var Kg,Yg;Wg=a([Rn({autobind:!1}),l("design:paramtypes",["function"==typeof(Gg=void 0!==Pg&&Pg)?Gg:Object,"function"==typeof(qg=void 0!==Hg&&Hg)?qg:Object])],Wg);let Qg=Kg=class{static provide(e){return{bind:Kg,provider:t=>new Kg(t.get(ph.SLOT),t.get(ph.PARAMS),e)}}constructor(e,t,i){this.adSlot=e,this.fallbackTimeout=i}isViewedAndDelayed(){return ai(_u(!1),oi(this.adSlot.loaded.then((()=>pn(this.fallbackTimeout)))).pipe(Nt((()=>!0))))}};var Jg,Xg;Qg=Kg=a([Rn({autobind:!1}),d(0,Dn(ph.SLOT)),d(1,Dn(ph.PARAMS)),l("design:paramtypes",[Object,"function"==typeof(Yg=void 0!==i.UapParams&&i.UapParams)?Yg:Object,Number])],Qg);let Zg=class{constructor(e,t,i){this.adSlot=e,this.domListener=t,this.timeout=i,this.unsubscribe$=new zt}onEnter(e){return c(this,void 0,void 0,(function*(){this.adSlot.emitEvent(Wc.SLOT_STICKED_STATE),this.timeout.isViewedAndDelayed().pipe(pi((e=>e)),yg((()=>this.domListener.scroll$.pipe(hi(1)))),cr((()=>{this.adSlot.emitEvent(Wc.SLOT_UNSTICKED_STATE),e("transition")})),Kh(this.unsubscribe$)).subscribe()}))}onLeave(){return c(this,void 0,void 0,(function*(){this.unsubscribe$.next()}))}};var em;Zg=a([Rn({autobind:!1}),d(0,Dn(ph.SLOT)),l("design:paramtypes",[Object,"function"==typeof(Jg=void 0!==Pg&&Pg)?Jg:Object,"function"==typeof(Xg=void 0!==Qg&&Qg)?Xg:Object])],Zg);let tm=class{constructor(e,t){this.adSlot=e,this.domListener=t}appendOnViewed(e){return oi(this.adSlot.viewed).pipe(Su({}),hi(1),cr((()=>this.adSlot.getElement().appendChild(e))))}appendOnScroll(e){return this.domListener.scroll$.pipe(Su({}),pi((()=>window.scrollY>0)),hi(1),cr((()=>this.adSlot.getElement().appendChild(e))))}};var im;tm=a([Rn({autobind:!1}),d(0,Dn(ph.SLOT)),l("design:paramtypes",[Object,"function"==typeof(em=void 0!==Pg&&Pg)?em:Object])],tm);let nm=class{constructor(e,t){this.adSlot=e,this.helper=t,this.unsubscribe$=new zt}onEnter(e){return c(this,void 0,void 0,(function*(){this.button=new Nr({onClick:()=>{this.adSlot.emitEvent(Wc.SLOT_FORCE_UNSTICK),e("transition")}}).render(),this.helper.appendOnScroll(this.button).pipe(Kh(this.unsubscribe$)).subscribe()}))}onLeave(){return c(this,void 0,void 0,(function*(){this.unsubscribe$.next(),this.button.remove()}))}};function sm(...e){return function(...e){return t=>t.pipe(yg((t=>ai(...e).pipe(Nt((()=>t))))))}(...e,_u({}))}var rm,om;nm=a([Rn({autobind:!1}),d(0,Dn(ph.SLOT)),l("design:paramtypes",[Object,"function"==typeof(im=void 0!==tm&&tm)?im:Object])],nm);let am=class{constructor(e,t){this.params=e,this.reader=t}getVideoSizeImpact(){return this.calculateVideoSize(this.reader.getSlotHeightImpact(),0)}getVideoSizeResolved(){return this.calculateVideoSize(this.reader.getSlotHeightResolved(),1)}getVideoSizeImpactToResolved(){return this.calculateVideoSize(this.reader.getSlotHeightImpactToResolved(),this.reader.getProgressImpactToResolved())}calculateVideoSize(e,t){if(!this.params.config)return;const{height:i,width:n}=this.getSize(e,t);return{top:this.getPercentage(t,this.params.config.state.top),right:this.getPercentage(t,this.params.config.state.right),bottom:this.getPercentage(t,this.params.config.state.bottom),height:Math.ceil(i),width:Math.ceil(n)}}getSize(e,t){if(!this.params.config)return;const i=e*(this.getPercentage(t,this.params.config.state.height)/100);return{height:i,width:i*(16/9)}}getPercentage(e,t){if(!t)return;const{default:i,resolved:n}=t;return i-(i-n)*e}};var dm,lm,cm;am=a([Rn({autobind:!1}),d(0,Dn(ph.PARAMS)),l("design:paramtypes",["function"==typeof(rm=void 0!==i.UapParams&&i.UapParams)?rm:Object,"function"==typeof(om=void 0!==Mg&&Mg)?om:Object])],am);let um=class{constructor(e,t,i){this.manipulator=e,this.reader=t,this.params=i}setVideoSizeResolved(e){if(!e.isFullscreen())return this.setVideoSize(e,this.reader.getVideoSizeResolved())}setVideoSizeImpact(e){if(!e.isFullscreen())return this.setVideoSize(e,this.reader.getVideoSizeImpact())}setVideoSizeImpactToResolved(e){if(!e.isFullscreen())return this.setVideoSize(e,this.reader.getVideoSizeImpactToResolved())}setVideoSize(e,t){e.resize(t.width,t.height);const i=e.dom.getPlayerContainer().parentElement,n=this.params.thumbnail;this.setProperties(i,t),this.setProperties(n,t)}setProperties(e,{width:t,height:i,top:n,right:s,bottom:r}){this.manipulator.element(e).setProperty("width",`${t}px`),this.manipulator.element(e).setProperty("height",`${i}px`),"number"==typeof n&&this.manipulator.element(e).setProperty("top",`${n}%`),"number"==typeof s&&this.manipulator.element(e).setProperty("right",`${s}%`),"number"==typeof r&&this.manipulator.element(e).setProperty("bottom",`${r}%`)}};var pm,hm,gm;um=a([Rn({autobind:!1}),d(2,Dn(ph.PARAMS)),l("design:paramtypes",["function"==typeof(dm=void 0!==xg&&xg)?dm:Object,"function"==typeof(lm=void 0!==am&&am)?lm:Object,"function"==typeof(cm=void 0!==i.UapParams&&i.UapParams)?cm:Object])],um);let mm=class{constructor(e,t,i){this.playerRegistry=e,this.domListener=t,this.manager=i,this.unsubscribe$=new zt}onEnter(){return c(this,void 0,void 0,(function*(){this.playerRegistry.video$.pipe(sm(this.domListener.resize$),cr((({player:e})=>this.manager.setVideoSizeResolved(e))),Kh(this.unsubscribe$)).subscribe()}))}onLeave(){return c(this,void 0,void 0,(function*(){this.unsubscribe$.next()}))}};var fm;mm=a([Rn({autobind:!1}),l("design:paramtypes",["function"==typeof(pm=void 0!==gg&&gg)?pm:Object,"function"==typeof(hm=void 0!==Pg&&Pg)?hm:Object,"function"==typeof(gm=void 0!==um&&um)?gm:Object])],mm);let vm=class{constructor(e){this.manipulator=e}onEnter(){return c(this,void 0,void 0,(function*(){}))}onLeave(){return c(this,void 0,void 0,(function*(){this.manipulator.restore()}))}};var bm;vm=a([Rn({autobind:!1}),l("design:paramtypes",["function"==typeof(fm=void 0!==xg&&xg)?fm:Object])],vm);let ym=class{constructor(e){this.footer=e}useScrollCorrection(){const e=window.scrollY;return()=>window.scrollBy(0,e-window.scrollY)}usePositionCorrection(e=this.footer){const t=e.getBoundingClientRect().top;return()=>window.scrollBy(0,e.getBoundingClientRect().top-t)}};var Sm,wm,_m;ym=a([Rn({autobind:!1}),d(0,Dn(Lg)),l("design:paramtypes",["function"==typeof(bm="undefined"!=typeof HTMLElement&&HTMLElement)?bm:Object])],ym);let Em=class{constructor(e,t,i,n){this.adSlot=e,this.scrollCorrector=t,this.manipulator=i,this.reader=n,this.unsubscribe$=new zt}onEnter(e){return c(this,void 0,void 0,(function*(){this.animate().pipe(cr((()=>{const t=this.scrollCorrector.useScrollCorrection();this.adSlot.removeClass("uap-toc-pusher"),e("resolved").then(t)})),Kh(this.unsubscribe$)).subscribe()}))}animate(){const e=Wc.SLIDE_OUT_TIME;return this.manipulator.element(this.adSlot.getElement()).setProperty("transition",`top ${e}ms ${Wc.CSS_TIMING_EASE_IN_CUBIC}`).setProperty("top",`${this.reader.getSlotOffsetResolvedToNone()}px`),oi(pn(e))}onLeave(){return c(this,void 0,void 0,(function*(){this.unsubscribe$.next()}))}};var Tm,Im;Em=a([Rn({autobind:!1}),d(0,Dn(ph.SLOT)),l("design:paramtypes",[Object,"function"==typeof(Sm=void 0!==ym&&ym)?Sm:Object,"function"==typeof(wm=void 0!==xg&&xg)?wm:Object,"function"==typeof(_m=void 0!==Mg&&Mg)?_m:Object])],Em);let Am=class{constructor(e,t){this.domListener=e,this.manager=t,this.unsubscribe$=new zt}onEnter(){return c(this,void 0,void 0,(function*(){ai(this.domListener.resize$,this.domListener.scroll$).pipe(Su({}),cr((()=>this.manager.setSlotHeightClipping())),Kh(this.unsubscribe$)).subscribe()}))}onLeave(){return c(this,void 0,void 0,(function*(){this.unsubscribe$.next()}))}};var Cm,Om,Pm;Am=a([Rn({autobind:!1}),l("design:paramtypes",["function"==typeof(Tm=void 0!==Pg&&Pg)?Tm:Object,"function"==typeof(Im=void 0!==Hg&&Hg)?Im:Object])],Am);let km=class{constructor(e,t,i){this.params=e,this.domListener=t,this.manager=i,this.unsubscribe$=new zt}onEnter(){return c(this,void 0,void 0,(function*(){O.get("state.isMobile")&&this.params.thumbnail?this.setImpactSizeOnScroll():this.manager.setImpactImage(),this.domListener.resize$.pipe(Su({}),cr((()=>{this.manager.setSlotHeightImpact(),this.manager.setPlaceholderHeightImpact()})),Kh(this.unsubscribe$)).subscribe()}))}onLeave(){return c(this,void 0,void 0,(function*(){this.unsubscribe$.next()}))}setImpactSizeOnScroll(){this.domListener.scroll$.pipe(du((()=>{this.manager.setImpactImage()})),Kh(this.unsubscribe$)).subscribe()}};var Nm,Lm;km=a([Rn({autobind:!1}),d(0,Dn(ph.PARAMS)),l("design:paramtypes",["function"==typeof(Cm=void 0!==i.UapParams&&i.UapParams)?Cm:Object,"function"==typeof(Om=void 0!==Pg&&Pg)?Om:Object,"function"==typeof(Pm=void 0!==Hg&&Hg)?Pm:Object])],km);let Rm=class{constructor(e,t){this.domListener=e,this.manager=t,this.unsubscribe$=new zt}onEnter(){return c(this,void 0,void 0,(function*(){ai(this.domListener.resize$,this.domListener.scroll$).pipe(Su({}),cr((()=>this.manager.setSlotHeightImpactToResolved())),Kh(this.unsubscribe$)).subscribe()}))}onLeave(){return c(this,void 0,void 0,(function*(){this.unsubscribe$.next()}))}};var Dm,xm,zm,Vm;Rm=a([Rn({autobind:!1}),l("design:paramtypes",["function"==typeof(Nm=void 0!==Pg&&Pg)?Nm:Object,"function"==typeof(Lm=void 0!==Hg&&Hg)?Lm:Object])],Rm);let Mm=class{constructor(e,t,i,n,s){this.adSlot=e,this.domListener=t,this.scrollCorrector=i,this.reader=n,this.timeout=s,this.unsubscribe$=new zt}onEnter(e){return c(this,void 0,void 0,(function*(){this.domListener.scroll$.pipe(Su({}),cu(this.timeout.isViewedAndDelayed()),pi((()=>this.reachedResolvedSize())),cr((([,t])=>{const i=this.scrollCorrector.usePositionCorrection();t?(this.adSlot.emitEvent(Wc.SLOT_STICKY_STATE_SKIPPED),e("transition").then(i)):e("sticky").then(i)})),Kh(this.unsubscribe$)).subscribe()}))}reachedResolvedSize(){return 1===this.reader.getProgressImpactToResolved()}onLeave(){return c(this,void 0,void 0,(function*(){this.unsubscribe$.next()}))}};var Um,jm,Bm;Mm=a([Rn({autobind:!1}),d(0,Dn(ph.SLOT)),l("design:paramtypes",[Object,"function"==typeof(Dm=void 0!==Pg&&Pg)?Dm:Object,"function"==typeof(xm=void 0!==ym&&ym)?xm:Object,"function"==typeof(zm=void 0!==Mg&&Mg)?zm:Object,"function"==typeof(Vm=void 0!==Qg&&Qg)?Vm:Object])],Mm);let $m=class{constructor(e,t,i){this.playerRegistry=e,this.domListener=t,this.manager=i,this.unsubscribe$=new zt}onEnter(){return c(this,void 0,void 0,(function*(){this.playerRegistry.video$.pipe(sm(this.domListener.scroll$,this.domListener.resize$),cr((({player:e})=>this.manager.setVideoSizeImpactToResolved(e))),Kh(this.unsubscribe$)).subscribe()}))}onLeave(){return c(this,void 0,void 0,(function*(){this.unsubscribe$.next()}))}};var Fm;$m=a([Rn({autobind:!1}),l("design:paramtypes",["function"==typeof(Um=void 0!==gg&&gg)?Um:Object,"function"==typeof(jm=void 0!==Pg&&Pg)?jm:Object,"function"==typeof(Bm=void 0!==um&&um)?Bm:Object])],$m);let Hm=class{constructor(e,t){this.adSlot=e,this.playerRegistry=t,this.unsubscribe$=new zt}onEnter(e){return c(this,void 0,void 0,(function*(){this.playerRegistry.video$.pipe(yg((({player:e})=>qh(e,"wikiaAdCompleted"))),cr((()=>{this.adSlot.emitEvent(Wc.SLOT_VIDEO_DONE),e("resolved")})),Kh(this.unsubscribe$)).subscribe()}))}onLeave(){return c(this,void 0,void 0,(function*(){this.unsubscribe$.next()}))}};var Gm,qm;Hm=a([Rn({autobind:!1}),d(0,Dn(ph.SLOT)),l("design:paramtypes",[Object,"function"==typeof(Fm=void 0!==gg&&gg)?Fm:Object])],Hm);let Wm=class{constructor(e,t){this.playerRegistry=e,this.manipulator=t,this.unsubscribe$=new zt}onEnter(){return c(this,void 0,void 0,(function*(){this.playerRegistry.video$.pipe(hi(1),cr((({player:e})=>this.setLearnMoreBlockDisplay(e))),Kh(this.unsubscribe$)).subscribe()}))}setLearnMoreBlockDisplay(e){const t=e.settings.getPlayerContainer().querySelector(".learn-more");this.manipulator.element(t).addClass("show-learn-more")}onLeave(){return c(this,void 0,void 0,(function*(){this.unsubscribe$.next()}))}};var Km;Wm=a([Rn({autobind:!1}),l("design:paramtypes",["function"==typeof(Gm=void 0!==gg&&gg)?Gm:Object,"function"==typeof(qm=void 0!==xg&&xg)?qm:Object])],Wm);let Ym=class{constructor(e){this.params=e}onEnter(){return c(this,void 0,void 0,(function*(){this.params.newTakeoverConfig&&_i.emit(Fs),Wc.init(this.params,Object.keys(O.get("slots")),[])}))}};Ym=a([Rn({autobind:!1}),d(0,Dn(ph.PARAMS)),l("design:paramtypes",["function"==typeof(Km=void 0!==i.UapParams&&i.UapParams)?Km:Object])],Ym);var Qm,Jm=new It(ct);function Xm(e,t,i){void 0===e&&(e=0),void 0===i&&(i=tg);var n=-1;return null!=t&&(Zt(t)?i=t:n=t),new It((function(t){var s,r=(s=e)instanceof Date&&!isNaN(s)?+e-i.now():e;r<0&&(r=0);var o=0;return i.schedule((function(){t.closed||(t.next(o++),0<=n?this.schedule(void 0,n):t.complete())}),r)}))}let Zm=class{constructor(e,t){this.adSlot=e,this.unsubscribe$=new zt,this.additionalHideTime=t.get("icFloorAdhesionDelay"),this.timeoutHideTime=t.get("icFloorAdhesionTimeout")}onEnter(e){return c(this,void 0,void 0,(function*(){ai(this.getViewabilityStream(),this.getTimeoutStream()).pipe(hi(1),cr((()=>e("transition"))),Kh(this.unsubscribe$)).subscribe()}))}getViewabilityStream(){return-1===this.additionalHideTime?Jm:oi(this.adSlot.viewed).pipe(Qt((()=>Xm(this.additionalHideTime))))}getTimeoutStream(){return this.timeoutHideTime?Xm(this.timeoutHideTime):Xt}onLeave(){return c(this,void 0,void 0,(function*(){this.unsubscribe$.next()}))}};Zm=a([Rn({autobind:!1}),d(0,Dn(ph.SLOT)),l("design:paramtypes",[Object,"function"==typeof(Qm=void 0!==po&&po)?Qm:Object])],Zm);let ef=class{constructor(e){this.adSlot=e}onEnter(e){return c(this,void 0,void 0,(function*(){this.button=new Nr({onClick:()=>{this.adSlot.emitEvent(Ds.SLOT_CLOSE_IMMEDIATELY),e("hidden")}}).render(),setTimeout((()=>{this.adSlot.getElement().appendChild(this.button)}),0)}))}onLeave(){return c(this,void 0,void 0,(function*(){this.button.remove()}))}};var tf;ef=a([Rn({autobind:!1}),d(0,Dn(ph.SLOT)),l("design:paramtypes",[Object])],ef);let nf=class{constructor(e,t){this.adSlot=e,this.manipulator=t,this.unsubscribe$=new zt}onEnter(e){return c(this,void 0,void 0,(function*(){this.animate().pipe(cr((()=>{e("hidden")})),Kh(this.unsubscribe$)).subscribe()}))}animate(){const e=this.adSlot.getElement().offsetHeight;return this.manipulator.element(this.adSlot.getElement()).setProperty("transition",`bottom 600ms ${Wc.CSS_TIMING_EASE_IN_CUBIC}, opacity 400ms ${Wc.CSS_TIMING_EASE_IN_CUBIC}`).setProperty("opacity","0").setProperty("bottom",`-${e}px`),Xm(1e3)}onLeave(){return c(this,void 0,void 0,(function*(){this.unsubscribe$.next()}))}};var sf;nf=a([Rn({autobind:!1}),d(0,Dn(ph.SLOT)),l("design:paramtypes",[Object,"function"==typeof(tf=void 0!==xg&&xg)?tf:Object])],nf);let rf=class{constructor(e,t){this.adSlot=e,this.manipulator=t}onEnter(){return c(this,void 0,void 0,(function*(){this.manipulator.element(this.adSlot.element).addClass(Ji.HIDDEN_AD_CLASS),document.body.classList.remove("has-sticky-tlb"),this.adSlot.emitEvent(bs.HIDDEN_EVENT)}))}};var of;rf=a([Rn({autobind:!1}),d(0,Dn(ph.SLOT)),l("design:paramtypes",[Object,"function"==typeof(sf=void 0!==xg&&xg)?sf:Object])],rf);let af=class{constructor(e){this.adSlot=e}onEnter(e){return c(this,void 0,void 0,(function*(){this.adSlot.setConfigProperty("showManually",!0),this.adSlot.addClass(Ji.HIDDEN_AD_CLASS),this.adSlot.addClass("floor-adhesion"),this.adSlot.addClass("out-of-page-template"),this.adSlot.isOutOfPage()&&(yield xs.adjustIframeByContentSize(this.adSlot)),e("display")}))}onLeave(){return c(this,void 0,void 0,(function*(){this.adSlot.show()}))}};var df;af=a([Rn({autobind:!1}),d(0,Dn(ph.SLOT)),l("design:paramtypes",["function"==typeof(of=void 0!==zr&&zr)?of:Object])],af);let lf=df=class{constructor(e){this.adSlot=e}onEnter(e){return c(this,void 0,void 0,(function*(){(yield this.isUAP())?this.blockStickyTLB("UAP"):this.isStickyTlbForced()||this.enabledByLine()||this.enabledByOrder()?hp.isBlocking()?this.blockStickyTLB("AdBlock"):e("initial"):this.blockStickyTLB(`Line item ID ${this.adSlot.lineItemId}`)}))}blockStickyTLB(e){this.adSlot.emitEvent(Wc.SLOT_STICKINESS_DISABLED),this.logger(`Template 'stickyTlb' could not be applied for ${e}`)}enabledByLine(){const e=O.get("templates.stickyTlb.lineItemIds")||[];return this.checkRolloutVariable(this.adSlot.lineItemId,e)}enabledByOrder(){const e=O.get("templates.stickyTlb.ordersIds")||[];return this.checkRolloutVariable(this.adSlot.orderId,e)}checkRolloutVariable(e,t){return!!(e&&t&&Array.isArray(t))&&t.some((t=>t.toString()===e.toString()))}isUAP(){return c(this,void 0,void 0,(function*(){return new Promise((e=>{_i.on($s,(t=>{e(t.isLoaded)}))}))}))}isStickyTlbForced(){return O.get("templates.stickyTlb.forced")||O.get("templates.stickyTlb.experiment")}logger(...e){Wn(df.LOG_GROUP,...e)}};lf.LOG_GROUP="sticky-tlb",lf=df=a([Rn({autobind:!1}),d(0,Dn(ph.SLOT)),l("design:paramtypes",[Object])],lf);let cf=class{constructor(e){this.adSlot=e}onEnter(e){return c(this,void 0,void 0,(function*(){yield xs.onReady(this.adSlot),yield this.awaitVisibleDOM(),e("sticky")}))}awaitVisibleDOM(){return c(this,void 0,void 0,(function*(){document.hidden&&(yield gn(window,"visibilitychange"))}))}};cf=a([Rn({autobind:!1}),d(0,Dn(ph.SLOT)),l("design:paramtypes",[Object])],cf);let uf=class{constructor(e){this.adSlot=e}onEnter(){return c(this,void 0,void 0,(function*(){var e;null===(e=document.querySelector(".top-ads-container"))||void 0===e||e.classList.add("sticky-tlb-placeholder"),this.adSlot.setConfigProperty("showManually",!0),this.adSlot.addClass("expanded-slot"),this.adSlot.addClass("sticky-tlb"),this.adSlot.setConfigProperty("useGptOnloadEvent",!0),this.adSlot.loaded.then((()=>{this.adSlot.emitEvent(Wc.SLOT_STICKY_READY_STATE)}))}))}onLeave(){return c(this,void 0,void 0,(function*(){this.adSlot.show(),document.body.classList.add("has-uap"),document.body.classList.add("has-sticky-tlb")}))}onDestroy(){return c(this,void 0,void 0,(function*(){document.body.classList.remove("has-uap"),document.body.classList.remove("has-sticky-tlb")}))}};var pf;uf=a([Rn({autobind:!1}),d(0,Dn(ph.SLOT)),l("design:paramtypes",[Object])],uf);let hf=class{constructor(e,t){this.adSlot=e,this.helper=t,this.unsubscribe$=new zt}onEnter(e){return c(this,void 0,void 0,(function*(){this.button=new Nr({onClick:()=>{this.adSlot.emitEvent(Wc.SLOT_FORCE_UNSTICK),e("hidden")}}).render(),this.helper.appendOnScroll(this.button).pipe(Kh(this.unsubscribe$)).subscribe()}))}onLeave(){return c(this,void 0,void 0,(function*(){this.unsubscribe$.next(),this.button.remove()}))}};var gf;hf=a([Rn({autobind:!1}),d(0,Dn(ph.SLOT)),l("design:paramtypes",[Object,"function"==typeof(pf=void 0!==tm&&tm)?pf:Object])],hf);let mf=class{constructor(e,t){this.adSlot=e,this.manager=t,this.unsubscribe$=new zt}onEnter(){return c(this,void 0,void 0,(function*(){var e;this.manager.addClassToPage("uap-sticked"),this.adSlot.addClass("uap-toc-pusher"),null===(e=document.querySelector(".top-ads-container"))||void 0===e||e.classList.remove("sticky-tlb-placeholder")}))}onLeave(){return c(this,void 0,void 0,(function*(){this.unsubscribe$.next()}))}};var ff;mf=a([Rn({autobind:!1}),d(0,Dn(ph.SLOT)),l("design:paramtypes",[Object,"function"==typeof(gf=void 0!==Hg&&Hg)?gf:Object])],mf);const vf=Symbol("Roadblock Config");let bf=class{static config(e){return{bind:vf,value:e}}constructor(e,t){this.params=e,this.config=t}onEnter(){return c(this,void 0,void 0,(function*(){if(this.params.adProduct="ruap",this.params.newTakeoverConfig){if(O.get("state.isMobile")){const e=O.get("experiments.persistentAdhesionExperiment")?"adhesion_limited":"floor_adhesion";this.config.enabledSlots.push(e)}_i.emit(Fs)}this.params.stickedTlb&&O.set("templates.stickyTlb.forced",!0),Wc.init(this.params,this.config.enabledSlots,this.config.disableSlots)}))}};function yf(){return[{bind:kg,value:document.querySelector(".masthead")},{bind:Ng,value:document.body},{bind:Lg,value:document.getElementById("footer")}]}var Sf;bf=a([Rn({autobind:!1}),d(0,Dn(ph.PARAMS)),d(1,Dn(vf)),l("design:paramtypes",["function"==typeof(ff=void 0!==n.RoadblockParams&&n.RoadblockParams)?ff:Object,Object])],bf);let wf=class{constructor(e){this.registry=e,ur.setInitializer(this.registry)}execute(){const e=function(e,t){const i={initial:[Ym,Ph,bg,wg,Eg,Tg,Ig],impact:[],sticky:[Wg,Zg,nm,mm,vm],transition:[Wg,Em,mm,vm],resolved:[Wg,Am,mm,vm]};return O.get("state.isMobile")?i.impact=[km,Rm,Mm,$m,Hm,Wm,vm]:i.impact=[km,Mm,Am,$m,Hm,vm],e.register("bfaa",i,"initial",[ym,gg,xg,Hg,Mg,am,um,tm,Qg.provide(Wc.BFAA_UNSTICK_DELAY),t()])}(this.registry,yf),t=this.registry.register("floorAdhesion",{initial:[af,Ig],display:[Zm,ef,vm],transition:[nf,vm],hidden:[rf,vm]},"initial",[xg]),i=function(e,t){return e.register("stickyTlb",{blocking:[lf],initial:[cf,uf,Tg,Ig],sticky:[Wg,Zg,hf,vm,mf],transition:[Wg,Em,vm,mf],resolved:[Wg,Am,vm],hidden:[rf,vm]},"blocking",[xg,Hg,Mg,ym,tm,Qg.provide(Wc.TLB_UNSTICK_DELAY),t()])}(this.registry,yf),n=Wi.isSmartphone()||Wi.isTablet();ai(e,t,function(e,t=[],i=[]){return e.register("roadblock",{initial:[bf]},"initial",[bf.config({enabledSlots:t,disableSlots:i})])}(this.registry,n?["mobile-native-top","mobile-incontent-ad","mobile-mpu-banner-bottom","mobile-native-plus-top","mobile-highimpact-plus","incontent-mobile-flex","mobile-banner","mobile-mpu","mobile-nav-ad-plus","mobile-banner-plus-inc","mobile-incontent-ad-plus","mobile-banner-mpu","video","incontent_player"]:["leader_plus_top","leader_top","incontent-ad","mpu_top","mpu_plus_top","mpu_bottom","leader_bottom","nav-ad-plus","incontent-ad-plus","incontent-leader-middle","video","incontent_player"]),i).subscribe((e=>{Wn(`TemplateLogger - ${e.templateName}\n`,`StateName: ${e.stateName}, Type: ${e.type}`)}))}};var _f;wf=a([Rn(),l("design:paramtypes",["function"==typeof(Sf=void 0!==yh&&yh)?Sf:Object])],wf);let Ef=class{constructor(e){this.pipeline=e}execute(){!function(){var e;Wn("ad-engine",null===(e=window.ads.version)||void 0===e?void 0:e.ae)}(),O.extend(nh),O.set("state.isMobile",!Wi.isDesktop()),this.pipeline.add((()=>c(this,void 0,void 0,(function*(){return yield function(){return c(this,void 0,void 0,(function*(){var e;if(void 0!==(null===(e=window.ads)||void 0===e?void 0:e.geo))return void P(window.ads.geo);const t=new b,i=t.getItem("Geo");if(i)try{return void P(JSON.parse(decodeURIComponent(i))||{})}catch(e){throw new Error("Invalid JSON in the cookie")}try{return function(){return c(this,void 0,void 0,(function*(){const e=yield fetch("https://services.fandom.com/geoip/location",{method:"GET",credentials:"include"}),t=yield e.json();return{continent:t.continent_code,country:t.country_code,region:t.region}}))}().then((e=>{t.setItem("Geo",encodeURIComponent(JSON.stringify(e))),P(e)}))}catch(e){}}))}()}))),function(...e){return{process:sc,payload:e}}(function(...e){return{process:oc,payload:e}}(mo,Yo),Jo),ea,ra,dc,cc,td,pc,uh,fa,ch,ya,lh,nu,oh,sh,ja,ou,wf,ih,Xl),this.pipeline.execute()}};Ef=a([Rn(),l("design:paramtypes",["function"==typeof(_f=void 0!==ic&&ic)?_f:Object])],Ef);const Tf=Symbol("Window");(function(){const e=new jn;return e.bind(Tf).value(window),e})().get(Ef).execute()})()})();
//# sourceMappingURL=main.bundle.js.map